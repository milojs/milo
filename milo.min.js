!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){"use strict";function c(a,b){this.name=d.firstLowerCase(this.constructor.name),this.owner=a,this.config=b||{},this.init.apply(this,arguments)}var d=a("milo-core").proto;b.exports=c,d.extendProto(c,{init:function(){}})},{"milo-core":105}],2:[function(a,b){"use strict";function c(){function a(a,c){var f=b[c];e[c]=new a(this,f),d[c]={enumerable:!0,value:e[c]}}var b=this.facetsConfig||{},d={},e={};if(this.constructor==c)throw new Error("FacetedObject is an abstract class, can't be instantiated");this.facetsClasses&&j.eachKey(this.facetsClasses,a,this,!0),Object.defineProperties(this,d),j.defineProperty(this,"facets",e),this.init&&this.init.apply(this,arguments)}function d(a,b,c,d){k(a,Function),k(c,l.Optional(String)),c=j.firstLowerCase(c||a.name);var e=this.constructor.prototype.facetsClasses;if(e&&e[c])throw new Error("facet "+c+" is already part of the class "+this.constructor.name);if(this[c]){var f="facet "+c+" is already present in object";if(d===!1)return logger.error("FacetedObject addFacet: ",f);throw new Error(f)}var g=this.facets[c]=new a(this,b);return j.defineProperty(this,c,g,j.ENUM),g}function e(a){var b=this.prototype.facetsClasses;return b&&b[a]}function f(a){return this.hasFacet(a)?this.prototype.facetsConfig[a]:null}function g(a,b,c){function d(a,b,c){var d=a.prototype[c];return d?j(d).clone().extend(b||{})._():b}k(a,String),k(b,l.Optional(l.ObjectHash(l.Subclass(h,!0)))),k(c,l.Optional(Object)),c&&j.eachKey(c,function(a,c){if(!b.hasOwnProperty(c))throw new Error("configuration for facet ("+c+") passed that is not in class")});var e=j.createSubclass(this,a,!0);return b=d(this,b,"facetsClasses"),c=d(this,c,"facetsConfig"),j.extendProto(e,{facetsClasses:b,facetsConfig:c}),e}var h=a("./facet"),i=a("milo-core"),j=i.proto,k=i.util.check,l=k.Match;b.exports=c,j.extend(c,{createFacetedClass:g,hasFacet:e,getFacetConfig:f}),j.extendProto(c,{addFacet:d})},{"./facet":1,"milo-core":105}],3:[function(a,b){"use strict";function c(a){a&&this.setClass(a),this.__registeredClasses={}}function d(a,b){if(b=b||a.name,k(b,l.IdentifierString,"class name must be identifier string"),!this.FoundationClass)throw new Error("foundation class must be set before adding classes to registry");if(a!=this.FoundationClass&&k(a,l.Subclass(this.FoundationClass),"class must be a sub(class) of a foundation class"),this.__registeredClasses[b])throw new Error('class "'+b+'" is already registered');this.__registeredClasses[b]=a}function e(a){return k(a,String,"class name must be string"),this.__registeredClasses[a]}function f(a){k(a,l.OneOf(String,Function),"class or name must be supplied");var b="string"==typeof a?a:a.name;if(!this.__registeredClasses[b])throw new Error("class is not registered");delete this.__registeredClasses[b]}function g(){this.__registeredClasses={}}function h(a){k(a,Function),j.defineProperty(this,"FoundationClass",a,j.ENUM)}var i=a("milo-core"),j=i.proto,k=i.util.check,l=k.Match;b.exports=c,j.extendProto(c,{add:d,get:e,remove:f,clean:g,setClass:h})},{"milo-core":105}],4:[function(a,b){"use strict";function c(){return i.attrs.bind}function d(){if(this.node){var a=this.get();if(a)var b=a.match(n);if(!b)throw new Error("invalid bind attribute "+a);return this.compClass=b[1]||"Component",this.compFacets=b[2]&&b[2].split(o)||void 0,this.compName=b[3]||void 0,this}}function e(){if(l(this.compName,m.IdentifierString),!this.compClass)throw new Error("empty component class name "+this.compClass);return this}function f(){return this.compName=this.compName||milo.util.componentName(),p.replace("%compClass",this.compClass||"").replace("%compFacets",this.compFacets&&this.compFacets.length?"["+this.compFacets.join(", ")+"]":"").replace("%compName",this.compName)}function g(a,b,c,d){var e=new q(a);k.extend(e,{compClass:b,compName:c,compFacets:d}),e.decorate()}var h=a("./a_class"),i=a("../config"),j=a("milo-core"),k=j.proto,l=j.util.check,m=l.Match,n=/^([^\:\[\]]*)(?:\[([^\:\[\]]*)\])?\:?([^:]*)$/,o=/\s*(?:\,|\s)\s*/,p="%compClass%compFacets:%compName",q=k.createSubclass(h,"BindAttribute",!0);k.extendProto(q,{attrName:c,parse:d,validate:e,render:f}),k.extend(q,{setInfo:g}),b.exports=q},{"../config":64,"./a_class":5,"milo-core":105}],5:[function(a,b){"use strict";function c(a,b){this.name=b||this.attrName(),this.el=a,this.node=a.attributes[this.name]}function d(a,b){var c=this.prototype.attrName();if(a.removeAttribute(c),b){var d="["+c+"]",e=a.querySelectorAll(d);l.forEach(e,function(a){a.removeAttribute(c)})}}function e(){delete this.node}function f(){delete this.el,delete this.node}function g(){return this.el.getAttribute(this.name)}function h(a){this.el.setAttribute(this.name,a)}function i(){this.set(this.render())}function j(){throw new Error("calling the method of an absctract class")}{var k=a("milo-core"),l=k.proto,m=k.util.check;m.Match}b.exports=c,l.extend(c,{remove:d}),l.extendProto(c,{get:g,set:h,remove:e,decorate:i,destroy:f,attrName:j,parse:j,validate:j,render:j})},{"milo-core":105}],6:[function(a,b){"use strict";function c(){return h.attrs.load}function d(){return this.node?(this.loadUrl=this.get(),this):void 0}function e(){return this}function f(){return this.loadUrl}var g=a("./a_class"),h=a("../config"),i=a("milo-core").proto,j=i.createSubclass(g,"LoadAttribute",!0);i.extendProto(j,{attrName:c,parse:d,validate:e,render:f}),b.exports=j},{"../config":64,"./a_class":5,"milo-core":105}],7:[function(a,b){"use strict";b.exports={bind:a("./a_bind"),load:a("./a_load")}},{"./a_bind":4,"./a_load":6}],8:[function(a,b){"use strict";function c(a,b,c,d){return g(a,function(a,b,c,d){var e=new j(a,b,c,d);return i.create(e,d)},b,c,d)}function d(a,b,d,e){var f=c.scan(a,b,d,e);return c.create(f,void 0,e)}function e(a,b,c,d){return g(a,function(a,b,c,d){return new j(a,b,c,d)},b,c,d)}function f(a,b,c){var d=new k(a._rootEl,b),e=c===!1?"_safeAdd":"_add";return a._each(function(a){var b=n.clone(a);b.scope=d;var g=i.create(b,c);d[e](g,g.name),g.container&&(g.container.scope=f(a.container.scope,g.container,c))}),d}function g(a,b,c,d,e){function f(a,c,d){function f(a){var b=i.getComponent(a);b&&b.postMessageSync("childrenbound")}var h=new l(c);if(h.node&&d!==!1)var m=b(a,c,h,e),n="undefined"!=typeof m&&m.container;if(c.childNodes&&c.childNodes.length){if(n){var o=new k(c);m.container.scope=o,o._hostObject=m.container}g(c,n?o:a)}return n&&!m.container.scope&&(m.container.scope=new k(c)),m&&a[j](m,h.compName),f(c),m}function g(a,b){var c=p.children(a);return n.forEach(c,function(a){f(b,a,!0)}),b}var a=a||document.body,h=c||new k(a),j=e===!1?"_safeAdd":"_add";return f(h,a,d),h}{var h=(a("./services/mail"),a("./components/c_registry")),i=(a("./components/c_facets/cf_registry"),h.get("Component")),j=a("./components/c_info"),k=a("./components/scope"),l=a("./attributes/a_bind"),m=a("milo-core"),n=m.proto,o=m.util.check,p=a("./util/dom");o.Match}c.scan=e,c.create=f,c.twoPass=d,b.exports=c},{"./attributes/a_bind":4,"./components/c_facets/cf_registry":30,"./components/c_info":31,"./components/c_registry":32,"./components/scope":40,"./services/mail":70,"./util/dom":79,"milo-core":105}],9:[function(a,b){"use strict";var c=a("milo-core").classes,d={Facet:a("./abstract/facet"),FacetedObject:a("./abstract/faceted_object"),Scope:a("./components/scope"),ClassRegistry:a("./abstract/registry"),Mixin:c.Mixin,MessageSource:c.MessageSource,MessengerMessageSource:c.MessengerMessageSource,MessengerAPI:c.MessengerAPI,DOMEventsSource:a("./components/msg_src/dom_events"),Transaction:a("./command/transaction"),TransactionHistory:a("./command/transaction_history")};b.exports=d},{"./abstract/facet":1,"./abstract/faceted_object":2,"./abstract/registry":3,"./command/transaction":13,"./command/transaction_history":14,"./components/msg_src/dom_events":38,"./components/scope":40,"milo-core":105}],10:[function(a,b){"use strict";function c(a){this._maxLength=a||1/0,this.actions=[],this.position=0}function d(a){if(f.call(this),this.actions.push(a),this.actions.length>this._maxLength){var b=this.actions.shift();b.destroy()}return this.position=this.actions.length,this.position-1}function e(){this.actions.length&&(this.position--,this.actions.length--)}function f(){for(var a=this.position;a<this.actions.length;a++)this.actions[a].destroy();this.actions.length=this.position}function g(a){if(0!=this.position){var b=this.actions[--this.position];return b.undo(a),b}}function h(a){if(this.position!=this.actions.length){var b=this.actions[this.position++];return b.redo(a),b}}function i(){for(;this.position;)this.undo()}function j(){for(;this.position<this.actions.length;)this.redo()}function k(a){this.position&&(this.undo(),this.position?r.deferMethod(this,"undoAllAsync",a):a&&r.defer(a))}function l(a){this.position<this.actions.length&&(this.redo(),this.position<this.actions.length?r.deferMethod(this,"redoAllAsync",a):a&&r.defer(a))}function m(a,b){var c="string"==typeof a?function(b){b[a]()}:a;this.actions.forEach(c,b||this)}function n(a,b){this.actions.reverse(),this.each(a,b),this.actions.reverse()}function o(){return this.position&&this.actions[this.position-1]}function p(){var a=this.actions.map(function(a){return a.getDescription()});return{actions:a,position:this.position,length:a.length}}{var q=a("milo-core"),r=q.proto;q.util.logger}b.exports=c,r.extendProto(c,{store:d,deleteLast:e,undo:g,redo:h,undoAll:i,redoAll:j,undoAllAsync:k,redoAllAsync:l,each:m,eachReverse:n,getLastAction:o,getDescription:p})},{"milo-core":105}],11:[function(a,b){"use strict";var c=a("../abstract/registry"),d=a("./index"),e=new c(d);e.add(d),b.exports=e},{"../abstract/registry":3,"./index":12}],12:[function(a,b){"use strict";function c(){this.init.apply(this,arguments)}function d(a){t(a,u.Optional(Function)),this.func=a||function(){},this.args=s.slice(arguments,1)}function e(a){var b=this.func.apply(this,this.args);return a&&s.defer(a),b}function f(a){this[w]&&v.warn("Command setUndo: undo command is already set"),this[w]=a,a[w]=this}function g(){return this[w]}function h(a){var b=this.getUndo();if(!b)return v.error("Command undo called without undo command present");var c=b.execute();return a&&s.defer(a),c}function i(){this.args&&this.args.length&&v.warn("Command setArguments: command arguments are already set"),this.args=s.toArray(arguments)}function j(){return this.args}function k(){this.args=s.toArray(arguments)}function l(){this.args||(this.args=[]),s.appendArray(this.args,arguments)}function m(){return s.newApply(this,arguments)}function n(){throw new Error("createWithUndo should be implemented by subsclass")}function o(){delete this.func,delete this.args;var a=this[w];a&&(delete this[w][w],delete this[w],a.destroy())}function p(a){this.comment=a}function q(){return{func:this.func.name,comment:this.comment}}var r=a("milo-core"),s=r.proto,t=r.util.check,u=t.Match,v=r.util.logger,w="_undoCommand";b.exports=c,s.extendProto(c,{init:d,execute:e,setUndo:f,getUndo:g,undo:h,redo:e,setArguments:i,addArguments:l,getArguments:j,changeArguments:k,destroy:o,setComment:p,getDescription:q}),s.extend(c,{create:m,createWithUndo:n})},{"milo-core":105}],13:[function(a,b){"use strict";function c(){this.commands=new l}function d(){this.commands.each("execute")}function e(a){this.commands.undoAllAsync(a)}function f(a){this.commands.redoAllAsync(a)}function g(){this.commands.each("destroy")}function h(a){this.commands.store(a)}function i(a){a.commands.each(function(a){this.commands.store(a)},this)}function j(a){this.comment=a}function k(){var a=this.commands.getDescription();return{commands:a.actions,comment:this.comment}}var l=a("./actions_history"),m=a("milo-core").proto;b.exports=c,m.extendProto(c,{execute:d,undo:e,redo:f,destroy:g,storeCommand:h,merge:i,setComment:j,getDescription:k})},{"./actions_history":10,"milo-core":105}],14:[function(a,b){"use strict";function c(a){this.transactions=new r(a),this.currentBatch=void 0,this.currentTransaction=void 0,this[w]=!1}function d(a,b){if(b&&!this.currentTransaction&&!this.currentBatch){var c=this.transactions.getLastAction();return c.storeCommand(a),void k.call(this,"appended",c)}this.currentBatch||(this.currentBatch=new s),this.currentBatch.storeCommand(a),this[w]||(this[w]=!0,v.deferMethod(this,f))}function e(){this.currentBatch||this.currentTransaction?(this.currentBatch=void 0,this.currentTransaction=void 0):this.transactions.deleteLast()}function f(){this.currentBatch?(h.call(this),v.deferMethod(this,f)):(i.call(this),this[w]=!1)}function g(){h.call(this),i.call(this)}function h(){this.currentBatch&&(this.currentTransaction||(this.currentTransaction=new s),this.currentTransaction.merge(this.currentBatch),this.currentBatch=void 0)}function i(){if(this.currentTransaction){var a=this.currentTransaction;this.transactions.store(a),k.call(this,"stored",a),this.currentTransaction=void 0}}function j(a){this.endTransaction(),this.transactions.store(a),k.call(this,"stored",a)}function k(a,b){this._messenger&&this._messenger.postMessage(a,{transaction:b})}function l(a){var b=this.transactions.undo(a);return b&&k.call(this,"undone",b),b}function m(a){var b=this.transactions.redo(a);return b&&k.call(this,"redone",b),b}function n(){return this[w]}function o(){return this.transactions.getDescription()}function p(){return this._messenger=new u(this,u.defaultMethods)}function q(){this._messenger&&this._messenger.destroy(),delete this.transactions}var r=a("./actions_history"),s=a("./transaction"),t=a("milo-core"),u=(t.util.logger,t.Messenger),v=t.proto;b.exports=c;var w="_scheduled";v.extendProto(c,{storeCommand:d,endTransaction:g,storeTransaction:j,deleteLastTransaction:e,undo:l,redo:m,inTransaction:n,getDescription:o,useMessenger:p,destroy:q})},{"./actions_history":10,"./transaction":13,"milo-core":105}],15:[function(a,b){"use strict";function c(a,b){if(Array.isArray(b)){var c={};b.forEach(function(a){var b=X.firstLowerCase(a);c[b]={}}),b=c}var e;"object"==typeof b&&X.keys(b).length&&(e={},X.eachKey(b,function(a,b){var c=X.firstLowerCase(b),d=X.firstUpperCase(b);e[c]=S.get(d)}));var f=R.createFacetedClass.call(this,a,e,b);return d(a),f}function d(a){eb.registerDataType(a,e,f)}function e(a){var b=a.getState();return JSON.stringify(b)}function f(a){var b=X.jsonParse(a);return b?fb.createFromState(b):void 0}function g(a,b){var c=a.ComponentClass;if("function"!=typeof c){var d='create: component class should be function, "'+typeof c+'" passed';if(b!==!1)throw new Error(d);ab.error("Component",d,";using base Component class instead"),c=fb}var e=new c(a.scope,a.el,a.name,a);return a.extraFacetsClasses&&X.eachKey(a.extraFacetsClasses,function(a){e.hasFacet(a)||e.addFacet(a,void 0,void 0,b)}),e}function h(a,b){if(Y(a,fb),Y(b,Z.Optional(Boolean)),b&&!a.container)throw new Error("Cannot deep copy component without container facet");var c=a.dom?a.dom.copy(b):a.el.cloneNode(b),d=a.constructor,e=d.createOnElement(c,void 0,a.scope,a.extraFacets),f=a._getState(b||!1);return e.setState(f),X.deferMethod(e,"broadcast","stateready"),e}function i(a,b,c,d){Y(b,Z.Optional(String)),Y(c,Z.Optional(db)),Y(d,Z.Optional([String])),a&&b&&(a.innerHTML=b),a=a||j.call(this,b),c=c||k(a);var e=l.call(this,a,c,d);return e.broadcast("stateready"),e}function j(a){var b=S.get("Dom"),c=this.getFacetConfig("dom"),d=this.getFacetConfig("template"),e=d&&d.template,f={domConfig:c,template:e,content:a};return b.createElement(f)}function k(a){var b=fb.getContainingComponent(a,!1,"Container");return b?b.container.scope:new db(a)}function l(b,c,d){var e=new cb(b);e.compClass=this.name,e.compFacets=d,e.decorate();var f=a("../binder");return f(b,c),c[e.compName]}function m(b,c,d,e){Y(b,Z.ObjectIncluding({compName:Z.Optional(String),compClass:Z.Optional(String),extraFacets:Z.Optional([String]),facetsStates:Z.Optional(Object),outerHTML:String}));var f=a("../binder"),g=n(b,d),h=f(g,void 0,void 0,e),i=h._any();return c&&(i.scope=c,c._add(i)),i.setState(b),X.deferMethod(i,"broadcast","stateready"),i}function n(a,b){var c=document.createElement("div");c.innerHTML=a.outerHTML;var d=bb.children(c);if(1!=d.length)throw new Error("cannot create component: incorrect HTML, elements number: "+d.length+" (should be 1)");var e=d[0],f=new cb(e);return f.compName=b?_():a.compName,f.compClass=a.compClass,f.compFacets=a.extraFacets,f.decorate(),c}function o(a){var b=X.find(a.types,function(a){return hb.test(a)});if(b){var c=X.jsonParse(a.getData(b));if(c)return fb.createFromState(c,void 0,!0)}}function p(a,b,c,d){if(this.el=b||this.createElement(),this.el){var e=this.el[$.componentRef];e&&ab.warn("component "+c+" attached to element that already has component "+e.name),this.el[$.componentRef]=this}X.defineProperties(this,{componentInfo:d,extraFacets:[]},X.ENUM),this.name=c,this.scope=a;var f=new W(this);X.defineProperty(this,gb,f),this.allFacets("check"),this.allFacets("start"),this.start&&this.start()}function q(){}function r(){return"undefined"!=typeof document?(this.el=this.dom?this.dom.createElement():document.createElement("DIV"),this.el):void 0}function s(a){var b=X.firstLowerCase("function"==typeof a?a.name:a),c=this[b];return!c instanceof T&&ab.warn("expected facet",b,"but this property name is used for something else"),!!c}function t(a,b,c,d){Y(a,Z.OneOf(String,Z.Subclass(T))),Y(b,Z.Optional(Object)),Y(c,Z.Optional(String));var e;if("string"==typeof a){var f=X.firstUpperCase(a);e=S.get(f)}else e=a;c||(c=X.firstLowerCase(e.name)),this.extraFacets.push(c);var g=R.prototype.addFacet.call(this,e,b,c,d);g.check&&g.check(),g.start&&g.start()}function u(a){var b=X.slice(arguments,1);return X.mapKeys(this.facets,function(c){return c&&"function"==typeof c[a]?c[a].apply(c,b):void 0})}function v(a,b){a=a||_(),this.componentInfo.rename(a,!1),db.rename(this,a,b)}function w(a,b){this.scope&&(this.scope._remove(this.name,b),a||delete this.scope)}function x(a,b){a.insertBefore(this.el,b),this.setScopeParentFromDOM()}function y(){this.broadcast("getstatestarted",{rootComponent:this},void 0,!0);var a=this._getState(!0);return a.outerHTML=this.el.outerHTML,X.deferMethod(this,"broadcast","getstatecompleted",{rootComponent:this},void 0,!0),a}function z(a){return this.transfer?this.transfer.getState(a):this.getState(a)}function A(a){var b=this.allFacets("getState",a===!1?!1:!0);return b=X.filterKeys(b,function(a){return!!a}),{compName:this.name,compClass:this.constructor.name,extraFacets:this.extraFacets,facetsStates:b}}function B(a){a.facetsStates&&X.eachKey(a.facetsStates,function(a,b){var c=this[b];c&&"function"==typeof c.setState&&c.setState(a)},this)}function C(a){return D.call(this,E,a)}function D(a,b){Y(b,Z.Optional(Z.OneOf(Function,String)));var c=U._makeComponentConditionFunc(b);return a.call(this,c)}function E(a){var b;try{b=this.scope._hostObject.owner}catch(c){}return b?!a||a(b)?b:E.call(b,a):void 0}function F(a){return a=a||this.constructor,E.call(this,function(b){return b instanceof a})}function G(a){return D.call(this,H,a)}function H(a){var b,c=this;do c=E.call(c,a),c&&(b=c);while(c);return b}function I(a){return a=a||this.constructor,H.call(this,function(b){return b instanceof a})}function J(){for(var a,b,c=this.el.parentNode;c&&!b;)a=fb.getComponent(c),b=a&&a.container,c=c.parentNode;return this.remove(),b?(this.rename(void 0,!1),a.container.scope._add(this),a):void 0}function K(a,b){a.call(b,this),this.container&&this.container.scope._each(function(c){c.walkScopeTree(a,b)})}function L(a){return bb.treePathOf(this.el,a.el)}function M(a,b){var c=bb.getNodeAtTreePath(this.el,a,b);return fb.getComponent(c)}function N(a,b){var c=bb.insertAtTreePath(this.el,a,b.el);return c&&b.setScopeParentFromDOM(),c}function O(a,b,c,d){var e=d?"postMessageSync":"postMessage";this.walkScopeTree(function(d){d[e](a,b,c)})}function P(a){return this._destroyed?void(a||ab.warn("Component destroy: component is already destroyed")):(this.remove(!1,a),this.allFacets("destroy"),this[gb].destroy(),this.el&&(bb.detachComponent(this.el),bb.removeElement(this.el),delete this.el),this.componentInfo.destroy(),void(this._destroyed=!0))}function Q(){return this._destroyed}var R=a("../abstract/faceted_object"),S=a("./c_facets/cf_registry"),T=S.get("ComponentFacet"),U=a("./c_utils"),V=a("milo-core"),W=V.Messenger,X=V.proto,Y=V.util.check,Z=Y.Match,$=a("../config"),_=a("../util/component_name"),ab=V.util.logger,bb=a("../util/dom"),cb=a("../attributes/a_bind"),db=a("./scope"),eb=a("../util/storage"),fb=(U._makeComponentConditionFunc,X.createSubclass(R,"Component",!0));b.exports=fb,d("Component"),X.extend(fb,{createComponentClass:c,create:g,copy:h,createOnElement:i,isComponent:U.isComponent,getComponent:U.getComponent,getContainingComponent:U.getContainingComponent,createFromState:m,createFromDataTransfer:o}),delete fb.createFacetedClass,X.extendProto(fb,{init:p,start:q,createElement:r,hasFacet:s,addFacet:t,allFacets:u,rename:v,remove:w,insertInto:x,getState:y,getTransferState:z,_getState:A,setState:B,getScopeParent:C,getTopScopeParent:G,getScopeParentWithClass:F,getTopScopeParentWithClass:I,setScopeParentFromDOM:J,walkScopeTree:K,treePathOf:L,getComponentAtTreePath:M,insertAtTreePath:N,broadcast:O,destroy:P,isDestroyed:Q});var gb="_messenger";W.useWith(fb,gb,W.defaultMethods);var hb=/x-application\/milo-component\/([a-z_$][0-9a-z_$]*)(?:\/())/i},{"../abstract/faceted_object":2,"../attributes/a_bind":4,"../binder":8,"../config":64,"../util/component_name":76,"../util/dom":79,"../util/storage":89,"./c_facets/cf_registry":30,"./c_utils":33,"./scope":40,"milo-core":105}],16:[function(a,b){"use strict";function c(){this._createMessenger()}function d(){v.defineProperty(this,z,new t(this))}function e(){this.config.messages&&this.onConfigMessages(this.config.messages)}function f(a){var b=v.mapKeys(a,function(a,b){var c=typeof a;if("function"==c)return this.on(b,a);if("object"==c){var d=typeof a.context;if("object"==d)return this.on(b,a);if("string"==d){if(a.context==this.name||"facet"==a.context)a={subscriber:a.subscriber,context:this};else{if("owner"!=a.context)throw new Error("unknown subscriber context in configuration: "+a.context);a={subscriber:a.subscriber,context:this.owner}}return this.on(b,a)}throw new Error("unknown subscriber context type in configuration: "+d)}throw new Error("unknown subscriber type in configuration: "+c)},this);return b}function g(){this.require&&this.require.forEach(function(a){this.owner.hasFacet(a)||this.owner.addFacet(a)},this)}function h(){this[z]&&this[z].destroy(),this._destroyed=!0}function i(){var a=u.getContainingComponent(this.owner.el,!1,this.name);return a&&a[this.name]}function j(){var a=this.owner.getScopeParent(this.name);return a&&a[this.name]}function k(a,b,c){var d=a.call(this);d&&d.postMessage(b,c)}function l(a){this[z]._setMessageSource(a)}function m(){return this[z].getMessageSource()}function n(a,b){return this.getMessageSource().dispatchMessage(a,b)}function o(a,b){var c=new a(this,void 0,void 0,this.owner,b);this._setMessageSource(c),v.defineProperty(this,"_messageSource",c)}function p(a,b,c){var d=new a(this,void 0,b,this.owner,c);this._setMessageSource(d),v.defineProperty(this,"_messageSource",d)}function q(a){var b=this.prototype.require;return b&&(b.indexOf(v.firstUpperCase(a))>=0||b.indexOf(v.firstLowerCase(a))>=0)}var r=a("../abstract/facet"),s=a("milo-core"),t=s.Messenger,u=a("./c_utils"),v=s.proto,w=v.createSubclass(r,"ComponentFacet");b.exports=w;var x=v.partial(k,i),y=v.partial(k,j);v.extendProto(w,{init:c,start:e,check:g,destroy:h,onConfigMessages:f,domParent:i,postDomParent:x,scopeParent:j,postScopeParent:y,getMessageSource:m,dispatchSourceMessage:n,_createMessenger:d,_setMessageSource:l,_createMessageSource:o,_createMessageSourceWithAPI:p}),v.extend(w,{requiresFacet:q});var z="_messenger";t.useWith(w,z,t.defaultMethods)},{"../abstract/facet":1,"./c_utils":33,"milo-core":105}],17:[function(a,b){"use strict";function c(){return n(this.owner.el,this.scope,!1)}function d(){m.prototype.start.apply(this,arguments),this.scope=new o(this.owner.el,this)}function e(a){function b(){throw new Error("path "+a+" is invalid")}a=a.split(".");var c=a.length;(a[0]||2>c)&&b();for(var d=this.owner,e=1;c>e;e++){var f=a[e];if(v.test(f)||b(),!d.container)return;if(d=d.container.scope[f],!d)return}return d}function f(a){var b={scope:{}};return a!==!1&&this.scope._each(function(a,c){b.scope[c]=a._getState()}),b}function g(a){q.eachKey(a.scope,function(a,b){var c=this.scope[b];c?c.setState(a):r.warn('component "'+b+'" does not exist on scope')},this)}function h(){this.scope._each(function(a){a.destroy()}),this.scope._detachElement(),m.prototype.destroy.apply(this,arguments)}function i(a,b){t.unwrapElement(this.owner.el),this.scope&&this.scope._each(function(b){b.remove(),a!==!1&&b.rename(void 0,!1),this.owner.scope&&this.owner.scope._add(b)},this),b!==!1&&this.owner.destroy()}function j(a){this.scope._add(a),this.owner.el.appendChild(a.el)}function k(a,b){this.scope._add(a),this.el.insertBefore(a.el,b&&b.el)}function l(a){this.scope._remove(a),this.owner.el.removeChild(a.el)}var m=a("../c_facet"),n=a("../../binder"),o=a("../scope"),p=a("milo-core"),q=p.proto,r=p.util.logger,s=a("./cf_registry"),t=a("../../util/dom"),u=q.createSubclass(m,"Container");q.extendProto(u,{start:d,path:e,getState:f,setState:g,binder:c,destroy:h,unwrap:i,append:j,insertBefore:k,remove:l}),s.add(u),b.exports=u;var v=/^[A-Za-z][A-Za-z0-9\_\$]*$/},{"../../binder":8,"../../util/dom":79,"../c_facet":16,"../scope":40,"./cf_registry":30,"milo-core":105}],18:[function(a,b){"use strict";function c(){J.wrapMessengerMethods.call(this),D.prototype.start.apply(this,arguments),this.elData=H(this.owner.el),this._dataChangesQueue=[],this._prepareMessageSource(),this._path="."+this.owner.name,this._value=this.get(),this.onSync("",e),this.onSync("datachangesfinished",h),this.onSync("childdata",j),this.onSync("changedata",L)}function d(){var a=new G(this.owner),b=new F(this,S,a,this.owner);this._setMessageSource(b),P.defineProperty(this,"_dataEventsSource",b),C.prototype._createProxyMethod.call(a,"value","value",this)}function e(a,b){if(this._bubbleUpDataChange(b),this._queueDataChange(b),""===b.path){var c=M(b);this.postMessage("datachangesfinished",{transaction:c})}}function f(a){var b=this.scopeParent();if(b){var c=P.clone(a);c.path=(this._path||"."+this.owner.name)+c.path,b.postMessage("childdata",c||a)}}function g(a){this._dataChangesQueue.push(a)}function h(a,b){this._postDataChanges(b.inTransaction);var c=this.scopeParent();c&&c.postMessage("datachangesfinished",b)}function i(a){var b=this._dataChangesQueue.reverse();this.postMessageSync("datachanges",{changes:b,transaction:a}),this._dataChangesQueue=[]}function j(a,b){this.postMessage(b.path,b),this._bubbleUpDataChange(b),this._queueDataChange(b)}function k(a){var b=M(k),c=this.config.set;if("function"==typeof c){var d=c.call(this.owner,a);return d}N(this._set,b);var e=this._value,f=this._set(a),g={path:"",type:"changed",newValue:f,oldValue:e};return N(g,b),this.postMessage("",g),f}function l(a){function b(a,b,c,e){var f=e.replace("$$",c),g=this.path(f,"undefined"!=typeof b);g&&(N(g.set,d),a[c]=g.set(b))}var c,d=M(l);if(null!=a&&"object"==typeof a)if(Array.isArray(a)){c=[];var e=this.owner.list;if(e){var f=e.count(),g=a.length-f;g>=3&&(e._addItems(g),e._updateDataPaths(f,e.count())),a.forEach(function(a,d){b.call(this,c,a,d,"[$$]")},this);for(var h=e.count(),i=h-a.length;i-->0;)e._removeItem(a.length)}else Q.warn("Data: setting array data without List facet")}else c={},P.eachKey(a,function(a,d){b.call(this,c,a,d,".$$")},this);else c=this._setScalarValue(a);return this._value=c,c}function m(){var a=M(m),b=this.config.del;if("function"==typeof b){var c=b.call(this.owner);return O.call(this,a),c}var d=this._value;N(this._del,a),this._del();var e={path:"",type:"deleted",oldValue:d};N(e,a),this.postMessage("",e)}function n(){var a=M(n);N(this._set,a),this._set()}function o(a){return this.elData.set(this.owner.el,a)}function p(a){var b=this.config.get;return"function"==typeof b?b.call(this.owner,a):this._get(a)}function q(a){if(a!==!1){var b,c=this.owner;return c.list?(b=[],c.list.each(function(a,c){b[c]=a.data.get()}),c.container&&c.container.scope._each(function(a,d){!c.list.contains(a)&&a.data&&(b[d]=a.data.get())})):c.container?(b={},c.container.scope._each(function(a,c){a.data&&(b[c]=a.data.get())})):b=this._getScalarValue(),this._value=b,b}}function r(){return this.elData.get(this.owner.el)}function s(){var a,b=M(s),c=this.config.splice;if("function"==typeof c)return a=c.apply(this.owner,arguments),O.call(this,b),a;if(N(this._splice,b),a=this._splice.apply(this,arguments)){var d={path:"",type:"splice",index:a.spliceIndex,removed:a.removed,addedCount:a.addedCount,newValue:this._value};return N(d,b),this.postMessage("",d),a.removed}}function t(a,b){var c=M(t),d=this.owner.list;if(!d)return Q.warn("Data: cannot use splice method without List facet");var e=[],f=d.count();if(arguments[0]=a=K.normalizeSpliceIndex(a,f),b>0&&f>0){for(var g=a;a+b>g;g++){var h=d.item(a);if(h){var i=h.data.get();d._removeItem(a)}else Q.warn("Data: no item for index",g);e.push(i)}d._updateDataPaths(a,d.count())}var j=[],k=arguments.length,l=k>2,m=k-2;if(l){d._addItems(m,a);for(var g=2,n=a;k>g;g++,n++){var h=d.item(n);if(h){N(h.data.set,c);var i=h.data.set(arguments[g])}else Q.warn("Data: no item for index",n);j.push(i)}d._updateDataPaths(a,d.count())}return this._value=this.get(),{spliceIndex:a,removed:e,addedCount:l?m:0}}function u(){var a=this.config.len;return"function"==typeof a?a.call(this.owner):this._len()}function v(){return this.owner.list?this.owner.list.count():void Q.error("Data: len called without list facet")}function w(a,b){if(!a)return this;for(var c=J.parseAccessPath(a),d=this.owner,e=0,f=c.length;f>e;e++){var g=c[e],h=J.getPathNodeKey(g);if("array"==g.syntax&&d.list){var i=d.list.item(h);i||b===!1||(i=d.list._addItem(h),i.data._path=g.property),d=i}else d.container&&(d=d.container.scope[h]);var j=d&&d.data;if(!j)break}return j}function x(){return this._path}function y(){var a=this._path;return"["==a[0]?+a.slice(1,-1):a.slice(1)}function z(a){return{state:this.get(a)}}function A(a){return this.set(a.state)}var B=a("milo-core"),C=B.classes.Mixin,D=a("../c_facet"),E=a("./cf_registry"),F=(B.Messenger,a("../msg_src/dom_events")),G=a("../msg_api/data"),H=a("../msg_api/de_data"),I=B.Model,J=I._utils.path,K=I._utils.model,L=I._utils.changeDataHandler,M=L.getTransactionFlag,N=L.setTransactionFlag,O=L.postTransactionFinished,P=B.proto,Q=B.util.logger,R=P.createSubclass(D,"Data");P.extendProto(R,{start:c,getState:z,setState:A,get:p,set:k,del:m,splice:s,len:u,path:w,getPath:x,getKey:y,_get:q,_set:l,_del:n,_splice:t,_len:v,_setScalarValue:o,_getScalarValue:r,_bubbleUpDataChange:f,_queueDataChange:g,_postDataChanges:i,_prepareMessageSource:d}),E.add(R),b.exports=R,["push","pop","unshift","shift"].forEach(function(a){var b=I.Path.prototype[a];P.defineProperty(R.prototype,a,b)});var S={trigger:"trigger"}},{"../c_facet":16,"../msg_api/data":35,"../msg_api/de_data":36,"../msg_src/dom_events":38,"./cf_registry":30,"milo-core":105}],19:[function(a,b){"use strict";function c(a){var b=a.domConfig||{},c=b.tagName||"div",e=document.createElement(c),f=a.content,g=a.template;return d(e,b),"string"==typeof f&&(e.innerHTML=g?G.template(g)({content:f}):f),e}function d(a,b){var c=b&&b.cls,d=b&&b.attributes;d&&E.eachKey(d,function(b,c){a.setAttribute(c,b)}),c&&j(a,"add",c)}function e(){var a=this.owner.el;d(a,this.config);var b=window.getComputedStyle(a);this._visible=b&&"none"!=b.display}function f(){this.toggle(!0)}function g(){this.toggle(!1)}function h(a){a="undefined"==typeof a?!this._visible:!!a,this._visible=a;var b=this.owner.el;
return b.style.display=a?"block":"none",a}function i(a,b,c){j(this.owner.el,a,b,c)}function j(a,b,c,d){function e(a){g?void 0===d?f[b](a):f[b](a,d):f[b](a)}var f=a.classList,g="toggle"==b;if(Array.isArray(c))c.forEach(e);else{if("string"!=typeof c)throw new Error("unknown type of CSS classes parameter");e(c)}}function k(){this.owner.el&&I.detachComponent(this.owner.el)}function l(a,b){if(!this.owner.el)throw new Error("Cannot call setStyle on owner with no element: "+this.owner.constructor.name);this.owner.el.style[a]=b}function m(a){for(var b in a)this.owner.el.style[b]=a[b]}function n(a){return this.owner.el&&this.owner.el.cloneNode(a)}function o(){var a=J.createElement(this.config);return a}function p(){I.removeElement(this.owner.el)}function q(a){this.owner.el.appendChild(a)}function r(a){var b=this.owner.el,c=b.firstChild;c?b.insertBefore(a,c):b.appendChild(a)}function s(a){for(;a.childNodes.length;)this.append(a.childNodes[0])}function t(a){for(;a.childNodes.length;)this.prepend(a.childNodes[a.childNodes.length-1])}function u(a){var b=this.owner.el,c=b.parentNode;c.insertBefore(a,b.nextSibling)}function v(a){var b=this.owner.el,c=b.parentNode;c.insertBefore(a,b)}function w(){var a=this.owner.getScopeParent();a&&a.el.appendChild(this.owner.el)}function x(){return I.children(this.owner.el)}function y(a,b){if(!K.hasOwnProperty(a))throw new Error("incorrect find direction: "+a);var c=this.owner.el,d=this.owner.scope,e=document.createTreeWalker(d._rootEl,NodeFilter.SHOW_ELEMENT);e.currentNode=c;for(var f=e[K[a]](),g=(Object.keys(d),!1);f;){var h=new H(f);if(h.node&&(h.parse().validate(),d.hasOwnProperty(h.compName))){var i=d[h.compName];if(!b||b(i)){g=!0;break}}e.currentNode=f,f=e[K[a]]()}return g?i:void 0}function z(){var a=window.getSelection();if(!a.isCollapsed)return!0;var b=a.focusNode&&a.focusNode.textContent,c=b&&" "==b.charAt(0)?1:0;if(a.anchorOffset!=c)return!0;var d=document.createTreeWalker(this.owner.el,NodeFilter.SHOW_TEXT);d.currentNode=a.anchorNode;var e=d.previousNode(),f=e?""==!e.nodeValue.trim():!1;return f}function A(){var a=window.getSelection();if(!a.isCollapsed)return!0;var b=a.focusNode&&a.focusNode.textContent,c=b&&" "==b.charAt(b.length-1)?a.anchorNode.length-1:a.anchorNode.length;if(a.anchorOffset<c)return!0;var d=document.createTreeWalker(this.owner.el,NodeFilter.SHOW_TEXT);d.currentNode=a.anchorNode;var e=d.nextNode(),f=e?""==!e.nodeValue.trim():!1;return f}var B=a("../c_facet"),C=a("./cf_registry"),D=a("milo-core"),E=D.proto,F=D.util.check,G=(F.Match,D.util.doT),H=(a("../../binder"),a("../../attributes/a_bind")),I=a("../../util/dom"),J=(a("../../config"),E.createSubclass(B,"Dom"));E.extend(J,{createElement:c}),E.extendProto(J,{start:e,show:f,hide:g,toggle:h,detach:k,remove:p,append:q,prepend:r,appendChildren:s,prependChildren:t,insertAfter:u,insertBefore:v,appendToScopeParent:w,children:x,setStyle:l,setStyles:m,copy:n,createElement:o,addCssClasses:E.partial(i,"add"),removeCssClasses:E.partial(i,"remove"),toggleCssClasses:E.partial(i,"toggle"),find:y,hasTextBeforeSelection:z,hasTextAfterSelection:A}),C.add(J),b.exports=J;var K={up:"previousNode",down:"nextNode"}},{"../../attributes/a_bind":4,"../../binder":8,"../../config":64,"../../util/dom":79,"../c_facet":16,"./cf_registry":30,"milo-core":105}],20:[function(a,b){"use strict";function c(){p.prototype.init.apply(this,arguments),this._createMessageSourceWithAPI(r),this._dragData={};var a=this.config._dataTypeInfo||"";this._dataTypeInfo="function"==typeof a?a:function(){return a}}function d(a){return this.owner.el.contains(a)?void(this._dragHandle=a):v.warn("drag handle should be inside element to be dragged")}function e(){p.prototype.start.apply(this,arguments),f.call(this),this.onMessages({mousedown:h,"mouseenter mouseleave mousemove":i,dragstart:j,drag:k,dragend:l}),this.owner.onMessages({getstatestarted:{subscriber:g,context:this},getstatecompleted:{subscriber:f,context:this}})}function f(){this.owner.el&&this.owner.el.setAttribute("draggable",!0)}function g(){this.owner.el&&this.owner.el.removeAttribute("draggable")}function h(a,b){this.__mouseDownTarget=b.target,n.call(this)&&(window.getSelection().empty(),b.stopPropagation())}function i(a,b){var c=n.call(this);this.owner.el.setAttribute("draggable",c),"false"!=document.body.getAttribute("data-dragEnableEvent")&&b.stopPropagation()}function j(a,b){function c(){var a=this.config.meta,b=a&&a.params,c=a&&a.data,d=u.result(b,e),g=u.result(c,e);this._dragMetaDataType=f.setComponentMeta(e,d,g),this._dragMetaData=g}function d(){this.config.dataTypes&&(this._dataTypesData=u.mapKeys(this.config.dataTypes,function(a,b){var c=a.call(this.owner,b);return"object"==typeof c&&(c=JSON.stringify(c)),c&&f.setData(b,c),c},this))}if(b.stopPropagation(),this.config.off||!n.call(this))return void b.preventDefault();var e=this.owner,f=new s(b);this._dragData=f.setComponentState(e),c.call(this),d.call(this),m.call(this,f),s.service.postMessageSync("dragdropstarted",{eventType:"dragstart",dragDrop:f,dragFacet:this})}function k(a,b){if(!o.call(this,b)){var c=new s(b);c.setComponentState(this.owner,this._dragData),c.setData(this._dragMetaDataType,this._dragMetaData),this._dataTypesData&&u.eachKey(this._dataTypesData,function(a,b){a&&c.setData(b,a)}),m.call(this,c)}}function l(a,b){if(!o.call(this,b)){b.stopPropagation();var c=new s(b);s.service.postMessageSync("completedragdrop",{eventType:"dragend",dragDrop:c,dragFacet:this})}}function m(a){var b=u.result(this.config.allowedEffects,this.owner);a.setAllowedEffects(b)}function n(){return!this._dragHandle||this._dragHandle.contains(this.__mouseDownTarget)}function o(a){return this.config.off?(a.preventDefault(),!0):!1}var p=a("../c_facet"),q=a("./cf_registry"),r=a("../msg_src/dom_events"),s=(a("../c_class"),a("../../util/dragdrop")),t=a("milo-core"),u=t.proto,v=t.util.logger,w=u.createSubclass(p,"Drag");u.extendProto(w,{init:c,start:e,setHandle:d}),q.add(w),b.exports=w},{"../../util/dragdrop":82,"../c_class":15,"../c_facet":16,"../msg_src/dom_events":38,"./cf_registry":30,"milo-core":105}],21:[function(a,b){"use strict";function c(){j.prototype.init.apply(this,arguments),this._createMessageSourceWithAPI(l,new m)}function d(){j.prototype.start.apply(this,arguments),this.owner.el.classList.add("cc-module-relative"),this.onMessages({"dragenter dragover":e,drop:f,"dragenter dragover dragleave drop dragin dragout":g})}function e(a,b){var c=new n(b);b.stopPropagation(),b.preventDefault(),q.call(this,c)||c.setDropEffect("none")}function f(a,b){b.stopPropagation();var c=new n(b);n.service.postMessageSync("dragdropcompleted",{eventType:"drop",dragDrop:c,dropFacet:this,component:this.owner})}function g(a,b){n.service.postMessageSync(a,{event:b,dropFacet:this,component:this.owner})}function h(a,b){var c=this.config.allow,d=!0;if(b=b||this.owner,c&&c.checkParent){var e=this.owner.getScopeParent("Drop");e&&(d=h.call(e.drop,a,b))}return d&&i.call(this,a,b)}function i(a,b){var c=this.config.allow;if(a.isComponent()){var d=c&&c.components,e=a.getComponentMeta();switch(typeof d){case"undefined":return!0;case"boolean":return d;case"string":return e&&e.compClass==d;case"function":return d.call(this.owner,e,a,b);case"object":if(Array.isArray(d))return d.indexOf(e&&e.compClass)>=0;var f=d[e&&e.compClass];return!!o.result(f,this.owner,e,a);default:throw new Error("Incorrect allowed components in config")}}else{var g=c&&c.dataTypes;switch(typeof g){case"undefined":return!1;case"string":return a.types.indexOf(g)>=0}}}var j=a("../c_facet"),k=a("./cf_registry"),l=a("../msg_src/dom_events"),m=a("../msg_api/drop"),n=a("../../util/dragdrop"),o=a("milo-core").proto,p=o.createSubclass(j,"Drop");o.extendProto(p,{init:c,start:d}),k.add(p),b.exports=p;var q=o.throttle(h,50)},{"../../util/dragdrop":82,"../c_facet":16,"../msg_api/drop":37,"../msg_src/dom_events":38,"./cf_registry":30,"milo-core":105}],22:[function(a,b){"use strict";function c(){d.prototype.init.apply(this,arguments);var a=new g(this,void 0,void 0,this.owner);this._setMessageSource(a),h.defineProperty(this,j,a)}var d=a("../c_facet"),e=a("./cf_registry"),f=a("milo-core"),g=(f.Messenger,a("../msg_src/dom_events")),h=f.proto,i=h.createSubclass(d,"Events");h.extendProto(i,{init:c}),e.add(i),b.exports=i;var j="_domEventsSource";g.useWith(i,j,["trigger"])},{"../c_facet":16,"../msg_src/dom_events":38,"./cf_registry":30,"milo-core":105}],23:[function(a,b){"use strict";function c(){k.prototype.init.apply(this,arguments);var a=new n(this,void 0,void 0,this.owner);this._setMessageSource(a),o.defineProperty(this,s,a)}function d(){function a(a){b.postMessage("domready",a)}k.prototype.start.apply(this,arguments);var b=this;milo(a)}function e(){k.prototype.destroy.apply(this,arguments)}function f(){return this.owner.el.contentWindow}function g(){var a=this.getWindow().document.readyState;return"loading"!=a?a:!1}function h(){var a=this.getWindow().milo;return this.isReady()&&a&&a.milo_version}function i(a){if("function"==typeof a){var b=this;this.whenMiloReady(function(){b.getWindow().milo(a)})}var c=this.getWindow();return c&&c.milo}function j(a,b){return function(c){function d(){c.apply(e,f)}var e=this,f=o.slice(arguments,1);a.call(this)?d():this.on(b,d)}}var k=a("../c_facet"),l=a("./cf_registry"),m=a("milo-core"),n=(m.Messenger,a("../msg_src/frame")),o=(a("../../services/de_constrs"),m.proto),p=o.createSubclass(k,"Frame"),q=j(g,"domready"),r=j(h,"message:miloready");o.extendProto(p,{init:c,start:d,destroy:e,getWindow:f,isReady:g,whenReady:q,isMiloReady:h,whenMiloReady:r,milo:i}),l.add(p),b.exports=p;var s="_messageSource";n.useWith(p,s,["trigger"])},{"../../services/de_constrs":68,"../c_facet":16,"../msg_src/frame":39,"./cf_registry":30,"milo-core":105}],24:[function(a,b){"use strict";function c(){return{state:{index:this.getIndex()}}}function d(a){this.setIndex(a.state.index)}function e(){return this.index}function f(a){this.index=a}function g(){this.list.removeItem(this.index)}function h(){this.list.extractItem(this.index)}var i=a("../c_facet"),j=a("./cf_registry"),k=a("milo-core"),l=(k.Model,k.proto),m=(a("../../services/mail"),l.createSubclass(i,"Item"));l.extendProto(m,{getState:c,setState:d,getIndex:e,setIndex:f,removeItem:g,extractItem:h,require:["Container","Dom","Data"]}),j.add(m),b.exports=m},{"../../services/mail":70,"../c_facet":16,"./cf_registry":30,"milo-core":105}],25:[function(a,b){"use strict";function c(){y.prototype.init.apply(this,arguments);C.defineProperties(this,{_listItems:[],_listItemsHash:{}}),C.defineProperty(this,"itemSample",null,C.WRIT)}function d(){this.owner.on("childrenbound",e)}function e(){var a=this.dom.children(),b=this.list._listItems,c=this.list._listItemsHash;if(a&&a.forEach(function(a){var d=z.getComponent(a);d&&d.item&&(b.push(d),c[d.name]=d,d.item.list=this.list)},this),b.length){var d=b[0];b.splice(0,1),delete c[d.name],b.forEach(function(a,b){a.item.setIndex(b)})}if(!d)throw new Error("No child component has Item facet");this.list.itemSample=d,d.dom.hide(),d.remove(!0),d.dom.removeCssClasses(L),d.walkScopeTree(function(a){delete a.el[K.componentRef]}),this.list._createCacheTemplate()}function f(){if(!this.itemSample)return!1;{var a=this.itemSample,b=a.el.cloneNode(!0),c=a.componentInfo.attr;C.clone(c)}c.compName="{{= it.componentName() }}",c.el=b,c.decorate();var d="{{ var i = it.count; while(i--) { }}"+b.outerHTML+"{{ } }}";this.itemsTemplate=F.compile(d)}function g(a){return this._listItems[a]}function h(){return this._listItems.length}function i(a,b){this._listItems.splice(a,0,b),this._listItemsHash[b.name]=b,b.item.list=this,b.item.setIndex(+a)}function k(a){return this._listItemsHash[a.name]==a}function l(a,b){return a=a||this.count(),this.owner.data.splice(a,0,b||{}),this.item(a)}function m(a){if(a=a||this.count(),this.item(a))throw Error("attempt to create item with ID of existing item");var b=z.copy(this.itemSample,!0),c=this._itemPreviousComponent(a);return c.el.parentNode?(c.dom.insertAfter(b.el),this._setItem(a,b),b.el.style.display="",n.call(this,a+1),b):E.warn("list item sample was removed from DOM, probably caused by wrong data. Reset list data with array")}function n(a,b){a=a||0,b=b||this.count();for(var c=a;b>c;c++){var d=this._listItems[c];d?d.item.setIndex(c):E.warn("List: no item at position",c)}}function o(a,b){var c=C.slice(arguments,2);c.length<a&&c.concat(C.repeat(a-c.length,{}));var d=[b,0].concat(c),e=this.owner.data;e.splice.apply(e,d)}function p(a,b){if(G(a,H.Integer),0>a)throw new Error("can't add negative number of items");if(0!=a){var c=this.itemsTemplate({componentName:J,count:a}),d=document.createElement("div");d.innerHTML=c,D(d,this.owner.container.scope);var e=I.children(d);if(a!=e.length&&E.error("number of items added is different from requested"),e&&e.length){var f=this.count(),g=0>b?0:"undefined"==typeof b||b>f?f:b,h=0==g?this.itemSample:this._listItems[g-1],i=document.createDocumentFragment(),j=[];if(e.forEach(function(a){var b=z.getComponent(a);return b?(j.push(b),this._setItem(g++,b),i.appendChild(a),void(a.style.display="")):E.error("List: element in new items is not a component")},this),n.call(this,g),!h.el.parentNode)return E.warn("list item sample was removed from DOM, probably caused by wrong data. Reset list data with array");h.dom.insertAfter(i),C.deferMethod(j,"forEach",function(a){a.broadcast("stateready")})}}}function q(a){return this.owner.data.splice(a,1)}function r(a){var b=this._removeItem(a,!1);return this._updateDataPaths(a,this.count()),b}function s(a,b){var c=this.item(a);return c?(this._listItems[a]=void 0,delete this._listItemsHash[c.name],b!==!1?c.destroy():(c.remove(),c.dom.remove()),this._listItems.splice(a,1),n.call(this,a),c):E.warn("attempt to remove list item with id that does not exist")}function t(a,b){var c=this.item(a);c.dom.insertAfter(b.el),this._removeItem(a),this._setItem(a,b)}function u(a){for(;a>=0&&!this._listItems[a];)a--;return a>=0?this._listItems[a]:this.itemSample}function v(a,b){for(var c=a;b>c;c++){var d=this.item(c);d?d.data._path="["+c+"]":E.warn("Data: no item for index",j)}}function w(a,b){this._listItems.forEach(function(b,c){b?a.apply(this,arguments):E.warn("List$each: item",c,"is undefined")},b||this)}function x(){this.itemSample&&this.itemSample.destroy(!0),y.prototype.destroy.apply(this,arguments)}var y=a("../c_facet"),z=a("../c_class"),A=a("./cf_registry"),B=a("milo-core"),C=B.proto,D=(a("../../services/mail"),a("../../binder")),E=B.util.logger,F=B.util.doT,G=B.util.check,H=G.Match,I=a("../../util/dom"),J=a("../../util/component_name"),K=a("../../config"),L="ml-list-item-sample",M=C.createSubclass(y,"List");C.extendProto(M,{init:c,start:d,destroy:x,require:["Container","Dom","Data"],_itemPreviousComponent:u,item:g,count:h,contains:k,addItem:l,addItems:o,replaceItem:t,removeItem:q,extractItem:r,each:w,_setItem:i,_removeItem:s,_addItem:m,_addItems:p,_createCacheTemplate:f,_updateDataPaths:v}),A.add(M),b.exports=M},{"../../binder":8,"../../config":64,"../../services/mail":70,"../../util/component_name":76,"../../util/dom":79,"../c_class":15,"../c_facet":16,"./cf_registry":30,"milo-core":105}],26:[function(a,b){"use strict";function c(){this.m=new k(this.config.data,this),h.prototype.init.apply(this,arguments)}function d(){var a=this.m.get();return"object"==typeof a&&(a=l.deepClone(a)),{state:a}}function e(a){return this.m.set(a.state)}function f(){this._messenger=this.m._messenger}function g(){this.m.destroy(),h.prototype.destroy.apply(this,arguments)}var h=a("../c_facet"),i=a("./cf_registry"),j=a("milo-core"),k=j.Model,l=(j.classes.Mixin,j.proto),m=l.createSubclass(h,"Model");l.extendProto(m,{init:c,getState:d,setState:e,_createMessenger:f,destroy:g}),i.add(m),b.exports=m,k.useWith(m,"m")},{"../c_facet":16,"./cf_registry":30,"milo-core":105}],27:[function(a,b){"use strict";function c(){this.m=new i(this.config.options,this),f.prototype.init.apply(this,arguments),this.m.proxyMethods(this)}function d(){this._messenger=this.m._messenger}function e(){this.m.destroy(),f.prototype.destroy.apply(this,arguments)}var f=a("../c_facet"),g=a("./cf_registry"),h=a("milo-core"),i=h.Model,j=h.proto,k=j.createSubclass(f,"Options");j.extendProto(k,{init:c,destroy:e,_createMessenger:d}),g.add(k),b.exports=k},{"../c_facet":16,"./cf_registry":30,"milo-core":105}],28:[function(a,b){"use strict";function c(){i.prototype.init.apply(this,arguments);var a=this.config.interpolate===!1?void 0:this.config.compile||milo.config.template.compile;this.set(this.config.template||"",a,this.config.compileOptions)}function d(){i.prototype.start.apply(this,arguments),this.config.autoRender&&(this.render(),this.config.autoBinder&&this.binder())}function e(){return this._template}function f(a,b,c){return m(a,o.OneOf(String,Function)),m(b,o.Optional(Function)),"function"==typeof a?this._template=a:(this._templateStr=a,b?this._compile=b:b=this._compile,b&&(this._template=b(a,c))),this}function g(a){return this.owner.el.innerHTML=this._template?this._template(a):this._templateStr,this}function h(){return this.owner.container?this.owner.container.binder():void n.error("TemplateFacet: Binder called without container facet.")}var i=a("../c_facet"),j=a("./cf_registry"),k=a("milo-core"),l=k.proto,m=k.util.check,n=k.util.logger,o=m.Match,p=(a("../../binder"),l.createSubclass(i,"Template"));l.extendProto(p,{init:c,start:d,set:f,getCompiled:e,render:g,binder:h}),j.add(p),b.exports=p},{"../../binder":8,"../c_facet":16,"./cf_registry":30,"milo-core":105}],29:[function(a,b){"use strict";function c(){j.prototype.init.apply(this,arguments),this._activeState="",this._defaultKey="",this._state={}}function d(){return this._state[this._activeState]||this._state[this._defaultKey]}function e(a){this._state[""]=a,this.setActiveState("")}function f(a){this._activeState=a}function g(a,b,c){if(!a)throw new Error("Transfer$setStateWithKey: no key");this._defaultKey=c?a:this._defaultKey||a,this._state[a]=b,this.setActiveState(a)}function h(a){return"string"==typeof a&&this._state[a]}function i(){var a=this.getState();return{compName:a&&a.compName,compClass:a&&a.compClass}}var j=a("../c_facet"),k=a("./cf_registry"),l=a("milo-core").proto,m=l.createSubclass(j,"Transfer");l.extendProto(m,{init:c,getState:d,setState:e,setActiveState:f,setStateWithKey:g,getStateWithKey:h,getComponentMeta:i}),k.add(m),b.exports=m},{"../c_facet":16,"./cf_registry":30,"milo-core":105}],30:[function(a,b){"use strict";var c=a("../../abstract/registry"),d=a("../c_facet"),e=new c(d);e.add(d),b.exports=e},{"../../abstract/registry":3,"../c_facet":16}],31:[function(a,b){"use strict";function c(a,b,c,d){c.parse().validate(),this.scope=a,this.el=b,this.attr=c,this.name=c.compName,this.ComponentClass=f(c,d),this.extraFacetsClasses=g(this.ComponentClass,c,d),this.ComponentClass&&i(this.ComponentClass,this.extraFacetsClasses)&&(this.container={})}function d(){delete this.el,this.attr.destroy()}function e(a,b){a=a||l(),m.rename(this,a,b),this.attr.compName=a,this.attr.decorate()}function f(a,b){var c=j.get(a.compClass);return c||h(b,"class "+a.compClass+" is not registered"),c}function g(a,b,c){var d=b.compFacets,e={};return Array.isArray(d)&&d.forEach(function(d){d=p.firstUpperCase(d),a.hasFacet(d)&&h(c,"class "+a.name+" already has facet "+d),e[d]&&h(c,"component "+b.compName+" already has facet "+d);var f=k.get(d);e[d]=f}),e}function h(a,b){if(a!==!1)throw new Error(b);o.error("ComponentInfo binder error:",b)}function i(a,b){function c(){return a.prototype.facetsClasses&&p.someKey(a.prototype.facetsClasses,d)}function d(a){return a.requiresFacet("container")}return a.hasFacet("container")||"Container"in b||p.someKey(b,d)||c()}var j=a("./c_registry"),k=a("./c_facets/cf_registry"),l=a("../util/component_name"),m=a("./scope"),n=a("milo-core"),o=n.util.logger,p=n.proto;b.exports=c,p.extendProto(c,{destroy:d,rename:e})},{"../util/component_name":76,"./c_facets/cf_registry":30,"./c_registry":32,"./scope":40,"milo-core":105}],32:[function(a,b){"use strict";var c=a("../abstract/registry"),d=a("./c_class"),e=new c(d);e.add(d),b.exports=e},{"../abstract/registry":3,"./c_class":15}],33:[function(a,b){"use strict";function c(a){return a.hasOwnProperty(h.componentRef)}function d(a){return a&&a[h.componentRef]}function e(a,b,c){j(b,k.Optional(Boolean)),j(c,k.Optional(k.OneOf(Function,String)));var d=f(c);return g(a,b,d)}function f(a){if("function"==typeof a)return a;if("string"==typeof a){var b=l.firstLowerCase(a);return function(a){return a.hasFacet(b)}}}function g(a,b,c){if(b!==!1){var e=d(a);if(e&&(!c||c(e)))return e}return a.parentNode?g(a.parentNode,!0,c):void 0}{var h=a("../config"),i=a("milo-core"),j=i.util.check,k=j.Match,l=i.proto;b.exports={isComponent:c,getComponent:d,getContainingComponent:e,_makeComponentConditionFunc:f}}},{"../config":64,"milo-core":105}],34:[function(a,b){"use strict";var c=a("../c_class"),d=a("../c_registry"),e=c.createComponentClass("View",["container"]);d.add(e),b.exports=e},{"../c_class":15,"../c_registry":32}],35:[function(a,b){"use strict";function c(a){j.prototype.init.apply(this,arguments),this.component=a,this.elData=h(a.el)}function d(){var a=this.component.data.config.get,b="function"==typeof a?a.call(this.component):this.elData.get(this.component.el);return this.component.data._value=b,b}function e(a){var b=this.component.data.config.event,c=b||this.elData.event(this.component.el);return""==a&&c?c:void 0}function f(a,b,c){return c.newValue!=c.oldValue}function g(){var a=this.component.data._value,b=this.value(),c={path:"",type:"changed",oldValue:a,newValue:b};return c}var h=a("./de_data"),i=a("milo-core"),j=i.classes.MessengerAPI,k=i.proto,l=i.util.check,m=(l.Match,k.createSubclass(j,"DataMsgAPI",!0));k.extendProto(m,{init:c,translateToSourceMessage:e,filterSourceMessage:f,createInternalData:g,value:d}),b.exports=m},{"./de_data":36,"milo-core":105}],36:[function(a,b){"use strict";function c(a){var b=h[a.type];return b?b.property:h.byDefault.property}function d(a){var b=h[a.type];return b?b.event:h.byDefault.event}var e=a("milo-core").proto,f=function(a){var b=a.tagName.toLowerCase(),c=g[b];return c||g.byDefault};b.exports=f;var g={byDefault:{property:"innerHTML"},div:{property:"innerHTML"},span:{property:"innerHTML",event:"input"},p:{property:"innerHTML",event:"input"},input:{property:c,event:d},textarea:{property:"value",event:"input"},select:{property:"value",event:"change"},img:{property:"src"},caption:{property:"innerHTML",event:"input"},thead:{property:"innerHTML",event:"input"},tbody:{property:"innerHTML",event:"input"},tfoot:{property:"innerHTML",event:"input"}};e.eachKey(g,function(a){var b=a.property,c=a.event;"function"!=typeof b&&(a.property=function(){return b});var d=a.property;"function"!=typeof c&&(a.event=function(){return c}),a.get||(a.get=function(a){return a[d(a)]}),a.set||(a.set=function(a,b){return a[d(a)]="undefined"==typeof b?"":b})});var h={byDefault:{property:"value",event:"input"},checkbox:{property:"checked",event:"change"},radio:{property:"checked",event:"change"},text:{property:"value",event:"input"}}},{"milo-core":105}],37:[function(a,b){"use strict";function c(a){return h.hasOwnProperty(a)?h[a]:a}function d(){delete this._currentTarget,delete this._inside}function e(a,b,c){var e=!0;return"dragenter"==a&&"dragin"==b?(this._currentTarget=c.target,e=!this._inside,this._inside=!0):"dragleave"==a&&"dragout"==b?(e=this._currentTarget==c.target,e&&d.call(this)):"drop"==a&&d.call(this),e}var f=a("milo-core").classes.MessengerAPI,g=_.createSubclass(f,"DropMsgAPI",!0);_.extendProto(g,{translateToSourceMessage:c,filterSourceMessage:e}),b.exports=g;var h={dragin:"dragenter",dragout:"dragleave"}},{"milo-core":105}],38:[function(a,b){"use strict";function c(a,b,c,d){k(d,i),this.component=d,h.prototype.init.apply(this,arguments)}function d(){h.prototype.destroy.apply(this,arguments),delete this.component}function e(){return this.component.el}var f=a("../../services/dom_source"),g=a("milo-core"),h=g.classes.MessageSource,i=a("../c_class"),j=g.proto,k=g.util.check,l=(k.Match,j.createSubclass(f,"DOMEventsSource",!0));j.extendProto(l,{init:c,destroy:d,emitter:e}),b.exports=l},{"../../services/dom_source":69,"../c_class":15,"milo-core":105}],39:[function(a,b){"use strict";function c(a,b,c,d){if(m(d,i),this.component=d,"iframe"!=d.el.tagName.toLowerCase())throw new Error("component for FrameMessageSource can only be attached to iframe element");k.prototype.init.apply(this,arguments)}function d(){return this.component.el.contentWindow}function e(){var a=this.frameWindow();a?a.addEventListener("message",this,!1):n.warn("FrameMessageSource: frame window is undefined")}function f(){var a=this.frameWindow();a?a.removeEventListener("message",this,!1):n.warn("FrameMessageSource: frame window is undefined")}function g(a,b){b=b||{},b.type=a,this.frameWindow().postMessage(b,"*")}function h(a){this.dispatchMessage(a.data.type,a)}var i=a("../c_class"),j=a("milo-core"),k=j.classes.MessageSource,l=j.proto,m=j.util.check,n=j.util.logger,o=(m.Match,l.createSubclass(k,"FrameMessageSource",!0));l.extendProto(o,{init:c,addSourceSubscriber:e,removeSourceSubscriber:f,trigger:g,frameWindow:d,handleEvent:h}),b.exports=o},{"../c_class":15,"milo-core":105}],40:[function(a,b){"use strict";function c(a,b){u.defineProperties(this,{_rootEl:a,_hostObject:b},u.WRIT)}function d(a,b){if("string"==typeof b?a.name=b:b=a.name,this.hasOwnProperty(b))throw new Error("duplicate object name: "+b);l(b),f.call(this,a,b)}function e(a,b){"string"==typeof b?a.name=b:b=a.name;var c=this.hasOwnProperty(b);c?x.error("Scope: duplicate object name: "+b):(c=!y.test(b),c&&x.error("Scope: name should start from letter, this name is not allowed: "+b)),c&&(b=v(),a.name=b),f.call(this,a,b)}function f(a,b){this[b]=a,a.scope=this,"function"==typeof a.postMessage&&a.postMessage("addedtoscope")}function g(a){w(a,c),a._each(d,this)}function h(a,b){b._add(a),this._remove(a.name),a.scope=b}function i(a){a._each(function(b){this._add(b,b.name),a._remove(b.name)},this)}function j(a,b){u.eachKey(this,a,b||this,!0)}function k(a,b){return u.filterKeys(this,a,b||this,!0)}function l(a){if(!y.test(a))throw new Error("name should start from letter, this name is not allowed: "+a)}function m(){return Object.keys(this).length}function n(){var a=Object.keys(this)[0];return a&&this[a]}function o(a,b){if(!(a in this))return void(b||x.warn("removing object that is not in scope"));var c=this[a];delete this[a],"function"==typeof c.postMessage&&c.postMessage("removedfromscope")}function p(){this._each(function(a,b){delete this[b].scope,delete this[b]},this)}function q(){this._rootEl=null}function r(a){return this.hasOwnProperty(a.name)}function s(a,b,c){a.scope&&c!==!1?(a.scope._remove(a.name),a.scope._add(a,b)):a.name=b}var t=a("milo-core"),u=t.proto,v=a("../util/component_name"),w=t.util.check,x=(w.Match,t.util.logger);u.extendProto(c,{_add:d,_safeAdd:e,_copy:g,_each:j,_move:h,_merge:i,_length:m,_any:n,_remove:o,_clean:p,_detachElement:q,_has:r,_filter:k}),u.extend(c,{rename:s}),b.exports=c;var y=/^[A-Za-z][A-Za-z0-9\_\$]*$/},{"../util/component_name":76,"milo-core":105}],41:[function(a,b){"use strict";function c(a){this.el.disabled=a}function d(){return!!this.el.disabled}var e=a("../c_class"),f=a("../c_registry"),g=a("milo-core").proto,h=e.createComponentClass("MLButton",{events:void 0,dom:{cls:"ml-ui-button"}});f.add(h),b.exports=h,g.extendProto(h,{disable:c,isDisabled:d})},{"../c_class":15,"../c_registry":32,"milo-core":105}],42:[function(a,b){"use strict";function c(){k.prototype.init.apply(this,arguments),this.on("childrenbound",d)}function d(){m.defineProperties(this,{_comboInput:this.container.scope.input,_comboList:this.container.scope.datalist}),this._comboList.template.set(o),this._comboInput.data.on("input",{subscriber:i,context:this})}function e(){return this._comboInput?this._comboInput.data.get():void 0}function f(a){return h.call(this,"set",a)}function g(){return h.call(this,"del",value)}function h(a,b){if(this._comboInput){var c=this._comboInput.data[a](b);return i.call(this),c}}function i(){this.data.dispatchSourceMessage(n)}function j(){this._comboList.template.render({comboOptions:this.model.get()})}var k=a("../c_class"),l=a("../c_registry"),m=a("milo-core").proto,n="mlcombochange",o='{{~ it.comboOptions :option }}                             <option value="{{= option.label }}"></option>                          {{~}}',p=k.createComponentClass("MLCombo",{events:void 0,data:{get:e,set:f,del:g,splice:void 0,event:n},model:{messages:{"***":{subscriber:j,context:"owner"}}},dom:{cls:"ml-ui-datalist"},container:void 0});l.add(p),b.exports=p,m.extendProto(p,{init:c})},{"../c_class":15,"../c_registry":32,"milo-core":105}],43:[function(a,b){"use strict";function c(){r.prototype.init.apply(this,arguments),this._dataValidation=function(){},this.model.set([]),this.once("childrenbound",j)}function d(a){"function"==typeof a&&(this._dataValidation=a)}function e(a){this._combo.setOptions(a)}function f(){this._combo.clearComboInput()}function g(a){this._combo.toggleAddButton(a)}function h(a){this._combo.setAddItemPrompt(a)}function i(){r.prototype.destroy.apply(this,arguments),this._connector&&milo.minder.destroyConnector(this._connector),this._connector=null}function j(){this.template.render().binder(),k.call(this)}function k(){t.defineProperties(this,{_combo:this.container.scope.combo,_list:this.container.scope.list}),this._connector=milo.minder(this._list.model,"<<<->>>",this.model),this._combo.data.on("",{subscriber:l,context:this}),this._combo.on("additem",{subscriber:q,context:this})}function l(a,b){b.newValue&&this._dataValidation(a,b,this._list.model.get())&&this._list.model.push(b.newValue),this._combo.data.del(),this._combo.data._value=""}function m(){this.data.dispatchSourceMessage(u)}function n(){var a=this.model.get();return"object"==typeof a?t.clone(a):a}function o(a){this.model.set(a)}function p(){return this.model.set([])}function q(a,b){this.postMessage("additem",b),this.events.postMessage("milo_combolistadditem",b)}var r=a("../c_class"),s=a("../c_registry"),t=a("milo-core").proto,u="mlcombolistchange",v=r.createComponentClass("MLComboList",{dom:{cls:"ml-ui-combo-list"},data:{get:n,set:o,del:p,event:u},events:void 0,container:void 0,model:{messages:{"***":{subscriber:m,context:"owner"}}},template:{template:'<div ml-bind="MLSuperCombo:combo"></div>                   <div ml-bind="MLList:list">                       <div ml-bind="MLListItem:item" class="list-item">                           <span ml-bind="[data]:label"></span>                           <span ml-bind="[events]:deleteBtn" class="glyphicon glyphicon-remove"></span>                       </div>                   </div>'}});s.add(v),b.exports=v,t.extendProto(v,{init:c,setOptions:e,setDataValidation:d,toggleAddButton:g,destroy:i,setAddItemPrompt:h,clearComboInput:f})},{"../c_class":15,"../c_registry":32,"milo-core":105}],44:[function(a,b){"use strict";function c(){return n.date(this.el.min)}function d(a){var b=n.toDate(a);this.el.min=b?k(b):""}function e(){return n.date(this.el.max)}function f(a){var b=n.toDate(a);this.el.max=b?k(b):""}function g(){return n.toDate(this.el.value)}function h(a){var b=n.toDate(a);this.el.value=b?k(b):"",j.call(this)}function i(){this.el.value="",j.call(this)}function j(){this.data.dispatchSourceMessage("input")}function k(a){function b(a){return 10>a?"0"+a:a}var c=[a.getFullYear(),b(a.getMonth()+1),b(a.getDate())],d=c.join("-");return d}var l=a("../c_class"),m=a("../c_registry"),n=a("milo-core").proto,o=l.createComponentClass("MLDate",{events:void 0,data:{get:g,set:h,del:i},dom:{cls:"ml-ui-date"}});n.extendProto(o,{getMin:c,setMin:d,getMax:e,setMax:f}),m.add(o),b.exports=o},{"../c_class":15,"../c_registry":32,"milo-core":105}],45:[function(a,b){"use strict";var c=a("../c_class"),d=a("../c_registry"),e=c.createComponentClass("MLDropTarget",["drop"]);d.add(e),b.exports=e},{"../c_class":15,"../c_registry":32}],46:[function(a,b){"use strict";function c(a){a.classList.toggle("ml-ui-foldtree--unfold")}function d(a,b){var c=b.getAttribute("data-item-id"),d=this._itemsMap[c];
this.postMessage("mlfoldtree_"+a,{item:d,el:b})}function e(a,b){var e=b.target;if(e.classList.contains("ml-ui-foldtree-button"))c(e.parentNode.parentNode);else{if(!e.classList.contains("ml-ui-foldtree-label"))return;d.call(this,a,e)}b.stopPropagation()}function f(a){this._itemTemplate=h.compile(a)}function g(a){function b(a){if(a.items)var d=_.map(a.items,function(a){var b=k();return c._itemsMap[b]=a,b});return n({itemIDs:d,data:a,itemTemplate:c._itemTemplate||m,treeTemplate:b})}var c=this;this._data=a,c._itemsMap={},this.el.innerHTML=b(a)}var h=a("milo-core").util.doT,i=a("../c_registry"),j=a("../c_class"),k=a("../../util/count"),l='<ul class="ml-ui-foldtree-list">                        {{~ it.data.items :item:index }}                            {{ var hasSubTree = item.items && item.items.length; }}                            <li {{? hasSubTree }}class="ml-ui-foldtree--has-multiple"{{?}}>                                <div class="ml-ui-foldtree-item">                                    {{? hasSubTree }}                                        <div class="ml-ui-foldtree-button"></div>                                    {{?}}                                    {{= it.itemTemplate({ item: item, id: it.itemIDs[index] }) }}                                </div>                                {{? hasSubTree }}                                    {{= it.treeTemplate(item) }}                                {{?}}                            </li>                        {{~}}                    </ul>',m=h.compile('            <span class="ml-ui-foldtree-label" data-item-id="{{= it.id }}">                {{= it.item.label }}            </span>'),n=h.compile(l),o=j.createComponentClass("MLFoldTree",{container:void 0,events:{messages:{"click dblclick":{subscriber:e,context:"owner"}}},dom:{cls:"ml-ui-foldtree-main"}});i.add(o),b.exports=o,_.extendProto(o,{setItemTemplate:f,renderTree:g})},{"../../util/count":77,"../c_class":15,"../c_registry":32,"milo-core":105}],47:[function(a,b){"use strict";var c=a("../c_class"),d=a("../c_registry"),e=c.createComponentClass("MLGroup",{container:void 0,data:void 0,events:void 0,dom:{cls:"ml-ui-group"}});d.add(e),b.exports=e},{"../c_class":15,"../c_registry":32}],48:[function(a,b){"use strict";var c=a("../c_class"),d=a("../c_registry"),e=c.createComponentClass("MLHyperlink",{events:void 0,data:void 0,dom:{cls:"ml-ui-hyperlink"}});d.add(e),b.exports=e},{"../c_class":15,"../c_registry":32}],49:[function(a,b){"use strict";function c(){i.prototype.init.apply(this,arguments)}function d(a){return this.model.set(a),a}function e(){var a=this.model.get();return a&&"object"==typeof a?k.clone(a):a}function f(){this.model.del()}function g(){this.data.dispatchSourceMessage(l)}function h(a,b){this.el.src=b.newValue,g.call(this)}var i=a("../c_class"),j=a("../c_registry"),k=a("milo-core").proto,l="mlimagechange",m=i.createComponentClass("MLImage",{data:{set:d,get:e,del:f,splice:void 0,event:l},model:{messages:{".src":{subscriber:h,context:"owner"}}},events:void 0,container:void 0,dom:{tagName:"img",cls:"ml-ui-image"}});j.add(m),b.exports=m,k.extendProto(m,{init:c})},{"../c_class":15,"../c_registry":32,"milo-core":105}],50:[function(a,b){"use strict";function c(a){this.el.disabled=a}function d(){return!!this.el.disabled}function e(a){this.el.setAttribute("maxlength",a)}var f=a("../c_class"),g=a("../c_registry"),h=a("milo-core").proto,i=f.createComponentClass("MLInput",{data:void 0,events:void 0,dom:{cls:"ml-ui-input"}});g.add(i),b.exports=i,h.extendProto(i,{disable:c,isDisabled:d,setMaxLength:e})},{"../c_class":15,"../c_registry":32,"milo-core":105}],51:[function(a,b){"use strict";function c(){p.prototype.init.apply(this,arguments),this.once("childrenbound",d),this.model.set([])}function d(){h.call(this)}function e(a){this._input.el.setAttribute("placeHolder",a)}function f(a){t=a||t}function g(){p.prototype.destroy.apply(this,arguments),this._connector&&milo.minder.destroyConnector(this._connector),this._connector=null}function h(){this.template.render().binder(),i.call(this)}function i(){r.defineProperties(this,{_input:this.container.scope.input,_button:this.container.scope.button,_list:this.container.scope.list}),this._connector=milo.minder(this._list.model,"<<<->>>",this.model),this._button.events.on("click",{subscriber:j,context:this})}function j(){var a=this._input.data.get(0);this._input.data&&t(a,function(a,b){this._list.model.push({label:a,value:b})}.bind(this)),this._input.data.del()}function k(){this.data.dispatchSourceMessage(s)}function l(){var a=this.model.get();return a?r.clone(a):void 0}function m(a){this.model.set(a)}function n(){return this.model.set([])}function o(){this.model.splice.apply(this.model,arguments)}var p=a("../c_class"),q=a("../c_registry"),r=a("milo-core").proto,s="mlinputlistchange",t=function(a,b){b(a)},u=p.createComponentClass("MLInputList",{dom:{cls:"ml-ui-input-list"},data:{get:l,set:m,del:n,splice:o,event:s},events:void 0,container:void 0,model:{messages:{"***":{subscriber:k,context:"owner"}}},template:{template:'            <div ml-bind="MLList:list">                <div ml-bind="MLListItem:item" class="list-item">                    <span ml-bind="[data]:label"></span>                    <span ml-bind="[events]:deleteBtn" class="glyphicon glyphicon-remove"></span>                </div>            </div>            <input type="text" ml-bind="MLInput:input" class="form-control">            <button ml-bind="MLButton:button" class="btn btn-default">                Add            </button>'}});q.add(u),b.exports=u,r.extendProto(u,{init:c,setAsync:f,setPlaceHolder:e,destroy:g})},{"../c_class":15,"../c_registry":32,"milo-core":105}],52:[function(a,b){"use strict";function c(){h.prototype.init.apply(this,arguments),this.on("childrenbound",g)}function d(){this._connector&&milo.minder.destroyConnector(this._connector),this._connector=null,h.prototype.destroy.apply(this,arguments)}function e(a){this.model.splice(a,1)}function f(a,b){var c=this.model.splice(a,1);return this.model.splice(b,0,c[0])}function g(){this.model.set([]),this._connector=milo.minder(this.model,"<<<-",this.data).deferChangeMode("<<<->>>")}var h=a("../c_class"),i=a("../c_registry"),j=a("milo-core").proto,k=h.createComponentClass("MLList",{dom:{cls:"ml-ui-list"},data:void 0,events:void 0,model:void 0,list:void 0});i.add(k),b.exports=k,j.extendProto(k,{init:c,destroy:d,removeItem:e,moveItem:f})},{"../c_class":15,"../c_registry":32,"milo-core":105}],53:[function(a,b){"use strict";function c(){q.prototype.init.apply(this,arguments),this.on("childrenbound",d)}function d(){var a=this.container.scope.deleteBtn;a&&a.events.on("click",{subscriber:this.removeItem,context:this})}function e(){try{var a=this.item.list.owner}catch(b){}a&&a.removeItem(this.item.index)}function f(a){var b=this.item.list.owner;b&&b.moveItem(this.item.index,a)}function g(a){return a.params&&a.params.index&&"MLListItem"==a.compClass}function h(){return this.isDropAllowed.apply(this,arguments)}function i(a,b){k.call(this);var c=new r(b),d=c.getComponentMeta(),e=c.getComponentState(),f=this.item.list.owner,g=d.params&&d.params.index;f.moveItem(+g,this.item.index,e)}function j(){this.dom.addCssClasses("ml-drag-over")}function k(){this.dom.removeCssClasses("ml-drag-over")}function l(){return{index:this.item.index}}function m(){var a=this.model.get();return null!==a&&"object"==typeof a?t.clone(a):a}function n(a){return"object"==typeof a&&this.data._set(a),this.model.set(a),p.call(this),a}function o(){this.data._del(),this.model.del(),p.call(this)}function p(){this.data.dispatchSourceMessage(u)}var q=a("../c_class"),r=a("../../util/dragdrop"),s=a("../c_registry"),t=a("milo-core").proto,u="mllistitemchange",v=q.createComponentClass("MLListItem",{container:void 0,dom:void 0,drag:{meta:{params:l}},drop:{messages:{dragenter:{subscriber:j,context:"owner"},dragover:{subscriber:j,context:"owner"},dragleave:{subscriber:k,context:"owner"},drop:{subscriber:i,context:"owner"}},allow:{components:h}},data:{get:m,set:n,del:o,event:u},model:void 0,item:void 0});s.add(v);var v=b.exports=v;t.extendProto(v,{init:c,moveItem:f,removeItem:e,isDropAllowed:g})},{"../../util/dragdrop":82,"../c_class":15,"../c_registry":32,"milo-core":105}],54:[function(a,b){"use strict";function c(){o.defineProperty(this,"_radioList",[],o.CONF),o.defineProperty(this,q,r+n()),this._renderOptions={},l.prototype.init.apply(this,arguments)}function d(a){this._renderOptions=a}function e(a){var b,c=this._radioList;return c.length?(c.forEach(function(c){c.checked=c.value==a,c.checked&&(b=a)}),i.call(this),b):void 0}function f(){var a=o.find(this._radioList,function(a){return a.checked});return a&&a.value||void 0}function g(){var a=this._radioList;return a.length&&a.forEach(function(a){a.checked=!1}),void i.call(this)}function h(a,b){"radio"==b.target.type&&i.call(this)}function i(){this.data.dispatchSourceMessage(p)}function j(){this.template.render({radioOptions:this.model.get(),elementName:this[q],_renderOptions:this._renderOptions});var a=this.el.querySelectorAll('input[type="radio"]'),b=o.toArray(a);this._radioList.length=0,this._radioList.splice.apply(this._radioList,[0,0].concat(b))}function k(){delete this._radioList,l.prototype.destroy.apply(this,arguments)}var l=a("../c_class"),m=a("../c_registry"),n=a("../../util/count"),o=a("milo-core").proto,p="mlradiogroupchange",q="_mlRadioGroupElementID",r="ml-radio-group-",s=l.createComponentClass("MLRadioGroup",{data:{set:e,get:f,del:g,splice:void 0,event:p},model:{messages:{"***":{subscriber:j,context:"owner"}}},events:{messages:{click:{subscriber:h,context:"owner"}}},container:void 0,dom:{cls:"ml-ui-radio-group"},template:{template:'{{~ it.radioOptions :option }}                         {{##def.elID:{{= it.elementName }}-{{= option.value }}#}}                         <span class="{{= it._renderOptions.optionCssClass || "'+r+'option" }}">                             <input id="{{# def.elID }}" type="radio" value="{{= option.value }}" name="{{= it.elementName }}">                             <label for="{{# def.elID }}">{{= option.label }}</label>                         </span>                    {{~}}'}});m.add(s),b.exports=s,o.extendProto(s,{init:c,destroy:k,setRenderOptions:d})},{"../../util/count":77,"../c_class":15,"../c_registry":32,"milo-core":105}],55:[function(a,b){"use strict";function c(a){var b={context:this,subscriber:e};this.model.off("**",b),this.model.set(a),this.model.on("**",b),e.call(this)}function d(a){this.el.disabled=a}function e(){this.template.render({selectOptions:this.model.get()})}var f=a("../c_class"),g=a("../c_registry"),h=a("milo-core").proto,i=f.createComponentClass("MLSelect",{dom:{cls:"ml-ui-select"},data:void 0,events:void 0,model:{messages:{"**":{subscriber:e,context:"owner"}}},template:{template:'{{~ it.selectOptions :option }}                         <option value="{{= option.value }}" {{? option.selected }}selected{{?}}>{{= option.label }}</option>                    {{~}}'}});g.add(i),b.exports=i,h.extendProto(i,{setOptions:c,disable:d})},{"../c_class":15,"../c_registry":32,"milo-core":105}],56:[function(a,b){"use strict";function c(){K.prototype.init.apply(this,arguments),this.once("childrenbound",d),N.defineProperties(this,{_optionsData:[],_filteredOptionsData:[]},N.WRIT)}function d(){this.template.render().binder(),e.call(this)}function e(){var a=this.container.scope;N.defineProperties(this,{_comboInput:a.input,_comboList:a.list,_comboOptions:a.options,_comboBefore:a.before,_comboAfter:a.after,_comboAddItemDiv:a.addItemDiv,_comboAddPrompt:a.addPrompt,_comboAddBtn:a.addBtn,_optionTemplate:O.compile(S)}),N.defineProperties(this,{_startIndex:0,_endIndex:T,_hidden:!1,_elementHeight:V,_total:0,_optionsHeight:200,_lastScrollPos:0,_currentValue:null,_selected:null,_isAddButtonShown:!1},N.WRIT),this.dom.setStyles({position:"relative"}),p(this._comboList,this._comboOptions,this),q(this._comboInput,this),r(this._comboAddBtn,this),this.events.on("keydown",{subscriber:y,context:this})}function f(a){this._hidden=!a,this._comboList.dom.toggle(a)}function g(){this._hidden=!1,this.el.classList.add(Q),this._comboList.dom.toggle(!0)}function h(){this._hidden=!0,this.el.classList.remove(Q),this._comboList.dom.toggle(!1)}function i(a,b){this._comboAddItemDiv.dom.toggle(a),b&&b.preserveState&&(this.__showAddOnClick=this._isAddButtonShown),this._isAddButtonShown=a}function j(a){this._addItemPrompt=a,this._comboAddPrompt.el.innerHTML=a,this.toggleAddButton(!1)}function k(a){this._optionsData=a,this.setFilteredOptions(a)}function l(a){this._optionsURL=a.url,this._formatOptionsURL=a.formatOptions||function(a){return a}}function m(a){var b=this._optionsURL,c=this._comboInput.data.get();a=a||N.noop,milo.util.request.post(b,{name:c},function(b,d){if(b)return P.error('Can not search for "'+c+'"'),a(new Error("Request error"));var e=N.jsonParse(d);e?a(null,e):a(new Error("Data error"))})}function n(a){return a?(this._filteredOptionsData=a,this._total=a.length,void this.update()):P.error("setFilteredOptions: parameter is undefined")}function o(){var a=this._hidden,b=this._filteredOptionsData.slice(this._startIndex,this._endIndex);this._comboOptions.template.render({comboOptions:b}),this._elementHeight=this._elementHeight||V,a&&this.hideOptions();var c=this._startIndex*this._elementHeight,d=(this._total-this._endIndex)*this._elementHeight;this._comboBefore.el.style.height=c+"px",this._comboAfter.el.style.height=d>0?d+"px":"0px"}function p(a,b,c){c.toggleAddButton(!1),b.template.set(S),a.dom.setStyles({overflow:"scroll",height:c._optionsHeight+"px",width:"100%",position:"absolute",zIndex:10}),c.hideOptions(),a.events.onMessages({click:{subscriber:G,context:c},scroll:{subscriber:H,context:c}})}function q(a,b){a.events.once("focus",function(){a.data.on("",{subscriber:v,context:b}),a.events.on("click",{subscriber:D,context:b}),a.events.on("keydown",{subscriber:E,context:b})})}function r(a,b){a.events.on("click",{subscriber:F,context:b})}function s(){return this._currentValue}function t(a){this._currentValue=a,this._comboInput.data.set(a&&a.label),N.deferMethod(this,"hideOptions")}function u(){this._currentValue=null,this._comboInput.data.set("")}function v(a,b){var c=b.newValue&&b.newValue.trim();if(this._optionsURL){var d=this;m.call(this,function(a,b){if(!a&&b)try{var e=b.data.map(d._formatOptionsURL);d.setOptions(e),x.call(d,c,d._optionsData)}catch(f){P.error("Data error",f)}})}else{var e=w.call(this,c);x.call(this,c,e)}}function w(a){return this._optionsData.filter(function(b){if(delete b.selected,b.label){var c=b.label.toLowerCase();return 0==c.trim().toLowerCase().indexOf(a.toLowerCase())}})}function x(a,b){function c(b){return b.label.toLowerCase()===a.toLowerCase()}a?(b.length&&N.find(b,c)?this.toggleAddButton(!1,{preserveState:!0}):this._addItemPrompt&&this.toggleAddButton(this._optionsData.length>1||this._optionsURL),b.length?(this.showOptions(),b[0].selected=!0,this._selected=b[0]):this.hideOptions()):this.toggleAddButton(!1,{preserveState:!0}),this.setFilteredOptions(b),this._comboList.el.scrollTop=0}function y(a,b){var c=X[b.keyCode];c&&z.call(this,c)}function z(a){var b=this.el.querySelectorAll(".selected")[0],c=this._comboList.el.scrollTop,d=b?b.offsetTop:0,e=d-c;if(b){var f=I.call(this,b),g=this._filteredOptionsData[f],h=this._filteredOptionsData[f+a];h&&(delete g.selected,h.selected=!0,this._selected=h,this.update())}else this._filteredOptionsData[0]&&(this._filteredOptionsData[0].selected=!0,this.update());e>this._optionsHeight-2*this._elementHeight&&1===a&&(this._comboList.el.scrollTop+=this._elementHeight*a*5),e<this._elementHeight&&-1===a&&(this._comboList.el.scrollTop+=this._elementHeight*a*5)}function A(){this._mouseIsOver=!0}function B(){var a=this;this._mouseIsOver=!1,this._mouseOutTimer&&clearInterval(this._mouseOutTimer),this._mouseOutTimer=setTimeout(function(){a._mouseIsOver||C.call(a)},750)}function C(){this.hideOptions(),this.toggleAddButton(!1,{preserveState:!0})}function D(){this.showOptions(),this.__showAddOnClick&&this.toggleAddButton(!0)}function E(a,b){13==b.keyCode&&this._selected&&J.call(this)}function F(){var a={label:this._comboInput.el.value};this.postMessage("additem",a),this.events.postMessage("milo_supercomboadditem",a),this.toggleAddButton(!1,{preserveState:!0})}function G(a,b){var c=I.call(this,b.target),d=this._filteredOptionsData[c];this._selected=d,J.call(this),this.update()}function H(a,b){var c=b.target.scrollTop,d=c>this._lastScrollPos?"down":"up",e=this._comboOptions.el.lastElementChild,f=this._comboOptions.el.firstElementChild,g=e?e.offsetTop:0,h=f?f.offsetTop:0,i=g-c-this._optionsHeight+this._elementHeight,j=c-h,k=Math.floor(j/this._elementHeight),l=Math.floor(i/this._elementHeight),m=Math.floor(c/this._elementHeight)-U;("down"==d&&U>l||"up"==d&&U>k)&&(this._startIndex=m>0?m:0,this._endIndex=m+T,this._elementHeight=e.style.height,this.update()),this._lastScrollPos=c}function I(a){return Number(a.getAttribute("data-value"))+this._startIndex}function J(){delete this._selected.selected,this.hideOptions(),this.toggleAddButton(!1),this._comboInput.data.off("",{subscriber:v,context:this}),this.data.set(this._selected),this.data.dispatchSourceMessage(R),this._comboInput.data.on("",{subscriber:v,context:this}),this._selected=null,this.setFilteredOptions(this._optionsData)}var K=a("../c_class"),L=a("../c_registry"),M=a("milo-core"),N=M.proto,O=M.util.doT,P=M.util.logger,Q="ml-ui-supercombo-open",R="mlsupercombochange",S='{{~ it.comboOptions :option:index }}                            <div {{? option.selected}}class="selected" {{?}}data-value="{{= index }}">{{= option.label }}</div>                        {{~}}',T=100,U=25,V=20,W=K.createComponentClass("MLSuperCombo",{events:{messages:{mouseleave:{subscriber:B,context:"owner"},mouseover:{subscriber:A,context:"owner"}}},data:{get:s,set:t,del:u,splice:void 0,event:R},dom:{cls:"ml-ui-supercombo"},template:{template:'<input ml-bind="[data, events]:input" class="form-control ml-ui-input">                   <div ml-bind="[dom]:addItemDiv" class="ml-ui-supercombo-add">                        <span ml-bind=":addPrompt"></span>                        <button ml-bind="[events, dom]:addBtn" class="btn btn-default ml-ui-button">Add</button>                   </div>                   <div ml-bind="[dom, events]:list" class="ml-ui-supercombo-dropdown">                       <div ml-bind="[dom]:before"></div>                       <div ml-bind="[template, dom, events]:options" class="ml-ui-supercombo-options"></div>                       <div ml-bind="[dom]:after"></div>                   </div>'},container:void 0});L.add(W),b.exports=W,N.extendProto(W,{init:c,showOptions:g,hideOptions:h,toggleOptions:f,setOptions:k,initOptionsURL:l,setFilteredOptions:n,update:o,toggleAddButton:i,setAddItemPrompt:j,clearComboInput:u});var X={40:1,38:-1}},{"../c_class":15,"../c_registry":32,"milo-core":105}],57:[function(a,b){"use strict";var c=a("../c_class"),d=a("../c_registry"),e=c.createComponentClass("MLText",{data:void 0,events:void 0,dom:{cls:"ml-ui-text"}});d.add(e),b.exports=e},{"../c_class":15,"../c_registry":32}],58:[function(a,b){"use strict";function c(a){return this._autoresize?m.warn("MLTextarea startAutoresize: autoresize is already on"):(this._autoresize=!0,this._autoresizeOptions=a,e.call(this),void d.call(this,"on"))}function d(a){this.events[a]("click",{subscriber:e,context:this}),this.data[a]("",{subscriber:e,context:this})}function e(){this.el.style.height=0;var a=this.el.scrollHeight,b=this._autoresizeOptions.minHeight,c=this._autoresizeOptions.maxHeight;a=a>=c?c:b>=a?b:a,this.el.style.height=a+"px"}function f(){return this._autoresize?(this._autoresize=!1,void d.call(this,"off")):m.warn("MLTextarea stopAutoresize: autoresize is not on")}function g(){return this._autoresize}function h(a){this.el.disabled=a}var i=a("../c_class"),j=a("../c_registry"),k=a("milo-core"),l=k.proto,m=k.util.logger,n=i.createComponentClass("MLTextarea",{data:void 0,events:void 0,dom:{cls:"ml-ui-textarea"}});j.add(n),b.exports=n;l.extendProto(n,{startAutoresize:c,stopAutoresize:f,isAutoresized:g,disable:h})},{"../c_class":15,"../c_registry":32,"milo-core":105}],59:[function(a,b){"use strict";function c(){var a=this.el.value,b=a.match(j);if(b){var c=b[1],d=b[2];if(!(c>23||d>59)){var e=new Date(1970,0,1,c,d);return h.toDate(e)}}}function d(a){function b(a){return 10>a?"0"+a:a}var c=h.toDate(a);if(!c)return void(this.el.value="");var d=k.replace("hh",b(c.getHours())).replace("mm",b(c.getMinutes()));return this.el.value=d,d}function e(){this.el.value=""}var f=a("../c_class"),g=a("../c_registry"),h=a("milo-core").proto,i=f.createComponentClass("MLTime",{events:void 0,data:{get:c,set:d,del:e},dom:{cls:"ml-ui-time"}});g.add(i),b.exports=i;var j=/^([0-9]{1,2})(?:\:|\.)([0-9]{1,2})$/,k="hh:mm"},{"../c_class":15,"../c_registry":32,"milo-core":105}],60:[function(a,b){"use strict";var c=a("../c_class"),d=a("../c_registry"),e=c.createComponentClass("MLWrapper",{container:void 0,data:void 0,events:void 0,dom:{cls:"ml-ui-wrapper"}});d.add(e),b.exports=e},{"../c_class":15,"../c_registry":32}],61:[function(a,b){"use strict";function c(a){m(a,{message:String,type:n.Optional(String),close:n.Optional(Boolean),timeout:n.Optional(Number)});var b=q.createOnElement();a=f(a);var c=p[a.type];b.dom.addCssClasses(c),b._alert={options:a,visible:!1},b.template.render(a).binder();var d=b.container.scope;if(a.close&&d.closeBtn.events.on("click",{subscriber:e,context:b}),a.timeout){setTimeout(function(){b._alert.visible&&b.closeAlert()},a.timeout)}return b}function d(a){var b=q.createAlert(a);return b.openAlert(),b}function e(){this.closeAlert()}function f(a){return a=o.clone(a),a.close="undefined"==typeof a.close||a.close===!0,a.timeout=Math.floor(a.timeout),a.type=a.type||"info",a}function g(){i.call(this,!0)}function h(){i.call(this,!1),this.destroy()}function i(a){a="undefined"==typeof a?!this._alert.visible:!!a;var b=a?"add":"remove",c=a?"appendChild":"removeChild";this._alert.visible=a,document.body[c](this.el),this.dom.toggle(a),this.el.setAttribute("aria-hidden",!a),this.el.classList[b]("in"),this.el[a?"focus":"blur"]()}var j=a("../../c_class"),k=a("../../c_registry"),l=(a("../../../util/component_name"),a("milo-core")),m=(l.util.logger,l.util.check),n=m.Match,o=l.proto,p={success:"alert-success",warning:"alert-warning",info:"alert-info",danger:"alert-danger",fixed:"alert-fixed"},q=j.createComponentClass("MLAlert",{container:void 0,events:void 0,dom:{cls:["ml-bs-alert","alert","fade"],attributes:{role:"alert","aria-hidden":"true"}},template:{template:'            {{? it.close }}                <button ml-bind="[events]:closeBtn" type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>            {{?}}            {{= it.message}}'}});k.add(q),b.exports=q,o.extend(q,{createAlert:c,openAlert:d}),o.extendProto(q,{openAlert:g,closeAlert:h})},{"../../../util/component_name":76,"../../c_class":15,"../../c_registry":32,"milo-core":105}],62:[function(a,b){"use strict";function c(a,b){v(a,{title:w.Optional(String),html:w.Optional(String),text:w.Optional(String),close:w.Optional(w.OneOf(Boolean,{backdrop:w.Optional(Boolean),keyboard:w.Optional(Boolean),button:w.Optional(Boolean)})),buttons:w.Optional([{name:w.Optional(String),type:String,label:String,close:w.Optional(Boolean),result:w.Optional(String),data:w.Optional(w.Any),cls:w.Optional(String)}])});var c=A.createOnElement();a=i(a),c._dialog={options:a,visible:!1},c.template.render(a).binder();var e=c.container.scope;return a.close.backdrop&&c.events.on("click",{subscriber:f,context:c}),a.title&&a.close.button&&e.closeBtn.events.on("click",{subscriber:g,context:c}),a.buttons.forEach(function(a){var b={subscriber:x.partial(d,a),context:c};e[a.name].events.on("click",b)}),b&&b(c),c}function d(a){a.close!==!1&&k.call(this,!1);var b=x.result(a.data,this,a);e.call(this,a.result,b)}function e(a,b){var c=this._dialog.subscriber;"function"==typeof c?c.call(this,a,b):c.subscriber.call(c.context,a,b)}function f(a,b){b.target==this.el&&this.closeDialog("dismissed")}function g(){this.closeDialog("closed")}function h(a){D&&D._dialog.options.close.keyboard&&27==a.keyCode&&D.closeDialog("dismissed")}function i(a){return a=x.clone(a),a.buttons=x.clone(a.buttons||y),a.buttons.forEach(function(a){a.name=a.name||s()}),a.close="undefined"==typeof a.close||a.close===!0?x.object(z,!0):"object"==typeof a.close?x.mapToObject(z,function(b){return a.close[b]!==!1}):x.object(z,!1),a}function j(a,b,c){var d=A.createDialog(a,c);return d.openDialog(b),d}function k(a){a="undefined"==typeof a?!this._dialog.visible:!!a;var b=a?"add":"remove",c=a?"appendChild":"removeChild";this._dialog.visible=a,a&&!B&&l(),document.body[c](this.el),C&&document.body[c](C),this.dom.toggle(a),this.el.setAttribute("aria-hidden",!a),document.body.classList[b]("modal-open"),this.el.classList[b]("in"),D=a?this:void 0,this.el[a?"focus":"blur"]()}function l(){C=document.createElement("div"),C.className="modal-backdrop fade in",document.addEventListener("keydown",h),B=!0}function m(a){return v(a,w.OneOf(Function,{subscriber:Function,context:w.Any})),D?u.warn("MLDialog openDialog: can't open dialog, another dialog is already open"):(this._dialog.subscriber=a,void k.call(this,!0))}function n(a,b){return D?(a=a||"closed",k.call(this,!1),void e.call(this,a,b)):u.warn("MLDialog closeDialog: can't close dialog, no dialog open")}function o(){return D}function p(){document.removeEventListener("keydown",h),q.prototype.destroy.apply(this,arguments)}var q=a("../../c_class"),r=a("../../c_registry"),s=a("../../../util/component_name"),t=a("milo-core"),u=t.util.logger,v=t.util.check,w=v.Match,x=t.proto,y=[{type:"default",label:"OK",result:"OK"}],z=["backdrop","keyboard","button"],A=q.createComponentClass("MLDialog",{container:void 0,events:void 0,dom:{cls:["ml-bs-dialog","modal","fade"],attributes:{role:"dialog","aria-hidden":"true"}},template:{template:'            <div class="modal-dialog">                <div class="modal-content">                    {{? it.title }}                        <div class="modal-header">                            {{? it.close.button }}                                <button ml-bind="[events]:closeBtn" type="button" class="close">&times;</button>                            {{?}}                            <h4 class="modal-title">{{= it.title }}</h4>                        </div>                    {{?}}                    {{? it.html || it.text }}                        <div class="modal-body" ml-bind="[container]:dialogBody">                            {{? it.html }}                                {{= it.html }}                            {{??}}                                <p>{{= it.text }}</p>                            {{?}}                        </div>                    {{?}}                    {{? it.buttons && it.buttons.length }}                        <div class="modal-footer">                            {{~ it.buttons :btn }}                                <button type="button"                                    class="btn btn-{{= btn.type }}{{? btn.cls }} {{= btn.cls }}{{?}}"                                    ml-bind="[events]:{{= btn.name }}">{{= btn.label }}</button>                            {{~}}                        </div>                    {{?}}                </div>            </div>'}});r.add(A),b.exports=A,x.extend(A,{createDialog:c,openDialog:j,getOpenedDialog:o}),x.extendProto(A,{openDialog:m,closeDialog:n,destroy:p});var B,C,D},{"../../../util/component_name":76,"../../c_class":15,"../../c_registry":32,"milo-core":105}],63:[function(a,b){"use strict";function c(){function a(a){var c=a.target,e=a.relatedTarget,f=i._dropdown.listeners;d(c)&&f.remove(c.contentWindow.document,"click",b),d(e)&&f.add(e.contentWindow.document,"click",b)}function b(a){i.el.contains(a.target)||i.hideMenu()}var c=this.el.querySelector("."+o),e=this.el.querySelector("."+p);if(!c||!e)return m.error("MLDropdown:",o,"or",p,"isn't found");var f=window.document,g=this.toggleMenu.bind(this,void 0),h=new n;this._dropdown={menu:e,visible:!1,listeners:h},this.hideMenu();var i=this;h.add(c,"click",g),h.add(f,"mouseout",a),h.add(f,"click",b)}function d(a){return a&&"IFRAME"==a.tagName}function e(){this._dropdown.listeners.removeAll(),delete this._dropdown,i.prototype.destroy.apply(this,arguments)}function f(){this.toggleMenu(!0)}function g(){this.toggleMenu(!1)}function h(a){a="undefined"==typeof a?!this._dropdown.visible:!!a,this._dropdown.visible=a;var b=this._dropdown.menu;b.style.display=a?"block":"none"}var i=a("../../c_class"),j=a("../../c_registry"),k=a("milo-core"),l=k.proto,m=k.util.logger,n=a("../../../util/dom_listeners"),o="dropdown-toggle",p="dropdown-menu",q=i.createComponentClass("MLDropdown",{events:void 0,dom:{cls:["ml-bs-dropdown","dropdown"]}});j.add(q),b.exports=q,l.extendProto(q,{start:c,destroy:e,toggleMenu:h,showMenu:f,hideMenu:g})},{"../../../util/dom_listeners":80,"../../c_class":15,"../../c_registry":32,"milo-core":105}],64:[function(a,b){"use strict";var c=a("milo-core"),d=(c.proto,c.util.doT),e=b.exports=c.config;e({attrs:{bind:"ml-bind",load:"ml-load"},componentRef:"___milo_component",componentPrefix:"milo_",template:{compile:d.compile},domStorage:{typeSuffix:":___milo_data_type",prefixSeparator:"/",root:"",messageKey:"___milo_message/",messageTimestamp:"___milo_timestamp",quotaExceeded:{throwError:!0,message:!1}},dragDrop:{dataTypes:{component:"x-application/milo/component",componentMetaTemplate:"x-application/milo/component-meta/%class/%name/%params",componentMetaRegex:/^x\-application\/milo\/component\-meta\/([a-z0-9]+)\/([a-z0-9]+)\/([a-z0-9]*)$/}},request:{jsonpTimeout:6e4,jsonpCallbackPrefix:"___milo_callback_",optionsKey:"___milo_options",defaults:{timeout:6e4}},websocket:{rpc:{timeout:15e3,responsePrefix:"response_"}}})},{"milo-core":105}],65:[function(a,b){"use strict";function c(a,b,c){milo(function(){d(a,b,c)})}function d(a,b,c){"function"==typeof a&&(c=a,a=void 0,b=!1),"function"==typeof b&&(c=b,b=!1),a=a||document.body,g.postMessage("loader",{state:"started"}),e(a,b,function(a){g.postMessage("loader",{state:"finished",views:a}),c(a)})}function e(a,b,c){var d=a.getAttribute(l.attrs.load)?[a]:a.querySelectorAll("["+l.attrs.load+"]"),e={},g=d.length,h=0;j.forEach(d,function(a){f(a,b,function(b){e[a.id]=b||a,h++,h==g&&c(e)})})}function f(a,b,c){if(k.children(a).length)throw new Error("can't load html into element that is not empty");var d=new m(a);d.parse().validate(),h.get(d.loadUrl,function(e,f){return e?(e.message=e.message||"can't load file "+d.loadUrl,void c(e)):(a.innerHTML=f,b&&m.remove(a),void c(null))})}var g=a("./services/mail"),h=a("./util/request"),i=a("milo-core"),j=(i.util.logger,i.proto),k=a("./util/dom"),l=a("./config"),m=a("./attributes/a_load");b.exports=c},{"./attributes/a_load":6,"./config":64,"./services/mail":70,"./util/dom":79,"./util/request":87,"milo-core":105}],66:[function(a,b){"use strict";function c(a){c.util.domReady(a)}function d(){e.destroy(),c.mail.destroy(),c.window.destroy(),c.util.destroy()}var e=a("milo-core"),f=e.proto;a("./use_facets"),a("./use_components"),f.extend(c,{Messenger:e.Messenger,Model:e.Model,minder:e.minder,loader:a("./loader"),binder:a("./binder"),mail:a("./services/mail"),window:a("./services/window"),config:a("./config"),util:a("./util"),classes:a("./classes"),attributes:a("./attributes"),ComponentFacet:a("./components/c_facet"),Component:a("./components/c_class"),Command:a("./command"),registry:a("./registry"),milo_version:"0.1.10",createComponentClass:a("./util/create_component_class"),destroy:d}),"object"==typeof b&&b.exports&&(b.exports=c),"object"==typeof window&&(window.milo=c,c.mail.trigger("miloready"))},{"./attributes":7,"./binder":8,"./classes":9,"./command":12,"./components/c_class":15,"./components/c_facet":16,"./config":64,"./loader":65,"./registry":67,"./services/mail":70,"./services/window":73,"./use_components":74,"./use_facets":75,"./util":85,"./util/create_component_class":78,"milo-core":105}],67:[function(a,b){"use strict";
b.exports={facets:a("./components/c_facets/cf_registry"),components:a("./components/c_registry"),commands:a("./command/cmd_registry")}},{"./command/cmd_registry":11,"./components/c_facets/cf_registry":30,"./components/c_registry":32}],68:[function(a,b){"use strict";var c=a("milo-core").proto,d={ClipboardEvent:["copy","cut","paste","beforecopy","beforecut","beforepaste"],Event:["input","readystatechange"],FocusEvent:["focus","blur","focusin","focusout"],KeyboardEvent:["keydown","keypress","keyup"],MouseEvent:["click","contextmenu","dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","mouseout","mouseover","show"],TouchEvent:["touchstart","touchend","touchmove","touchenter","touchleave","touchcancel"]};if("undefined"!=typeof window)var e=window;else e={},c.eachKey(d,function(a,b){var d=c.makeFunction(b,"type","properties","this.type = type; _.extend(this, properties);");e[b]=d});var f={};c.eachKey(d,function(a,b){a.forEach(function(a){if(Object.hasOwnProperty(f,a))throw new Error("duplicate event type "+a);f[a]=e[b]})}),b.exports=f},{"milo-core":105}],69:[function(a,b){"use strict";function c(a,b,c,d){this.eventEmitter=d,k.prototype.init.apply(this,arguments)}function d(){k.prototype.destroy.apply(this,arguments),delete this.eventEmitter}function e(){return this.eventEmitter}function f(a,b){if(b&&"string"==typeof b){var c=q.test(b);b=b.replace(q,""),this.emitter()[a](b,this,c)}}function g(a){var b;"undefined"!=typeof window&&(b=a.eventPhase==window.Event.CAPTURING_PHASE),b&&(a+=r),this.dispatchMessage(a.type,a)}function h(a,b){this.messenger.postMessageSync(a,b)}function i(a,b){n(a,String),n(b,o.Optional(Object)),a=a.replace(q,"");var c=l[a];if("function"!=typeof c)throw new Error("unsupported event type");"undefined"!=typeof b&&(b.type=a);var d=new c(a,b),e=this.emitter().dispatchEvent(d);return e}var j=a("milo-core"),k=j.classes.MessageSource,l=(a("../components/c_class"),a("./de_constrs")),m=j.proto,n=j.util.check,o=n.Match,p=m.createSubclass(k,"DOMEmitterSource",!0);m.extendProto(p,{init:c,destroy:d,addSourceSubscriber:m.partial(f,"addEventListener"),removeSourceSubscriber:m.partial(f,"removeEventListener"),postMessage:h,trigger:i,emitter:e,handleEvent:g}),b.exports=p;var q=/__capture$/,r="__capture"},{"../components/c_class":15,"./de_constrs":68,"milo-core":105}],70:[function(a,b){"use strict";var c=a("milo-core"),d=c.Messenger,e=a("./mail_api"),f=a("./mail_source"),g=(c.proto,new d),h=new f(g,{trigger:"trigger"},new e);g._setMessageSource(h),b.exports=g},{"./mail_api":71,"./mail_source":72,"milo-core":105}],71:[function(a,b){"use strict";function c(a){return"domready"==a?"readystatechange":j.test(a)?"message":void 0}function d(a,b,c){return"readystatechange"==a?!0:"message"==a?k+c.data.type==b:void 0}var e=a("milo-core"),f=e.classes.MessengerAPI,g=e.proto,h=e.util.check,i=(h.Match,g.createSubclass(f,"MailMsgAPI",!0));g.extendProto(i,{translateToSourceMessage:c,filterSourceMessage:d}),b.exports=i;var j=/^message\:/,k="message:"},{"milo-core":105}],72:[function(a,b){"use strict";function c(a){if(e(a))if("loading"==document.readyState)document.addEventListener("readystatechange",this,!1);else{var b=l.readystatechange,c=new b("readystatechange",{target:document});this.dispatchMessage("readystatechange",c)}else this._windowSubscriberMethod("addEventListener",a)}function d(a){e(a)?document.removeEventListener("readystatechange",this,!1):this._windowSubscriberMethod("removeEventListener",a)}function e(a){return"readystatechange"==a&&"object"==typeof document}function f(a){return"message"==a&&"object"==typeof window}function g(a,b){f(b)&&window[a]("message",this,!1)}function h(a){this.dispatchMessage(a.type,a)}function i(a,b){b=b||{},b.type="message:"+a,"object"==typeof window&&window.postMessage(b,"*")}var j=a("milo-core"),k=j.classes.MessageSource,l=a("../de_constrs"),m=j.proto,n=j.util.check,o=(n.Match,m.createSubclass(k,"MailMessageSource",!0));m.extendProto(o,{addSourceSubscriber:c,removeSourceSubscriber:d,trigger:i,_windowSubscriberMethod:g,handleEvent:h}),b.exports=o},{"../de_constrs":68,"milo-core":105}],73:[function(a,b){"use strict";function c(){return window.top==window.self||window.__karma__}var d=a("milo-core"),e=d.Messenger,f=a("./dom_source"),g=d.proto,h=new e,i=new f(h,{trigger:"trigger"},void 0,window);h._setMessageSource(i),b.exports=h,g.extend(h,{isTop:c})},{"./dom_source":69,"milo-core":105}],74:[function(a){"use strict";a("./components/classes/View"),a("./components/ui/Group"),a("./components/ui/Wrapper"),a("./components/ui/Text"),a("./components/ui/Select"),a("./components/ui/Input"),a("./components/ui/InputList"),a("./components/ui/Textarea"),a("./components/ui/RadioGroup"),a("./components/ui/Button"),a("./components/ui/Hyperlink"),a("./components/ui/List"),a("./components/ui/ListItem"),a("./components/ui/Time"),a("./components/ui/Date"),a("./components/ui/Combo"),a("./components/ui/SuperCombo"),a("./components/ui/ComboList"),a("./components/ui/Image"),a("./components/ui/DropTarget"),a("./components/ui/FoldTree"),a("./components/ui/bootstrap/Dropdown")},{"./components/classes/View":34,"./components/ui/Button":41,"./components/ui/Combo":42,"./components/ui/ComboList":43,"./components/ui/Date":44,"./components/ui/DropTarget":45,"./components/ui/FoldTree":46,"./components/ui/Group":47,"./components/ui/Hyperlink":48,"./components/ui/Image":49,"./components/ui/Input":50,"./components/ui/InputList":51,"./components/ui/List":52,"./components/ui/ListItem":53,"./components/ui/RadioGroup":54,"./components/ui/Select":55,"./components/ui/SuperCombo":56,"./components/ui/Text":57,"./components/ui/Textarea":58,"./components/ui/Time":59,"./components/ui/Wrapper":60,"./components/ui/bootstrap/Dropdown":63}],75:[function(a){"use strict";a("./components/c_facets/Dom"),a("./components/c_facets/Data"),a("./components/c_facets/Frame"),a("./components/c_facets/Events"),a("./components/c_facets/Options"),a("./components/c_facets/Template"),a("./components/c_facets/Container"),a("./components/c_facets/ModelFacet"),a("./components/c_facets/Drag"),a("./components/c_facets/Drop"),a("./components/c_facets/List"),a("./components/c_facets/Item"),a("./components/c_facets/Transfer")},{"./components/c_facets/Container":17,"./components/c_facets/Data":18,"./components/c_facets/Dom":19,"./components/c_facets/Drag":20,"./components/c_facets/Drop":21,"./components/c_facets/Events":22,"./components/c_facets/Frame":23,"./components/c_facets/Item":24,"./components/c_facets/List":25,"./components/c_facets/ModelFacet":26,"./components/c_facets/Options":27,"./components/c_facets/Template":28,"./components/c_facets/Transfer":29}],76:[function(a,b){"use strict";function c(){return f+d()}var d=a("./count"),e=a("../config"),f=e.componentPrefix;b.exports=c},{"../config":64,"./count":77}],77:[function(a,b){"use strict";function c(){var a=Date.now();return f=""+a,d==a?(e=""===e?0:e+1,f+="_"+e):(d=a,e=""),f}var d=Date.now(),e="",f=""+d;c.get=function(){return f},b.exports=c},{}],78:[function(a,b){"use strict";function c(a){var b=milo.registry.components,c=b.get(a.superClassName||"Component"),e=c.createComponentClass(a.className,a.facets);if(a.methods&&d.extendProto(e,a.methods),a.staticMethods){if(void 0!==a.staticMethods["super"])throw"'super' is a reserved keyword";d.extend(e,a.staticMethods)}return e["super"]=c.prototype,b.add(e),e}var d=a("milo-core").proto;b.exports=c},{"milo-core":105}],79:[function(a,b){"use strict";function c(a){return d(a.childNodes,Node.ELEMENT_NODE)}function d(a,b){return N.filter(a,function(a){return a.nodeType==b})}function e(a){for(;a;){if(a.nodeType==Node.ELEMENT_NODE)return a;a=a.parentNode}return null}function f(a){var b=a.ownerDocument;if(!b)return O.error("selectElementContents: element has no document");var c=b.createRange();c.selectNodeContents(a);var d=F(a),e=d.getSelection();e.removeAllRanges(),e.addRange(c)}function g(a){var b=p(a),c=q(a);b&&c&&k(b,0,c,c.textContent.length)}function h(a,b){var c=a.ownerDocument;if(!c)return O.error("setCaretPosition: element has no document");var d=c.createRange();d.setStart(a,b);var e=F(a),f=e.getSelection();f.removeAllRanges(),f.addRange(d)}function i(a){return j(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)}function j(a,b,c,d){var e=a.compareDocumentPosition(c);return e&Node.DOCUMENT_POSITION_FOLLOWING?1:e&Node.DOCUMENT_POSITION_PRECEDING?-1:a==c?d>b?1:b>d?-1:0:void 0}function k(a,b,c,d){var e=a.ownerDocument;if(!e)return O("setCaretPosition: element has no document");var f,g,h=-1==j(a,b,c,d),i=e.createRange(),k=F(a),l=k.getSelection();h?(i.setStart(c,d),i.setEnd(a,b),i.collapse(!1)):(i.setStart(a,b),i.setEnd(c,d)),f=i.commonAncestorContainer==Node.ELEMENT_NODE?i.commonAncestorContainer:i.commonAncestorContainer.parentElement,f.isContentEditable||(g=f.contentEditable,f.contentEditable="true"),l.removeAllRanges(),l.addRange(i),h&&l.extend(c,d),g&&(f.contentEditable=g)}function l(a){a=a||window;var b=a.getSelection();b.removeAllRanges()}function m(a,b){var c,d;for(c=a.offsetTop,d=a.offsetLeft,a=a.offsetParent;a;)c+=a.offsetTop+n(a,"Height",b),d+=a.offsetLeft+n(a,"Width",b),a=a.offsetParent;return{topOffset:c,leftOffset:d}}function n(a,b,c){if(c){var d="Height"==b?"top":"left",e=window.getComputedStyle(a),f=parseInt(e.getPropertyValue("border-"+d+"-width"),10);if(f)return f}return 0}function o(a){var b=a.parentNode;b&&(b.removeChild(a),b.normalize())}function p(a){if(a.nodeType==Node.TEXT_NODE)return a;var b=E(a,NodeFilter.SHOW_TEXT);return b.firstChild()}function q(a){if(a.nodeType==Node.TEXT_NODE)return a;var b=E(a,NodeFilter.SHOW_TEXT);return b.lastChild()}function r(a){var b=a.parentNode;if(b){var c=document.createDocumentFragment(),d=N.slice(a.childNodes);d.forEach(c.appendChild,c),b.replaceChild(c,a),b.normalize()}}function s(a,b){var c=b.parentNode;c&&(c.insertBefore(a,b),a.appendChild(b))}function t(a){return v(a,"trimRight")}function u(a){return v(a,"trimLeft")}function v(a,b){var c=a.length;return a.textContent=a.textContent[b](),c!==a.length}function w(a){delete a[L.componentRef]}function x(a){var b=document.createElement("DIV");return b.innerHTML=a,b.textContent||""}function y(a,b,c,d){for(var e=document.createTreeWalker(a,b);e.nextNode();){var f=c.call(d||a,e.currentNode);if(f===!1)break}}function z(a,b){function c(a){return a.contains(b)}if(a&&a.contains(b)){for(var d=[],e=a;e!=b;){var f=N.findIndex(e.childNodes,c);d.push(f),e=e.childNodes[f]}return d}}function A(a,b,c){if(b){var d=b.length;if(0===d)return a;for(var e=a,f=0;d>f;f++){var g=e.childNodes;if(!g){c||(e=void 0);break}var h=b[f],i=g[h];if(!i){e=c?g[g.length-1]:void 0;break}e=i}return e}}function B(a,b,c,d){var e=c.nodeType==Node.TEXT_NODE;if(a.contains(c)&&o(c),0!=b.length){var f=A(a,b.slice(0,-1),d),g=f.childNodes;if(!g){if(!d)return;f=f.parentNode,g=f.childNodes}var h=b[b.length-1],i=g[h];return i?(f.insertBefore(c,i),e&&f.normalize(),!0):0!==g.length||0!==h&&!d?(i=g[h-1],i||d?(f.appendChild(c),e&&f.normalize(),!0):void 0):(f.appendChild(c),e&&f.normalize(),!0)}}function C(a,b){var c,d=0;if(!Array.isArray(a)&&Array.isArray(b))return O.error("isTreePathBefore: One or both paths are not valid treepath arrays.");for(d;d<a.length;d++){if(a[d]<b[d]){c=!0;break}if(a[d]>b[d]){c=!1;break}}return"undefined"==typeof c&&a.length<b.length&&O.warn("isTreePathBefore: One node is inside another"),c||!1}function D(a){return a.replace(/[\u00A0-\u99999<>\&]/gim,function(a){return"&#"+a.charCodeAt(0)+";"})}function E(a,b){return b=b||NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,document.createTreeWalker(a,b)}function F(a){var b=a.ownerDocument;return b&&(b.defaultView||b.parentWindow)}function G(a,b){function c(b){var c=document.createRange(),d=!1;return c.selectNode(b),-1!=c.compareBoundaryPoints(window.Range.START_TO_START,a)&&1!=c.compareBoundaryPoints(window.Range.END_TO_END,a)&&(d=!0),c.detach(),d}for(var d,e=a.commonAncestorContainer,f=e.ownerDocument,g=f.createTreeWalker(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);d=g.nextNode();)c(d)&&b(d)}function H(a){var b=F(a.startContainer),c=b.milo.Component,d=[];return G(a,function(a){if(a.nodeType!=Node.TEXT_NODE){var b=c.getComponent(a);b&&d.push(b)}}),d}function I(a){var b=H(a);b.forEach(function(a){a.destroy(!0)}),a.deleteContents()}function J(a,b){return 0==a.compareBoundaryPoints(window.Range.START_TO_START,b)&&0==a.compareBoundaryPoints(window.Range.END_TO_END,b)}function K(a,b){var c=document.createElement("div");c.setAttribute("style","width: 1px; height: 1px; position:fixed; left:"+a+"px; top:"+b+"px; background-color:red; z-index: 100"),setTimeout(function(){document.body.appendChild(c)},200)}var L=a("../config"),M=a("milo-core"),N=M.proto,O=M.util.logger,P={children:c,filterNodeListByType:d,containingElement:e,selectElementContents:f,selectElementText:g,getElementOffset:m,setCaretPosition:h,getSelectionDirection:i,setSelection:k,clearSelection:l,removeElement:o,unwrapElement:r,wrapInElement:s,detachComponent:w,firstTextNode:p,lastTextNode:q,trimNodeRight:t,trimNodeLeft:u,stripHtml:x,htmlEntities:D,walkTree:y,createTreeWalker:E,treePathOf:z,getNodeAtTreePath:A,insertAtTreePath:B,isTreePathBefore:C,getNodeWindow:F,getComponentsFromRange:H,deleteRangeWithComponents:I,forEachNodesInRange:G,areRangesEqual:J,addDebugPoint:K};b.exports=P},{"../config":64,"milo-core":105}],80:[function(a,b){"use strict";function c(){this.listeners=[]}function d(a,b,c){this.listeners.push({target:a,eventType:b,handler:c}),a.addEventListener(b,c)}function e(a,b,c){var d={target:a,eventType:b,handler:c},e=h.findIndex(this.listeners,h.partial(h.isEqual,d));e>-1&&(this.listeners.splice(e,1),g(d))}function f(){this.listeners.forEach(g),this.listeners=[]}function g(a){a.target.removeEventListener(a.eventType,a.handler)}var h=a("milo-core").proto;b.exports=c,h.extendProto(c,{add:d,remove:e,removeAll:f})},{"milo-core":105}],81:[function(a,b){"use strict";function c(a){function b(){a.apply(c,i)}var c=this,i=f.slice(arguments,1);e.call(this)?b():(h||(document.addEventListener("readystatechange",d),h=!0),g.push(b))}function d(){document.removeEventListener("readystatechange",d),g.forEach(function(a){a()})}function e(){var a=document.readyState;return"loading"==a?!1:a}var f=a("milo-core").proto;b.exports=c;var g=[],h=!1;f.extend(c,{isReady:e})},{"milo-core":105}],82:[function(a,b){"use strict";function c(a){this.event=a,this.dataTransfer=a.dataTransfer,this.types=a.dataTransfer.types}function d(){return A.dataTypes.component}function e(){return C.indexOf(this.types,c.componentDataType())>=0}function f(){var a=c.componentDataType(),b=this.dataTransfer.getData(a),d=C.jsonParse(b);return d}function g(a,b){if(!b){var d=a.getTransferState({requestedBy:"drag"});b=JSON.stringify(d)}var e=c.componentDataType();return b&&this.dataTransfer.setData(e,b),this.dataTransfer.setData("text/html",a.el.outerHTML),b}function h(a,b,c){var d=j(a),e=C.toQueryString(b),f=A.dataTypes.componentMetaTemplate.replace("%class",i(d.compClass||"")).replace("%name",i(d.compName||"")).replace("%params",i(e||""));return c&&"object"==typeof c&&(c=JSON.stringify(c)),this.dataTransfer.setData(f,c||""),f}function i(a){return D.encode(a).toLowerCase()}function j(a){return a.transfer?a.transfer.getComponentMeta():{compClass:a.constructor.name,compName:a.name}}function k(){var a,b=C.find(this.types,function(b){return a=b.match(B),!!a});if(b){for(var c=1;4>c;c++)a[c]=D.decode(a[c]);return{compClass:a[1],compName:a[2],params:C.fromQueryString(a[3]),metaDataType:b,metaData:C.jsonParse(this.dataTransfer.getData(b))?C.jsonParse(this.dataTransfer.getData(b)):this.dataTransfer.getData(b)}}}function l(){return this.dataTransfer.effectAllowed}function m(a){this.dataTransfer.effectAllowed=a}function n(){return this.dataTransfer.dropEffect}function o(a){this.dataTransfer.dropEffect=a}function p(a){var b=this.getAllowedEffects(),c="copy"==a,d="move"==a,e="link"==a,f=c||e||d;switch(b){case"copy":case"move":case"link":return b==a;case"copyLink":return c||e;case"copyMove":return c||d;case"linkMove":return e||d;case"all":case"uninitialized":return f;case"none":return!1}}function q(a){return this.dataTransfer.getData(a)}function r(a,b){this.dataTransfer.setData(a,b)}function s(a){this.dataTransfer.clearData(a)}function t(a,b){E=b.dragDrop,F=b.dragFacet}function u(a,b){F&&F.postMessageSync("dragdropcompleted",b),E=void 0,F=void 0}function v(a,b){E&&G.postMessageSync("dragdropcompleted",b)}function w(){return E}function x(){G.offAll()}var y=(a("../components/c_class"),a("milo-core")),z=y.Messenger,A=a("../config").dragDrop,B=A.dataTypes.componentMetaRegex,C=y.proto,D=a("base32");b.exports=c,C.extend(c,{componentDataType:d}),C.extendProto(c,{isComponent:e,getComponentState:f,setComponentState:g,getComponentMeta:k,setComponentMeta:h,getAllowedEffects:l,setAllowedEffects:m,getDropEffect:n,setDropEffect:o,isEffectAllowed:p,getData:q,setData:r,clearData:s});var E,F,G=new z;C.extend(c,{service:G,destroy:x}),G.onMessages({dragdropstarted:t,dragdropcompleted:u,completedragdrop:v}),C.extend(G,{getCurrentDragDrop:w})},{"../components/c_class":15,"../config":64,base32:95,"milo-core":105}],83:[function(a,b){"use strict";function c(a){var b=e.makeFunction(a,"message",'this.name = "'+a+'";             this.message = message || "There was an  error";');return e.makeSubclass(b,Error),b}function d(){throw new g.AbstractClass("calling the method of an absctract class")}var e=a("milo-core").proto,f=["AbstractClass","Mixin","Messenger","Component","Attribute","Binder","Loader","MailMessageSource","Facet","Scope","Model","DomFacet","EditableFacet","List","Connector","Registry","FrameMessageSource","Drop","Angular","StorageMessageSource"],g={toBeImplemented:d,createClass:c};f.forEach(function(a){g[a]=c(a+"Error")}),b.exports=g},{"milo-core":105}],84:[function(a,b){"use strict";function c(a,b,c){var d=f(a);if(!d)return void s.error("fragment.getState: range has no common container");var i=a.cloneContents(),j=e(i,c);g(d,j),b&&h(j);var k=j.getState();return t.deferMethod(j,"destroy"),k}function d(a,b,c){try{var d=f(a);if(!d)return void c(new Error("fragment.getState: range has no common container"));"function"==typeof b&&(c=b,b=!1);var i=a.cloneContents(),j=e(i);g(d,j),t.defer(function(){j.broadcast("stateready"),t.defer(function(){b&&h(j);var a=j.getState();j.destroy(),c(null,a)})})}catch(k){c(k)}}function e(a,b){var c=document.createElement("div"),d=new o(c);t.extend(d,{compClass:b||"Component",compFacets:b?[]:["container"],compName:"wrapper"}),d.decorate(),c.appendChild(a);var e=p(c);return e.wrapper}function f(a){var b=q.containingElement(a.commonAncestorContainer);return n.getContainingComponent(b,!0,"container")}function g(a,b){var c=a.container.scope;b.container.scope._each(function(a,b){var d=c[b];if(!d)return s.error("fragment.getState: conponent",b,"not found in range");var e=d._getState(!0);a.setState(e)})}function h(a){a.container.scope._each(function(a){a.rename()})}function i(a){var b=k(a);return a=j(b)}function j(a){var b=document.createRange();return a.siblings?(b.setStartBefore(a.start),b.setEndAfter(a.end)):b.selectNode(a.start),b}function k(a){var b=a.commonAncestorContainer,c=a.startContainer,d=a.endContainer;if(c==d)return c!=b&&s.error("deleteSelectionCommand logical error: start==end, but container is different"),{siblings:!1,start:c};if(c==b||d==b)return{siblings:!1,start:b};var e=l(b,c),f=l(b,d);return e&&f?e==f?(s.error("deleteSelectionCommand logical error: same siblings"),{siblings:!1,start:e}):{siblings:!0,start:e,end:f}:void 0}function l(a,b){return t.find(a.childNodes,function(a){return a.contains(b)})}function m(a){return function(b,c){var d={siblings:c.siblings,start:a(b,c.start)};return d.siblings&&(d.end=a(b,c.end)),d}}{var n=a("../components/c_class"),o=a("../attributes/a_bind"),p=a("../binder"),q=a("./dom"),r=a("milo-core"),s=r.util.logger,t=(r.util.check,r.proto),u=m(q.treePathOf),v=m(q.getNodeAtTreePath);b.exports={getState:c,getStateAsync:d,expandRangeToSiblings:i,getRangeSiblings:k,createRangeFromSiblings:j,createRangeFromNodes:j,createRangePaths:u,createRangeNodes:v}}},{"../attributes/a_bind":4,"../binder":8,"../components/c_class":15,"./dom":79,"milo-core":105}],85:[function(a,b){"use strict";function c(){e.request.destroy(),e.dragDrop.destroy()}var d=a("milo-core"),e={logger:d.util.logger,request:a("./request"),websocket:a("./websocket"),check:d.util.check,error:a("./error"),count:a("./count"),uniqueId:a("./count"),componentName:a("./component_name"),dom:a("./dom"),domListeners:a("./dom_listeners"),selection:a("./selection"),fragment:a("./fragment"),jsonParse:a("./json_parse"),storage:a("./storage"),domReady:a("./domready"),dragDrop:a("./dragdrop"),dialog:a("../components/ui/bootstrap/Dialog"),alert:a("../components/ui/bootstrap/Alert"),doT:d.util.doT,destroy:c};b.exports=e},{"../components/ui/bootstrap/Alert":61,"../components/ui/bootstrap/Dialog":62,"./component_name":76,"./count":77,"./dom":79,"./dom_listeners":80,"./domready":81,"./dragdrop":82,"./error":83,"./fragment":84,"./json_parse":86,"./request":87,"./selection":88,"./storage":89,"./websocket":92,"milo-core":105}],86:[function(a,b){"use strict";function c(a){try{return JSON.parse(a)}catch(b){}}b.exports=c},{}],87:[function(a,b){"use strict";function c(a){return function(){var b=Promise.prototype[a].apply(this,arguments);return f(b,this._request),b}}function d(a,b,c){function f(a){h(i,c,j,a.type)}b.url=a,b.contentType=b.contentType||"application/json;charset=UTF-8",z&&d.postMessageSync("request",{options:b});var i=new XMLHttpRequest;i.open(b.method,b.url,!0),i.setRequestHeader("Content-Type",b.contentType),g(i,b.headers),i.timeout=b.timeout||t.request.defaults.timeout,i.onreadystatechange=i.ontimeout=i.onabort=f;var j=e(i);return i.send(JSON.stringify(b.data)),i[t.request.optionsKey]=b,w.push(i),j.promise}function e(a){var b,c,d=new Promise(function(a,d){b=a,c=d});return f(d,a),d["catch"](r.noop),{promise:d,resolve:b,reject:c}}function f(a,b){return a._request=b,a.then=x,a["catch"]=y,a}function g(a,b){b&&r.eachKey(b,function(b,c){a.setRequestHeader(c,b)})}function h(a,b,c,e){function f(b){z&&d.postMessage(b,{status:status,response:a.responseText})}if(4==a.readyState&&(a.status||"readystatechange"!=e)){r.spliceItem(w,a);var g;try{if(a.status>=200&&a.status<400){try{f("success"),b&&b(null,a.responseText,a)}catch(h){g=h}c.resolve(a.responseText)}else{var i=a.status||e;try{f("error"),f("error"+i),b&&b(i,a.responseText,a)}catch(h){g=h}c.reject({reason:i,response:a.responseText})}}catch(h){g=g||h}if(a.onreadystatechange=a.ontimeout=a.onabort=void 0,w.length||f("requestscompleted"),g)throw new Error("Exception: "+g)}}function i(){z=new v(d,["on","once","onSync","off","onMessages","offMessages","postMessage","postMessageSync"])}function j(a,b){return d(a,{method:"GET"},b)}function k(a,b,c){return d(a,{method:"POST",data:b},c)}function l(a,b){var c=d(a,{method:"GET"}),e=c.then(JSON.parse);return b&&e.then(function(a){b(null,a)})["catch"](function(a){b(a.reason,a.response)}),e}function m(a,b){function c(a,c){r.spliceItem(w,window[k]);try{g(a?"error":"success",a,c),a&&(u.error("No JSONP response or timeout"),g("errorjsonptimeout",a)),b&&b(a,c)}catch(d){var e=d}if(a?i.reject(a):i.resolve(c),f(),w.length||g("requestscompleted"),e)throw e}function f(){clearTimeout(m),j.removeChild(h),delete window[k]}function g(a,b,c){z&&d.postMessage(a,{status:b,response:c})}var h=document.createElement("script"),i=e(h),j=window.document.head,k=t.request.jsonpCallbackPrefix+s(),l=r.extend({url:a},A);z&&d.postMessageSync("request",{options:l}),r.isEqual(r.omitKeys(l,"url"),A)||u.warn("Ignored not allowed request options change in JSONP request - only URL can be changed");var m=setTimeout(function(){var a=new Error("No JSONP response or no callback in response");c(a)},t.request.jsonpTimeout);return window[k]=r.partial(c,null),w.push(window[k]),h.type="text/javascript",h.src=l.url+(-1==l.url.indexOf("?")?"?":"&")+"callback="+k,j.appendChild(h),i.promise}function n(a,b,c,f){function i(a){f&&(j.upload.onprogress=void 0),h(j,c,k,a.type)}"string"==typeof a&&(a={method:"POST",url:a}),a.method=a.method||"POST",a.file=!0,z&&d.postMessageSync("request",{options:a});var j=new XMLHttpRequest;f&&(j.upload.onprogress=f),j.open(a.method,a.url,!0),g(j,a.headers),j.timeout=a.timeout||t.request.defaults.timeout,j.onreadystatechange=j.ontimeout=j.onabort=i;var k=e(j);if(a.binary)j.send(b);else{var l=new FormData;l.append("file",b),j.send(l)}return w.push(j),k.promise}function o(){z&&z.destroy(),d._destroyed=!0}function p(a,b){a=r.once(a),b&&r.delay(a,b,"timeout"),w.length?z.once("requestscompleted",a):r.defer(a)}var q=a("milo-core"),r=q.proto,s=a("./count"),t=a("../config"),u=q.util.logger,v=q.Messenger;b.exports=d;var w=[],x=c("then"),y=c("catch");r.extend(d,{get:j,post:k,json:l,jsonp:m,file:n,useMessenger:i,destroy:o,whenRequestsCompleted:p});var z,A={method:"GET",jsonp:!0}},{"../config":64,"./count":77,"milo-core":105}],88:[function(a,b){"use strict";function c(a){return!this instanceof c?new c(a):(this.window=a||window,void this.init())}function d(){this.selection=this.window.getSelection(),this.selection.rangeCount&&(this.range=this.selection.getRangeAt(0)),this.isCollapsed=this.selection.isCollapsed}function e(){return this.range?(this._text||(this._text=this.range.toString()),this._text):void 0}function f(){return this.range?(this._textNodes||(this._textNodes=h.call(this)),this._textNodes):void 0}function g(){this.selection.removeAllRanges()}function h(){var a=[];if(this.isCollapsed)return a;for(var b=this.range.startContainer,c=this.range.endContainer,d=this.range.commonAncestorContainer,e=this.window.document.createTreeWalker(d,NodeFilter.SHOW_TEXT),f=e.currentNode=b;f&&(!g||c.contains(f));){a.push(f);var g=g||c.contains(f);f=e.nextNode()}return a}function i(a,b){return this.range?("undefined"==typeof this[a]&&(this[a]=z(this.range[b])),this[a]):void 0}function j(a,b){return this.range?("undefined"==typeof this[a]&&(this[a]=F.getContainingComponent(this[b]())),this[a]):void 0}function k(){if(this._containedComponents)return this._containedComponents;var a=this._containedComponents=[];return this.isCollapsed||!this.range?a:B(this.range)}function l(a,b){if(!this.isCollapsed&&this.range){var c=this.containedComponents();c.forEach(a,b)}}function m(a){if(!this.isCollapsed&&this.range){var b=this._getPostDeleteSelectionPoint(a);C(this.range),this._selectAfterDelete(b),b.node.parentNode.normalize()}}function n(a){var b=this.range.startContainer,c=this.range.startOffset;return a&&this.range.startContainer!=this.range.endContainer&&(b=this.range.endContainer,c=0),{node:b,offset:c}}function o(a){var b=a.node,c=a.offset;if(b){b.nodeType==Node.TEXT_NODE&&(b.textContent=b.textContent.trimRight()),b.nodeValue||(b.nodeValue="");var d=c>b.length?b.length:c;A(b,d)}}function p(){return this.range}function q(a){var b=this.range,d=a.ownerDocument,e=d.defaultView||d.parentWindow;return b?c.createStateObject(a,b.startContainer,b.startOffset,b.endContainer,b.endOffset):{window:e}}function r(a,b,c,d,e){d=d||b,e=e||c;var f=a.ownerDocument,g=f.defaultView||f.parentWindow;return{window:g,rootEl:a,start:s(a,b,c),end:s(a,d,e)}}function s(a,b,c){var d=y.treePathOf(a,b);return d||E.error("Selection point is outside of root element"),{treePath:d,offset:c}}function t(a){var b=a.window.milo.util.dom;if(!(a.rootEl&&a.start&&a.end))return b.clearSelection(a.window),new c(a.window);var d=u(a.rootEl,a.start),e=u(a.rootEl,a.end);try{return b.setSelection(d,a.start.offset,e,a.end.offset),new c(a.window)}catch(f){E.error("Text selection: can't create selection",f,f.message)}}function u(a,b){var c=y.getNodeAtTreePath(a,b.treePath);return c||E.error("TextSelection createFromState: no node at treePath"),c}function v(a,b){var d,e=a.startContainer.ownerDocument.defaultView,f=e.getSelection();return f.removeAllRanges(),b?(d=a.cloneRange(),d.collapse(!1),f.addRange(d),f.extend(a.startContainer,a.startOffset)):f.addRange(a),new c(e)}function w(){var a,b,c=this.range.commonAncestorContainer.ownerDocument,d=this.range.cloneRange();return d.endContainer.nodeType!==Node.TEXT_NODE&&(a=c.createTreeWalker(c.body,NodeFilter.SHOW_TEXT),a.currentNode=d.endContainer,b=a.previousNode(),d.setEnd(b,b.length)),d}function x(){return y.getSelectionDirection(this.selection)}var y=a("../dom"),z=y.containingElement,A=y.setCaretPosition,B=y.getComponentsFromRange,C=y.deleteRangeWithComponents,D=a("milo-core"),E=D.util.logger,F=a("../../components/c_class"),G=D.proto;b.exports=c;var H=G.partial(i,"_startElement","startContainer"),I=G.partial(i,"_endElement","endContainer"),J=G.partial(i,"_containingElement","commonAncestorContainer"),K=G.partial(j,"_startComponent","startElement"),L=G.partial(j,"_endComponent","endElement"),M=G.partial(j,"_containingComponent","containingElement");G.extendProto(c,{init:d,text:e,textNodes:f,clear:g,startElement:H,endElement:I,containingElement:J,startComponent:K,endComponent:L,containingComponent:M,containedComponents:k,eachContainedComponent:l,del:m,_getPostDeleteSelectionPoint:n,_selectAfterDelete:o,getRange:p,getState:q,getNormalizedRange:w,getDirection:x}),G.extend(c,{createFromRange:v,createFromState:t,createStateObject:r})},{"../../components/c_class":15,"../dom":79,"milo-core":105}],89:[function(a,b){"use strict";function c(a,b,c){"undefined"!=typeof window&&(c=c||window,a=B.domStorage.root+(a?a+B.domStorage.prefixSeparator:""),C.defineProperties(this,{keyPrefix:a,sessionOnly:!!b,window:c,_storage:b?c.sessionStorage:c.localStorage,_typeSuffix:B.domStorage.typeSuffix,_keys:{}},C.WRIT))}function d(a){if("object"==typeof a)C.eachKey(a,function(a,b){this.setItem(b,a)},this);else{var b=arguments.length;if(b%2)throw new DomStorageError("DOMStorage: set should have even number of arguments or object");for(var c=0;b>c;c++){var d=arguments[c],e=arguments[++c];this.setItem(d,e)}}}function e(){var a={};return C.deepForEach(arguments,function(b){a[b]=this.getItem(b)},this),a}function f(){C.deepForEach(arguments,function(a){this.removeItem(a)},this)}function g(a){var b=this._storageKey(a);return null!=this._storage.getItem(b)}function h(a){var b=this._storageKey(a),c=o.call(this,b),d=this._storage.getItem(b),e=u(d,c);return e}function i(a,b){var c=this._storageKey(a),d=p.call(this,c,b),e=t(b,d);try{this._storage.setItem(c,e)}catch(f){if("QuotaExceededError"!=f.name)throw f;var g=B.domStorage.quotaExceeded;if(g.message&&milo.mail.postMessage("quotaexceedederror",b),g.throwError)throw f}this._keys[a]=!0,H[this.sessionOnly]._keys[c]=!0}function j(a){var b=this._storageKey(a);this._storage.removeItem(b),q.call(this,b),delete this._keys[a],delete H[this.sessionOnly]._keys[b]}function k(){var a=Object.keys(this._keys),b=a.filter(function(a){return this.hasItem(a)?!0:void delete this._keys[a]},this);return b}function l(){return this.get(this.getAllKeys())}function m(a){return this.keyPrefix+a}function n(a){return a.indexOf(this._typeSuffix)>=0?void 0:C.unPrefix(a,this.keyPrefix)}function o(a){return a=r.call(this,a),this._storage.getItem(a)}function p(a,b){var c=s(b);return a=r.call(this,a),this._storage.setItem(a,c),c}function q(a){a=r.call(this,a),this._storage.removeItem(a)}function r(a){return a+this._typeSuffix}function s(a){var b=typeof a,c=a&&a.constructor.name,d=I[c];return d||("object"!=b?b:null==a?"null":a.constructor.name)}function t(a,b){b=b||s(a);var c=J[b];return c?c(a,b):a&&a.toString==Object.prototype.toString?JSON.stringify(a):""+a}function u(a,b){var c=K[b];return c?c(a,b):a}function v(a,b,c,d){b&&(J[a]=b),c&&(K[a]=c),I[a]=d||a}function w(){var a=new A(this),b=new z(this,void 0,a);C.defineProperties(this,{_messenger:b,_messageSource:a},C.WRIT)}function x(){this._storage=void 0,this.window=void 0,this._messenger&&this._messenger.destroy(),this._destroyed=!0}{var y=a("milo-core"),z=y.Messenger,A=a("./msg_src"),B=a("../../config"),C=y.proto,D=y.util.check;D.Match}a("./model"),b.exports=c;var E={"true":{},"false":{}};C.extendProto(c,{get:e,set:d,remove:f,hasItem:g,getItem:h,setItem:i,removeItem:j,_storageKey:m,_domStorageKey:n,getAllKeys:k,getAllItems:l,createMessenger:w,destroy:x}),z.useWith(c,"_messenger",z.defaultMethods),A.useWith(c,"_messageSource",["trigger"]);
var F=new c("",!0),G=new c("",!1),H={"true":F,"false":G};C.extend(c,{registerDataType:v,local:G,session:F,storage:H,_storedKeys:E});var I={},J={Array:JSON.stringify},K={Object:C.jsonParse,Array:C.jsonParse,Date:function(a){return new Date(a)},"boolean":function(a){return"true"==a},number:Number,"function":C.toFunction,RegExp:C.toRegExp}},{"../../config":64,"./model":90,"./msg_src":91,"milo-core":105}],90:[function(a){"use strict";function b(){var b=a("./index");b.registerDataType("Model",c,d),b.registerDataType("ModelPath",c,d,"Model")}function c(a){var b=a.get();return JSON.stringify(b)}function d(a){var b=g.jsonParse(a);return new f(b)}var e=a("milo-core"),f=e.Model,g=e.proto;f.registerWithDOMStorage=b},{"./index":89,"milo-core":105}],91:[function(a,b){"use strict";function c(a){if("DOMStorage"!=a.constructor.name)throw new Error("hostObject should be an instance of DOMStorage");this.storage=a,this.messageKey=l.domStorage.messageKey,this.window=a.window,j.prototype.init.apply(this,arguments)}function d(){this.window.addEventListener("storage",this,!1)}function e(){this.window.removeEventListener("storage",this,!1)}function f(a,b){this.messenger.postMessageSync(a,b)}function g(a,b){var c=this.messageKey+a;b=b||{},b[l.domStorage.messageTimestamp]=m(),k.deferMethod(this.storage,"setItem",c,b)}function h(a){if(a.storageArea==this.storage._storage){var b=this.storage._domStorageKey(a.key);if(b){var c=k.unPrefix(b,this.messageKey);if(c){var d=this.storage.getItem(b);d&&this.dispatchMessage(c,d)}}}}var i=a("milo-core"),j=i.classes.MessageSource,k=i.proto,l=a("../../config"),m=a("../../util/count"),n=k.createSubclass(j,"StorageMessageSource",!0);k.extendProto(n,{init:c,addSourceSubscriber:d,removeSourceSubscriber:e,postMessage:f,trigger:g,handleEvent:h}),b.exports=n},{"../../config":64,"../../util/count":77,"milo-core":105}],92:[function(a,b){"use strict";function c(){var a=new d,b=new e(a,{send:"trigger",connect:"connect"},new f);return a._setMessageSource(b),a}var d=a("milo-core").Messenger,e=a("./msg_src"),f=a("./msg_api");b.exports=c},{"./msg_api":93,"./msg_src":94,"milo-core":105}],93:[function(a,b){"use strict";function c(a){return k.indexOf(a)>=0?a:"message"}function d(a,b,c){if(k.indexOf(b)>=0)return!0;if("message"==a){var d=c&&c.type;return d==b}}function e(a,b,c){var d="message"==a?h.jsonParse(c.data)||c.data:c;return d}var f=a("milo-core"),g=f.classes.MessengerAPI,h=f.proto,i=f.util.check,j=(i.Match,h.createSubclass(g,"WSMsgAPI",!0));h.extendProto(j,{translateToSourceMessage:c,filterSourceMessage:d,createInternalData:e}),b.exports=j;var k=["open","close","error","message"]},{"milo-core":105}],94:[function(a,b){"use strict";function c(a){this._options=a=a||{};var b=a.host||window.location.host.replace(/:.*/,""),c=a.port||"8080";this._ws&&(this._ws.onopen=this.ws.onmessage=this.ws.onclose=this.ws.onerror=void 0,this._ws.close()),this._ws=new WebSocket("ws://"+b+":"+c)}function d(a){f.call(this,"addEventListener",a)}function e(a){f.call(this,"removeEventListener",a)}function f(a,b){return this._ws?void this._ws[a](b,this):l.error("websocket is not created")}function g(a){this.dispatchMessage(a.type,a)}function h(a,b,c){function d(){f("off",b.callbackCorrId),c(new Error("websocket rpc: timeout"))}function e(a,b){if(clearInterval(h),"object"==typeof b){var d=b.error?new Error(b.error):null;c(d,b.data)}else c(new Error("websocket rpc: invalid response data"),b)}function f(a,b){g.messenger[a](n.websocket.rpc.responsePrefix+b,e)}if(!this._ws)return l.error("websocket is not created");b=b||{},b.type=a;var g=this;if(c){b.callbackCorrId=m();var h=k.delay(d,n.websocket.rpc.timeout);f("once",b.callbackCorrId)}this._ws.send(JSON.stringify(b))}var i=a("milo-core"),j=i.classes.MessageSource,k=i.proto,l=i.util.logger,m=a("../../util/count"),n=a("../../config"),o=i.util.check,p=(o.Match,k.createSubclass(j,"WSMessageSource",!0));k.extendProto(p,{addSourceSubscriber:d,removeSourceSubscriber:e,handleEvent:g,connect:c,trigger:h}),b.exports=p},{"../../config":64,"../../util/count":77,"milo-core":105}],95:[function(a,b){!function(){function a(){var a=0,b=0;this.output="",this.readByte=function(c){return"string"==typeof c&&(c=c.charCodeAt(0)),0>a?b|=c>>-a:b=c<<a&248,a>3?(a-=8,1):(4>a&&(this.output+=f[b>>3],a+=5),0)},this.finish=function(c){var d=this.output+(0>a?f[b>>3]:"")+(c?"$":"");return this.output="",d}}function c(){var a=0,b=0;this.output="",this.readChar=function(c){"string"!=typeof c&&"number"==typeof c&&(c=String.fromCharCode(c)),c=c.toLowerCase();var d=h()[c];"undefined"!=typeof d&&(d<<=3,b|=d>>>a,a+=5,a>=8&&(this.output+=String.fromCharCode(b),a-=8,b=a>0?d<<5-a&255:0))},this.finish=function(b){var c=this.output+(0>a?f[bits>>3]:"")+(b?"$":"");return this.output="",c}}function d(b){var c=new a,d=c.update(b,!0);return d}function e(a){var b=new c,d=b.update(a,!0);return d}var f="0123456789abcdefghjkmnpqrtuvwxyz",g={o:0,i:1,l:1,s:5},h=function(){for(var a={},b=0;b<f.length;b++)a[f[b]]=b;for(var c in g)g.hasOwnProperty(c)&&(a[c]=a[""+g[c]]);return h=function(){return a},a};a.prototype.update=function(a,b){for(var c=0;c<a.length;)c+=this.readByte(a[c]);var d=this.output;return this.output="",b&&(d+=this.finish()),d},c.prototype.update=function(a,b){for(var c=0;c<a.length;c++)this.readChar(a[c]);var d=this.output;return this.output="",b&&(d+=this.finish()),d};var i={Decoder:c,Encoder:a,encode:d,decode:e};"undefined"!=typeof window&&(window.base32=i),"undefined"!=typeof b&&b.exports&&(b.exports=i)}()},{}],96:[function(){},{}],97:[function(a,b){"use strict";function c(a,b){l(a,m.Optional(m.OneOf(Object,Function))),k.defineProperty(this,"_hostObject",a),b&&this._createProxyMethods(b),this.init&&this.init.apply(this,arguments)}function d(a,b,c){if(c=c||this._hostObject,c[a])throw new Error("method "+a+" already defined in host object");var d=this[b];l(d,Function);var e=d.bind(this);k.defineProperty(c,a,e,k.WRIT)}function e(a,b){l(a,m.Optional(m.OneOf([String],m.ObjectHash(String)))),Array.isArray(a)?a.forEach(function(a){d.call(this,a,a,b)},this):k.eachKey(a,function(a,c){d.call(this,c,a,b)},this)}function f(a,b,c){l(a,Function),l(c,m.IdentifierString);var d=n.mixin.instancePropertiesMap,e=a[d]=a[d]||{};if(e[b.name])throw new Error("Mixin: instance property for method with name "+b.name+" is already set");e[b.name]=c}function g(a,b,c,d){var e=this.prototype[c];l(e,Function);var g=h.call(this,e);k.defineProperty(a.prototype,d,g,k.WRIT),f(a,e,b)}function h(a){return function(){var b=i.call(this,a.name);return a.apply(b,arguments)}}function i(a){if(this instanceof c)return this;var b=this.constructor[n.mixin.instancePropertiesMap];return this[b[a]]}function j(a,b,c){l(c,m.Optional(m.OneOf([String],m.ObjectHash(String)))),Array.isArray(c)?c.forEach(function(c){g.call(this,a,b,c,c)},this):k.eachKey(c,function(c,d){g.call(this,a,b,c,d)},this)}var k=a("mol-proto"),l=a("../util/check"),m=l.Match,n=a("../config");b.exports=c,k.extendProto(c,{_createProxyMethod:d,_createProxyMethods:e}),k.extend(c,{useWith:j})},{"../config":99,"../util/check":116,"mol-proto":122}],98:[function(a,b){"use strict";var c={Mixin:a("./abstract/mixin"),MessageSource:a("./messenger/m_source"),MessengerMessageSource:a("./messenger/msngr_source"),MessengerAPI:a("./messenger/m_api"),MessengerRegexpAPI:a("./messenger/m_api_rx")};b.exports=c},{"./abstract/mixin":97,"./messenger/m_api":101,"./messenger/m_api_rx":102,"./messenger/m_source":103,"./messenger/msngr_source":104}],99:[function(a,b){"use strict";function c(a){d.deepExtend(c,a)}var d=a("mol-proto");b.exports=c,c({mixin:{instancePropertiesMap:"___mixin_instances"},check:!0,debug:!1})},{"mol-proto":122}],100:[function(a,b){"use strict";function c(a,b,c){c&&this._setMessageSource(c),d.call(this)}function d(){I.defineProperties(this,{_messageSubscribers:{},_patternMessageSubscribers:{}},I.CONF)}function e(){this.offAll();var a=this.getMessageSource();a&&a.destroy()}function f(a,b){return k.call(this,a,b)}function g(a,b){return k.call(this,a,b,{dispatchTimes:1})}function h(a,b){return k.call(this,a,b,{dispatchTimes:1,sync:!0})}function i(a,b){return k.call(this,a,b,{sync:!0})}function j(a,b){return k.call(this,a,b,{sync:!1})}function k(a,b,c){return J(a,K.OneOf(String,[String],RegExp)),J(b,K.OneOf(Function,{subscriber:Function,context:K.Any,options:K.Optional(Object)})),"function"==typeof b&&(b={subscriber:b,context:this._hostObject}),c&&(b.options=b.options||{},I.extend(b.options,c)),l.call(this,a,b)}function l(a,b){return I.defineProperty(b,"__messages",a),m.call(this,"_registerSubscriber",a,b)}function m(a,b,c){"string"==typeof b&&(b=b.split(M));var d=this._chooseSubscribersHash(b);if(b instanceof RegExp)return this[a](d,b,c);var e=!1;return b.forEach(function(b){var f=this[a](d,b,c);e=e||f},this),e}function n(a,b,c){if(!a[b]||!a[b].length){a[b]=[],b instanceof RegExp&&(a[b].pattern=b),this._messageSource&&this._messageSource.onSubscriberAdded(b);var d=!0}var e=a[b],f=d||-1==o.call(this,e,c);return f&&e.push(c),f}function o(a,b){return I.findIndex(a,function(a){return b.subscriber==a.subscriber&&b.context==a.context})}function p(a){J(a,K.ObjectHash(K.OneOf(Function,{subscriber:Function,context:K.Any})));var b=I.mapKeys(a,function(a,b){return this.on(b,a)},this);return b}function q(a,b){return J(a,K.OneOf(String,[String],RegExp)),J(b,K.Optional(K.OneOf(Function,{subscriber:Function,context:K.Any,options:K.Optional(Object)}))),r.call(this,a,b)}function r(a,b){return m.call(this,"_removeSubscriber",a,b)}function s(a,b,c){var d=a[b];if(!d||!d.length)return!1;if(c){"function"==typeof c&&(c={subscriber:c,context:this._hostObject});var e=o.call(this,d,c);if(-1==e)return!1;d.splice(e,1),d.length||this._removeAllSubscribers(a,b)}else this._removeAllSubscribers(a,b);return!0}function t(a,b){delete a[b],this._messageSource&&"string"==typeof b&&this._messageSource.onSubscriberRemoved(b)}function u(a){J(a,K.ObjectHash(K.Optional(K.OneOf(Function,{subscriber:Function,context:K.Any}))));var b=I.mapKeys(a,function(a,b){return this.off(b,a)},this);return b}function v(){w.call(this,this._patternMessageSubscribers),w.call(this,this._messageSubscribers)}function w(a){I.eachKey(a,function(b,c){this._removeAllSubscribers(a,c)},this)}function x(a,b,c,d){J(a,K.OneOf(String,RegExp)),J(c,K.Optional(Function));var e=this._chooseSubscribersHash(a),f=e[a];this._callSubscribers(a,b,c,f,d),"string"==typeof a&&this._callPatternSubscribers(a,b,c,f,d)}function y(a,b,c){this.postMessage(a,b,c,!0)}function z(a,b,c,d,e){I.eachKey(this._patternMessageSubscribers,function(f){var g=f.pattern;if(g.test(a)){if(d)var f=f.filter(function(a){var b=o.call(this,d,a);return-1==b});this._callSubscribers(a,b,c,f,e)}},this)}function A(a,b,c,d,e){d&&d.length&&(d=d.slice(),d.forEach(function(d){this._callSubscriber(d,a,b,c,e)},this))}function B(a,b,c,d,e){var f=a.options&&a.options.sync,g=e&&f!==!1||f,h=a.options&&a.options.dispatchTimes;if(h)if(1>=h){var i=a.__messages;this.off(i,a)}else h>1&&a.options.dispatchTimes--;g?a.subscriber.call(a.context,b,c,d):I.deferMethod(a.subscriber,"call",a.context,b,c,d)}function C(a,b){J(a,K.OneOf(String,RegExp));var c=this._chooseSubscribersHash(a),d=c[a]?[].concat(c[a]):[];return b!==!1&&"string"==typeof a&&I.eachKey(this._patternMessageSubscribers,function(b){var c=b.pattern;b&&b.length&&c.test(a)&&I.appendArray(d,b)}),d.length?d:void 0}function D(a){return a instanceof RegExp?this._patternMessageSubscribers:this._messageSubscribers}function E(a){J(a,H),I.defineProperty(this,"_messageSource",a),a.messenger=this}function F(){return this._messageSource}var G=a("../abstract/mixin"),H=a("./m_source"),I=a("mol-proto"),J=a("../util/check"),K=J.Match,L=I.createSubclass(G,"Messenger"),M=L.messagesSplitRegExp=/\s*(?:\,|\s)\s*/;I.extendProto(L,{init:c,destroy:e,on:f,once:g,onceSync:h,onSync:i,onAsync:j,onMessage:f,off:q,offMessage:q,onMessages:p,offMessages:u,offAll:v,postMessage:x,postMessageSync:y,getSubscribers:C,getMessageSource:F,_chooseSubscribersHash:D,_registerSubscriber:n,_removeSubscriber:s,_removeAllSubscribers:t,_callPatternSubscribers:z,_callSubscribers:A,_callSubscriber:B,_setMessageSource:E}),L.defaultMethods={on:"on",onSync:"onSync",once:"once",onceSync:"onceSync",off:"off",onMessages:"onMessages",offMessages:"offMessages",postMessage:"postMessage",postMessageSync:"postMessageSync",getSubscribers:"getSubscribers"},b.exports=L,L.subscriptions=[]},{"../abstract/mixin":97,"../util/check":116,"./m_source":103,"mol-proto":122}],101:[function(a,b){"use strict";function c(){this.init&&this.init.apply(this,arguments)}function d(){l.defineProperty(this,"_internalMessages",{})}function e(){}function f(a){var b,c=this.translateToSourceMessage(a);if("undefined"!=typeof c)return this._internalMessages.hasOwnProperty(c)?(b=this._internalMessages[c],void(-1==b.indexOf(a)?b.push(a):m.warn("Duplicate addInternalMessage call for internal message "+a))):(b=this._internalMessages[c]=[],b.push(a),c)}function g(a){function b(){m.warn("notification received: un-subscribe from internal message "+a+" without previous subscription notification")}var c=this.translateToSourceMessage(a);if("undefined"!=typeof c){var d=this._internalMessages[c];if(d&&d.length){var e=d.indexOf(a);if(e>=0){if(d.splice(e,1),0==d.length)return delete this._internalMessages[c],c}else b()}else b()}}function h(a){return this._internalMessages[a]}function i(a){return a}function j(a,b,c){return c}function k(){return!0}var l=a("mol-proto"),m=a("../util/logger");b.exports=c,l.extendProto(c,{init:d,destroy:e,addInternalMessage:f,removeInternalMessage:g,getInternalMessages:h,translateToSourceMessage:i,createInternalData:j,filterSourceMessage:k})},{"../util/logger":118,"mol-proto":122}],102:[function(a,b){"use strict";function c(){g.prototype.init.apply(this,arguments),h.defineProperties(this,{_patternInternalMessages:{}}),this._catchAllSubscribed=!1}function d(){var a=g.prototype.addInternalMessage.apply(this,arguments);if(a&&a instanceof RegExp){if(this._internalMessages[a].pattern=a,this._patternInternalMessages[a]=this._internalMessages[a],this._catchAllSubscribed)return;return this._catchAllSubscribed=!0,/.*/}return a}function e(){var a=g.prototype.removeInternalMessage.apply(this,arguments);if(a&&a instanceof RegExp){delete this._patternInternalMessages[a];var b=!Object.keys(this._patternInternalMessages).length;if(b)return this._catchAllSubscribed=!1,/.*/}return a}function f(a){var b=g.prototype.getInternalMessages.apply(this,arguments);if("string"==typeof a){b=b||[];var c=h.object(b,!0);h.eachKey(this._patternInternalMessages,function(d){var e=d.pattern;e.test(a)&&d.forEach(function(a){c[a]||(b.push(a),c[a]=!0)})})}return b}var g=a("./m_api"),h=a("mol-proto"),i=h.createSubclass(g,"MessengerRegexpAPI");b.exports=i,h.extendProto(i,{init:c,addInternalMessage:d,removeInternalMessage:e,getInternalMessages:f})},{"./m_api":101,"mol-proto":122}],103:[function(a,b){"use strict";function c(a,b,c){this._prepareMessengerAPI(c)}function d(){this.messengerAPI&&this.messengerAPI.destroy()}function e(a){n.defineProperty(this,"messenger",a)}function f(a){o(a,p.Optional(m)),a||(a=new m),n.defineProperty(this,"messengerAPI",a)}function g(a){var b=this.messengerAPI.addInternalMessage(a);"undefined"!=typeof b&&this.addSourceSubscriber(b)}function h(a){var b=this.messengerAPI.removeInternalMessage(a);"undefined"!=typeof b&&this.removeSourceSubscriber(b)}function i(a,b){var c=this.messengerAPI,d=c.getInternalMessages(a);d&&d.forEach(function(d){var e=c.createInternalData(a,d,b),f=c.filterSourceMessage(a,d,e);f&&this.postMessage(d,e)},this)}function j(a,b){this.messenger.postMessage(a,b)}function k(){throw new Error("calling the method of an absctract class")}var l=a("../abstract/mixin"),m=a("./m_api"),n=(a("../util/logger"),a("mol-proto")),o=a("../util/check"),p=o.Match,q=n.createSubclass(l,"MessageSource",!0);b.exports=q,n.extendProto(q,{init:c,destroy:d,setMessenger:e,onSubscriberAdded:g,onSubscriberRemoved:h,dispatchMessage:i,postMessage:j,_prepareMessengerAPI:f,trigger:k,addSourceSubscriber:k,removeSourceSubscriber:k})},{"../abstract/mixin":97,"../util/check":116,"../util/logger":118,"./m_api":101,"mol-proto":122}],104:[function(a,b){"use strict";function c(a,b,c,d){g.prototype.init.apply(this,arguments),this.sourceMessenger=d}function d(a){this.sourceMessenger.onSync(a,{context:this,subscriber:this.dispatchMessage})}function e(a){this.sourceMessenger.off(a,{context:this,subscriber:this.dispatchMessage})}function f(a,b){this.messenger.postMessageSync(a,b)}var g=a("./m_source"),h=a("mol-proto"),i=(a("../util/check"),h.createSubclass(g,"MessengerMessageSource"));b.exports=i,h.extendProto(i,{init:c,addSourceSubscriber:d,removeSourceSubscriber:e,postMessage:f})},{"../util/check":116,"./m_source":103,"mol-proto":122}],105:[function(a,b){"use strict";function c(){e.minder.destroy()}var d=a("mol-proto"),e={minder:a("./minder"),config:a("./config"),util:a("./util"),classes:a("./classes"),Messenger:a("./messenger"),Model:a("./model"),destroy:c,proto:d};"object"==typeof b&&b.exports&&(b.exports=e),"object"==typeof window&&(window.milo=e)},{"./classes":98,"./config":99,"./messenger":100,"./minder":106,"./model":109,"./util":117,"mol-proto":122}],106:[function(a,b){"use strict";function c(a,b,c,e){if(Array.isArray(a)){var f=a,g=f.map(function(a){return new p(a[0],a[1],a[2],a[3])});return g.forEach(d),g}var h=new p(a,b,c,e);return d(h),h}function d(a){a.___minder_id=u.push(a)-1,a.on(/.*/,e),c.postMessage("added",{connector:a}),c.postMessage("turnedon",{connector:a})}function e(a,b){var b=b?r.clone(b):{};r.extend(b,{id:this.___minder_id,connector:this}),c.postMessage(a,b),v.length||w||(r.defer(f),w=!0),v.push({msg:a,data:b})}function f(){v.length?(v.length=0,r.defer(f),c.postMessage("propagationticked")):(w=!1,c.postMessage("propagationcompleted"))}function g(){return w}function h(a){function b(){w?c.once("propagationcompleted",b):a()}w?c.once("propagationcompleted",b):r.defer(b)}function i(a){return"undefined"==typeof a?u:u.filter(function(b){return b.isOn===a})}function j(a){a.destroy();var b=u.indexOf(a);b>=0?delete u[b]:s.warn("minder: connector destroyed that is not registered in minder")}function k(a,b){var d=c.getConnectors(a),e=d.map(function(a){var b={leftSource:l(a.ds1),rightSource:l(a.ds2),mode:a.mode,isOn:a.isOn};return a.options&&(b.options=a.options),b});return b&&(e=e.filter(function(a){return m(a.leftSource,b)||m(a.rightSource,b)})),e}function l(a){var b=[];return"function"==typeof a&&(a._model&&a._accessPath&&(b.unshift(a._accessPath),a=a._model),b.unshift(a),a=a._hostObject),"object"==typeof a&&(b.unshift(a),a.owner&&b.unshift(a.owner)),b}function m(a,b){return a.some(function(a){var c=a.constructor&&a.constructor.name;return n(c,b)||n(a.name,b)||n(a,b)})}function n(a,b){return a&&"string"==typeof a&&a.indexOf(b)>=0}function o(){function a(a){a&&!a._destroyed&&a.destroy()}u.forEach(function(b){a(b.ds1),a(b.ds2),b.destroy()}),t.destroy(),c._destroyed=!0}var p=a("./model/connector"),q=a("./messenger"),r=a("mol-proto"),s=a("./util/logger");b.exports=c;var t=new q(c,q.defaultMethods),u=[],v=[],w=!1;r.extend(c,{getConnectors:i,getExpandedConnections:k,isPropagating:g,whenPropagationCompleted:h,destroyConnector:j,destroy:o})},{"./messenger":100,"./model/connector":108,"./util/logger":118,"mol-proto":122}],107:[function(a,b){"use strict";function c(a,b){r.defineProperty(a,"__inChangeTransaction",b,r.CONF|r.WRIT)}function d(a){var b=a.__inChangeTransaction;return delete a.__inChangeTransaction,b}function e(a,b){var e=d(a);return c(b,e),e}function f(){this.postMessageSync("datachanges",{transaction:!1,changes:[]})}function g(a,b,c){h.call(this,b.changes,c)}function h(a,b){i.call(this,b,!1),l.call(this,k(j(a))),i.call(this,b,!0)}function i(a,b){a&&a(null,b),this.postMessage(b?"changecompleted":"changestarted")}function j(a){var b=a[0].source,c=!0;if(a.length>1)for(var d=1,e=a.length;e>d;d++)a[d].source!=b&&(o.error("changedata: changes from different sources in the same transaction, sources:",a[d].source.name,b.name),c=!1,b=a[d].source);return a}function k(a){function b(a){("splice"==a.type?c:d)(a)}function c(a){var b=q.parseAccessPath(a.path),c=i.some(function(a){return b.length<a.length?void 0:e(a,b)});if(!c){if(g.push(a),!p.debug)throw j;h.push(b),f=!0}}function d(a){var b=q.parseAccessPath(a.path),c=h&&h.some(function(a){return b.length<=a.length||"array"!=b[a.length].syntax?void 0:e(a,b)});if(!c){f&&o.error('changedata: child change is executed after splice; probably data source did not emit message with data.type=="finished"');var d=i.some(function(a){return b.length<=a.length?void 0:e(a,b)});d||(i.push(b),g.push(a))}}function e(a,b){return a.every(function(a,c){return a.property==b[c].property})}var f,g=[],h=[],i=[],j={};try{a.forEach(b)}catch(k){if(k!=j)throw k}return g}function l(a){function b(a){var b=this.path(a.path,"removed"!=a.type&&"deleted"!=a.type);b&&("splice"==a.type?m:n)(b,a)}a.forEach(b,this),f.call(this,!1)}function m(a,b){var d=b.index,e=b.removed.length,f=[d,e];f=f.concat(b.newValue.slice(d,d+b.addedCount)),c(a.splice,!0),a.splice.apply(a,f)}function n(a,b){var d=s[b.type];d?(c(a[d],!0),a[d](b.newValue)):o.error("unknown data change type")}var o=a("../util/logger"),p=a("../config"),q=a("./path_utils"),r=a("mol-proto");b.exports=g,r.extend(g,{setTransactionFlag:c,getTransactionFlag:d,passTransactionFlag:e,postTransactionFinished:f});var s={added:"set",changed:"set",deleted:"del",removed:"del"}},{"../config":99,"../util/logger":118,"./path_utils":114,"mol-proto":122}],108:[function(a,b){"use strict";function c(a,b,c,e){if(d.call(this,b),o.extend(this,{ds1:a,ds2:c,isOn:!1,_changesQueue1:[],_changesQueue2:[],_messenger:new m(this,m.defaultMethods)}),e){this.options=e;var f=e.pathTranslation;if(f){f=o.clone(f);var j=h(f);o.extend(this,{pathTranslation1:g(f),pathTranslation2:f,patternTranslation1:i(j),patternTranslation2:j})}var k=e.dataTranslation;k&&o.extend(this,{dataTranslation1:k["<-"],dataTranslation2:k["->"]});var l=e.dataValidation;l&&o.extend(this,{dataValidation1:l["<-"],dataValidation2:l["->"]})}this.turnOn()}function d(a){function b(){throw new Error("invalid Connector mode: "+a)}var c=a.match(q);c||b();var d=c[1].length,e=c[2].length;d&&e&&d!=e&&b(),d||e||b(),o.extend(this,{mode:a,depth1:d,depth2:e})}function e(a){return this.turnOff(),d.call(this,a),this.turnOn(),this}function f(a){return o.deferMethod(this,"changeMode",a),this}function g(a){var b={};return o.eachKey(a,function(a,c){b[a]=c}),b}function h(a){function b(a,b){throw new Error("Invalid pattern translation: "+a+", "+b)}function c(a){return a.replace(/[\.\[]?\*.*$/,"")}var d=[];return o.eachKey(a,function(e,f){var g=f.indexOf("*"),h=e.indexOf("*");g>=0&&h>=0?(f.slice(g)!=e.slice(h)&&b(f,e),delete a[f],d.push({fromPattern:n.createRegexPath(f),fromStaticPath:c(f,g),toPattern:n.createRegexPath(e),toStaticPath:c(e,h)})):(g>=0||h>=0)&&b(f,e)}),d}function i(a){return a.map(function(a){return{fromPattern:a.toPattern,fromStaticPath:a.toStaticPath,toPattern:a.fromPattern,toStaticPath:a.fromStaticPath}})}function j(){function a(a,b,e,f,g,h,i,j){function k(k,l){function m(a){if(g){var b=g[a];if(b)return b;if(!h.length)return;var d=o.find(h,function(b){return b.fromPattern.test(a)});if(!d)return;var b=a.replace(d.fromStaticPath,d.toStaticPath)}else if(!(c instanceof RegExp&&c.test(a)||c==a))return;return b||a}function n(a,b){if(i){var c=i[a];c&&"function"==typeof c&&(b.oldValue=c(b.oldValue),b.newValue=c(b.newValue))}}function p(a,c){function d(d){d(c.newValue,function(c,d){d.path=a,g||!c&&!d.valid||++f!=e.length?d.valid||(g=!0,b.postMessage("validated",d)):b.postMessage("validated",d)})}if(q(c),j){var e=j[a],f=0,g=!1;e&&e.forEach(d)}}function q(a){u.changes.push(a)}function r(){if(d[a])var b=s;var c=t(f);f.length=0,c.forEach(function(a){e.postMessageSync("changedata",{changes:a},b)})}function s(c,f){if(!c){var g=f?"onSync":"off";e[g]("datachanges",d[a]);var h=f?"changecompleted":"changestarted";d.postMessage(h,{source:b,target:e})}}function t(a){var b,c=[];return a.forEach(function(a){a.transaction||(b=void 0),a.changes.length&&(a.transaction?b?o.appendArray(b,a.changes):(b=o.clone(a.changes),c.push(b)):c.push(a.changes))}),c}var u={changes:[],transaction:l.transaction};l.changes.forEach(function(a){var c=a.path,d=m(c);if("undefined"!=typeof d){var a=o.clone(a);o.extend(a,{source:b,path:d}),n(c,a),p(c,a)}}),f.length||o.defer(r),f.push(u)}return b.onSync("datachanges",k),k}if(this.isOn)return p.warn("data sources are already connected");var b=this._subscriptionPath=new Array(this.depth1||this.depth2).join("*"),c=n.createRegexPath(b),d=this;this.depth1&&(this._link1=a("_link2",this.ds2,this.ds1,this._changesQueue1,this.pathTranslation1,this.patternTranslation1,this.dataTranslation1,this.dataValidation1)),this.depth2&&(this._link2=a("_link1",this.ds1,this.ds2,this._changesQueue2,this.pathTranslation2,this.patternTranslation2,this.dataTranslation2,this.dataValidation2)),this.isOn=!0,this.postMessage("turnedon")}function k(){function a(a,c){b[c]&&(a.off("datachanges",b[c]),delete b[c])}if(!this.isOn)return p.warn("data sources are already disconnected");var b=this;a(this.ds1,"_link2",this.pathTranslation2),a(this.ds2,"_link1",this.pathTranslation1),this.isOn=!1,this.postMessage("turnedoff")}function l(){this.turnOff(),this.postMessage("destroyed"),this._messenger.destroy(),delete this.ds1,delete this.ds2,this._destroyed=!0}var m=a("../messenger"),n=a("./path_utils"),o=a("mol-proto"),p=a("../util/logger");b.exports=c;var q=/^(\<*)\-+(\>*)$/;o.extendProto(c,{turnOn:j,turnOff:k,destroy:l,changeMode:e,deferChangeMode:f})},{"../messenger":100,"../util/logger":118,"./path_utils":114,"mol-proto":122}],109:[function(a,b){"use strict";function c(a,b,d){var f=function(){return e.apply(f,arguments)};return f.__proto__=c.prototype,f._hostObject=b,f._options=d||{},f._options.reactive!==!1&&(f._prepareMessengers(),f.onSync("changedata",p)),a&&(f._data=a),f}function d(){return this._data}function e(a){return a?(u.splice(arguments,0,0,null,this),new(Function.prototype.bind.apply(l,arguments))):this}function f(a){a=a||this._hostObject,t.prototype._createProxyMethods.call(this[w],q.defaultMethods,a)}function g(a,b,d){d=d||x,t.useWith.call(c,a,b,d)}function h(a){a=a||this._hostObject,t.prototype._createProxyMethods.call(this,x,a)}function i(){var a=new q(this,void 0,void 0),b=new r(this,void 0,new s,a),c=new q(this,void 0,b);u.defineProperty(this,w,c),u.defineProperty(this,"_internalMessenger",a)}function j(){return this._hostObject}function k(){this[w].destroy(),this._internalMessenger.destroy(),this._destroyed=!0}{var l=a("./m_path"),m=a("./synthesize"),n=a("./path_utils"),o=a("./model_utils"),p=a("./change_data"),q=a("../messenger"),r=a("../messenger/msngr_source"),s=a("./m_msg_api"),t=a("../abstract/mixin"),u=a("mol-proto"),v=a("../util/check");v.Match,a("../util/logger")}b.exports=c,c.prototype.__proto__=c.__proto__,u.extendProto(c,{path:e,get:d,proxyMessenger:f,proxyMethods:h,_prepareMessengers:i,_getHostObject:j,destroy:k}),u.extendProto(c,m.modelMethods),u.extend(c,{Path:l,useWith:g,_utils:{path:n,model:o,changeDataHandler:p}});var w="_messenger";q.useWith(c,w,q.defaultMethods),["len","push","pop","unshift","shift"].forEach(function(a){var b=l.prototype[a];u.defineProperty(c.prototype,a,b)});var x=["path","get","set","del","splice","len","push","pop","unshift","shift"]},{"../abstract/mixin":97,"../messenger":100,"../messenger/msngr_source":104,"../util/check":116,"../util/logger":118,"./change_data":107,"./m_msg_api":110,"./m_path":111,"./model_utils":112,"./path_utils":114,"./synthesize":115,"mol-proto":122}],110:[function(a,b){"use strict";function c(a){return a instanceof RegExp?a:e.createRegexPath(a)}var d=a("../messenger/m_api_rx"),e=a("./path_utils"),f=a("mol-proto"),g=f.createSubclass(d,"ModelMsgAPI");b.exports=g,f.extendProto(g,{translateToSourceMessage:c})},{"../messenger/m_api_rx":102,"./path_utils":114,"mol-proto":122}],111:[function(a,b){"use strict";function c(a,b){v(b,String);var f=function(){return e.apply(f,arguments)};f.__proto__=c.prototype,u.defineProperties(f,{_model:a,_path:b,_args:u.slice(arguments,1),_options:a._options});var g=p.parseAccessPath(b);u.defineProperty(f,"_accessPath",d(g,f._args)),f._options.reactive!==!1&&(f._prepareMessenger(),f.onSync("changedata",q));var h=o(b,g);return u.defineProperties(f,h),Object.freeze(f),f}function d(a,b){return a.reduce(function(a,c){var d=c.interpolate;return a+(d?"array"==c.syntax?"["+b[d]+"]":"."+b[d]:c.property)},"")}function e(a){if(!a)return this;var b=this._args.length-1;b>0&&(a=a.replace(/\$[1-9][0-9]*/g,function(a){return"$"+(+a.slice(1)+b)}));var d=this._path+a,e=[this._model,d].concat(this._args.slice(1)).concat(u.slice(arguments,1));return u.newApply(c,e)}function f(){return this.path(".length").get()||0}function g(){var a=this.len(),b=a+arguments.length;return u.splice(arguments,0,0,a,0),this.splice.apply(this,arguments),b}function h(){return this.splice(this.len()-1,1)[0]}function i(){var a=this.len();return a+=arguments.length,u.splice(arguments,0,0,0,0),this.splice.apply(this,arguments),a}function j(){return this.splice(0,1)[0]}function k(){var a=new s(this._accessPath),b=new t(this,void 0,a,this._model),c=new r(this,void 0,b);u.defineProperty(this,w,c)}function l(){return{model:this._model,path:this._path,args:this._args}}function m(a){v(a,{model:Function,path:String,args:Array});var b=a.model;return b.apply(b,a.args)}function n(){this[w].destroy()}{var o=a("./synthesize"),p=a("./path_utils"),q=a("./change_data"),r=a("../messenger"),s=a("./path_msg_api"),t=a("../messenger/msngr_source"),u=a("mol-proto"),v=a("../util/check");v.Match}b.exports=c,c.prototype.__proto__=c.__proto__,u.extendProto(c,{path:e,len:f,push:g,pop:h,unshift:i,shift:j,_prepareMessenger:k,_getDefinition:l,destroy:n}),u.extend(c,{_createFromDefinition:m});var w="_messenger";r.useWith(c,w,r.defaultMethods)},{"../messenger":100,"../messenger/msngr_source":104,"../util/check":116,"./change_data":107,"./path_msg_api":113,"./path_utils":114,"./synthesize":115,"mol-proto":122}],112:[function(a,b){"use strict";function c(a,b){return a>b?b:a>=0?a:a+b>0?a+b:0}var d={normalizeSpliceIndex:c};b.exports=d},{}],113:[function(a,b){"use strict";function c(a){g.prototype.init.apply(this,arguments),this.rootPath=a}function d(a){return a instanceof RegExp?a:"datachanges"==a?a:this.rootPath+a}function e(a,b,c){if("datachanges"==b){var d=c.changes.map(f,this).filter(function(a){return a}),e={changes:d,transaction:c.transaction};return e}var e=f.call(this,c);return e}function f(a){var b=a.path,c=h.unPrefix(b,this.rootPath);if("string"==typeof c){var a=h.clone(a);return a.fullPath=b,a.path=c,a}}var g=a("../messenger/m_api"),h=(a("./path_utils"),a("../util/logger"),a("mol-proto")),i=h.createSubclass(g,"ModelPathMsgAPI");b.exports=i,h.extendProto(i,{init:c,translateToSourceMessage:d,createInternalData:e})},{"../messenger/m_api":101,"../util/logger":118,"./path_utils":114,"mol-proto":122}],114:[function(a,b){"use strict";function c(a,b){b=b||t;var c=[];if(!a)return c;var d=a.replace(b,function(a){var b={property:a};return i.extend(b,w[a[0]]),"$"==a[1]&&(b.interpolate=e(b,!0)),c.push(b),""});if(d)throw new Error("incorrect model path: "+a);return c}function d(a){if(g(a,h.OneOf(String,RegExp)),a instanceof RegExp||-1==a.indexOf("*"))return a;var b=j.parseAccessPath(a,v),c="^",d=!1;b.forEach(function(a){var b=a.property,e=x[b];e?(c+="("+e+"|)",d=!0):c+=b.replace(/(\.|\[|\])/g,"\\$1")}),c+="$";try{return new RegExp(c)}catch(e){throw new Error("can't construct regex for path pattern: "+a)}}function e(a,b){var c=a.property,d=b?2:1;return"array"==a.syntax?c.slice(d,c.length-1):c.slice(d)}function f(a){a=a||["on","off"];var b=i.mapToObject(a,function(a){var b=this[a];return function(a,c){var e=d(a);b.call(this,e,c)}},this);i.defineProperties(this,b)}var g=a("../util/check"),h=g.Match,i=a("mol-proto"),j={parseAccessPath:c,createRegexPath:d,getPathNodeKey:e,wrapMessengerMethods:f};b.exports=j;
var k="\\.[A-Za-z_-][A-Za-z0-9_-]*",l="\\[[0-9]+\\]",m="\\$[1-9][0-9]*",n="\\."+m,o="\\["+m+"\\]",p="\\.\\*",q="\\[\\*\\]",r="\\*",s=[k,l,n,o].join("|"),t=new RegExp(s,"g"),u=[s,p,q,r].join("|"),v=new RegExp(u,"g"),w={".":{syntax:"object",empty:"{}"},"[":{syntax:"array",empty:"[]"},"*":{syntax:"match",empty:"{}"}},x={".*":k,"[*]":l};x["*"]=x[".*"]+"|"+x["[*]"]},{"../util/check":116,"mol-proto":122}],115:[function(require,module,exports){"use strict";function _synthesizePathMethods(a,b){var c=_.mapKeys(synthesizers,function(c){return _synthesize(c,a,b)});return c}function _synthesize(synthesizer,path,parsedPath){function addChangeMessage(a,b,c){a.push(c),b[c.path]=c}function addTreeChangesMessages(a,b,c,d,e){var f=valueIsTree(d),g=valueIsTree(e);g&&addMessages(a,b,c,e,"added","newValue"),f&&addMessages(a,b,c,d,"removed","oldValue")}function addMessages(a,b,c,d,e,f){function g(a,b){if(Array.isArray(b)){var c=a+"[$$]";b.forEach(function(a,b){h(a,b,c)})}else{var c=a+".$$";_.eachKey(b,function(a,b){h(a,b,c)})}}function h(c,d,h){var i=h.replace("$$",d),j=b[i];if(j)j.type==e?logger.error("setter error: same message type posted on the same path"):(j.type="changed",j[f]=c);else{var k={path:i,type:e};k[f]=c,addChangeMessage(a,b,k)}valueIsTree(c)&&g(i,c)}g(c,d)}function cloneTree(a){return valueIsNormalObject(a)?_.deepClone(a):a}function protectValue(a){return valueIsNormalObject(a)?Array.isArray(a)?a.slice():Object.create(a):a}function valueIsTree(a){return valueIsNormalObject(a)&&Object.keys(a).length}function valueIsNormalObject(a){return!(null==a||"object"!=typeof a||a instanceof Date||a instanceof RegExp)}function addBatchIdsToMessage(a,b,c){_.defineProperties(a,{__batch_id:b,__msg_id:c})}var method,methodCode=synthesizer({parsedPath:parsedPath,getPathNodeKey:pathUtils.getPathNodeKey});try{eval(methodCode)}catch(e){throw ModelError("ModelPath method compilation error; path: "+path+", code: "+methodCode)}return method}var pathUtils=require("../path_utils"),modelUtils=require("../model_utils"),logger=require("../../util/logger"),fs=require("fs"),doT=require("dot"),_=require("mol-proto"),changeDataHandler=require("../change_data"),getTransactionFlag=changeDataHandler.getTransactionFlag,postTransactionFinished=changeDataHandler.postTransactionFinished,templates={get:"'use strict';\n/* Only use this style of comments, not \"//\" */\n\nmethod = function get() {\n    var m = {{# def.modelAccessPrefix }};\n    return m {{~ it.parsedPath :pathNode }}\n        {{? pathNode.interpolate}}\n            && (m = m[this._args[ {{= pathNode.interpolate }} ]])\n        {{??}}\n            && (m = m{{= pathNode.property }})\n        {{?}} {{~}};\n};\n",set:"'use strict';\n/* Only use this style of comments, not \"//\" */\n\n{{# def.include_defines }}\n{{# def.include_create_tree }}\n\n\n/**\n * Template that synthesizes setter for Model and for ModelPath\n */\nmethod = function set(value) {\n    {{# def.initVars:'set' }}\n\n    {{# def.createTree:'set' }}\n\n    {{\n        currNode = nextNode;\n        currProp = currNode && currNode.property;\n    }}\n\n    {{ /* assign value to the last property */ }}\n    {{? currProp }}\n        wasDef = {{# def.wasDefined}};\n        {{# def.changeAccessPath }}\n\n        var old = m{{# def.currProp }};\n\n        {{ /* clone value to prevent same reference in linked models */ }}\n        m{{# def.currProp }} = cloneTree(value);\n    {{?}}\n\n    {{ /* add message related to the last property change */ }}\n    if (this._options.reactive !== false) {\n        if (! wasDef)\n            {{# def.addMsg }} accessPath, type: 'added',\n                newValue: value });\n        else if (old != value)\n            {{# def.addMsg }} accessPath, type: 'changed',\n                oldValue: old, newValue: value });\n\n        {{ /* add message related to changes in (sub)properties inside removed and assigned value */ }}\n        if (! wasDef || old != value)\n            addTreeChangesMessages(messages, messagesHash,\n                accessPath, old, value); /* defined in the function that synthesizes ModelPath setter */\n\n        {{ /* post all stored messages */ }}\n        {{# def.postMessages }}\n    }\n};\n",del:"'use strict';\n/* Only use this style of comments, not \"//\" */\n\n{{# def.include_defines }}\n{{# def.include_traverse_tree }}\n\nmethod = function del() {\n    {{# def.initVars:'del' }}\n\n    {{? it.parsedPath.length }}\n        {{# def.traverseTree }}\n\n        {{\n            var currNode = it.parsedPath[count];\n            var currProp = currNode.property;       \n        }}\n\n        if (! treeDoesNotExist && m && m.hasOwnProperty && {{# def.wasDefined}}) {\n            var old = m{{# def.currProp }};\n            delete m{{# def.currProp }};\n            {{# def.changeAccessPath }}\n            var didDelete = true;\n        }\n    {{??}}\n        if (typeof m != 'undefined') {\n            var old = m;\n            {{# def.modelAccessPrefix }} = undefined;\n            var didDelete = true;\n        }\n    {{?}}\n\n    if (didDelete && this._options.reactive !== false) {\n        {{# def.addMsg }} accessPath, type: 'deleted', oldValue: old });\n\n        addTreeChangesMessages(messages, messagesHash,\n            accessPath, old, undefined); /* defined in the function that synthesizes ModelPath setter */\n\n        {{ /* post all stored messages */ }}\n        {{# def.postMessages }}\n    }\n};\n",splice:"'use strict';\n/* Only use this style of comments, not \"//\" */\n\n{{# def.include_defines }}\n{{# def.include_create_tree }}\n{{# def.include_traverse_tree }}\n\nmethod = function splice(spliceIndex, spliceHowMany) { /* ,... - extra arguments to splice into array */\n    {{# def.initVars:'splice' }}\n\n    var argsLen = arguments.length;\n    var addItems = argsLen > 2;\n\n    if (addItems) {\n        {{ /* only create model tree if items are inserted in array */ }}\n\n        {{ /* if model is undefined it will be set to an empty array */ }}  \n        var value = [];\n        {{# def.createTree:'splice' }}\n\n        {{? nextNode }}\n            {{\n                var currNode = nextNode;\n                var currProp = currNode.property;\n                var emptyProp = '[]';\n            }}\n\n            {{# def.createTreeStep }}\n        {{?}}\n\n    } else if (spliceHowMany > 0) {\n        {{ /* if items are not inserted, only traverse model tree if items are deleted from array */ }}\n        {{? it.parsedPath.length }}\n            {{# def.traverseTree }}\n\n            {{\n                var currNode = it.parsedPath[count];\n                var currProp = currNode.property;       \n            }}\n\n            {{ /* extra brace closes 'else' in def.traverseTreeStep */ }}\n            {{# def.traverseTreeStep }} }\n        {{?}}\n    }\n\n    {{ /* splice items */ }}\n    if (addItems || (! treeDoesNotExist && m\n            && m.length > spliceIndex ) ) {\n        var oldLength = m.length = m.length || 0;\n\n        arguments[0] = spliceIndex = normalizeSpliceIndex(spliceIndex, m.length);\n\n        {{ /* clone added arguments to prevent same references in linked models */ }}\n        if (addItems)\n            for (var i = 2; i < argsLen; i++)\n                arguments[i] = cloneTree(arguments[i]);\n\n        {{ /* actual splice call */ }}\n        var removed = Array.prototype.splice.apply(m, arguments);\n\n        if (this._options.reactive !== false) {\n            {{# def.addMsg }} accessPath, type: 'splice',\n                    index: spliceIndex, removed: removed, addedCount: addItems ? argsLen - 2 : 0,\n                    newValue: m });\n\n            if (removed && removed.length)\n                removed.forEach(function(item, index) {\n                    var itemPath = accessPath + '[' + (spliceIndex + index) + ']';\n                    {{# def.addMsg }} itemPath, type: 'removed', oldValue: item });\n\n                    if (valueIsTree(item))\n                        addMessages(messages, messagesHash, itemPath, item, 'removed', 'oldValue');\n                });\n\n            if (addItems)\n                for (var i = 2; i < argsLen; i++) {\n                    var item = arguments[i];\n                    var itemPath = accessPath + '[' + (spliceIndex + i - 2) + ']';\n                    {{# def.addMsg }} itemPath, type: 'added', newValue: item });\n\n                    if (valueIsTree(item))\n                        addMessages(messages, messagesHash, itemPath, item, 'added', 'newValue');\n                }\n\n            {{ /* post all stored messages */ }}\n            {{# def.postMessages }}\n        }\n    }\n\n    return removed || [];\n}\n"},include_defines="'use strict';\n/* Only use this style of comments, not \"//\" */\n\n/**\n * Inserts initialization code\n */\n {{## def.initVars:method:\n    var m = {{# def.modelAccessPrefix }};\n    var messages = [], messagesHash = {};\n    var accessPath = '';\n    var treeDoesNotExist;\n    /* hack to prevent sending finished events to allow for propagation of batches without splitting them */\n    var inChangeTransaction = getTransactionFlag( {{= method }} );\n #}}\n\n/**\n * Inserts the beginning of function call to add message to list\n */\n{{## def.addMsg: addChangeMessage(messages, messagesHash, { path: #}}\n\n/**\n * Inserts current property/index for both normal and interpolated properties/indexes\n */\n{{## def.currProp:{{? currNode.interpolate }}[this._args[ {{= currNode.interpolate }} ]]{{??}}{{= currProp }}{{?}} #}}\n\n/**\n * Inserts condition to test whether normal/interpolated property/index exists\n */\n{{## def.wasDefined: m.hasOwnProperty(\n    {{? currNode.interpolate }}\n        this._args[ {{= currNode.interpolate }} ]\n    {{??}}\n        '{{= it.getPathNodeKey(currNode) }}'\n    {{?}}\n) #}}\n\n\n/**\n * Inserts code to update access path for current property\n * Because of the possibility of interpolated properties, it can't be calculated in template, it can only be calculated during accessor call.\n */\n{{## def.changeAccessPath:\n    accessPath += {{? currNode.interpolate }}\n        {{? currNode.syntax == 'array' }}\n            '[' + this._args[ {{= currNode.interpolate }} ] + ']';\n        {{??}}\n            '.' + this._args[ {{= currNode.interpolate }} ];\n        {{?}}\n    {{??}}\n        '{{= currProp }}';\n    {{?}}\n#}}\n\n\n/**\n * Inserts code to post stored messages\n */\n{{## def.postMessages:\n    if (messages.length) {\n        {{# def.modelPostBatchCode }}('datachanges', {\n            changes: messages,\n            transaction: inChangeTransaction\n        });\n\n        messages.forEach(function(msg) {\n            {{# def.modelPostMessageCode }}(msg.path, msg);\n        }, this);\n    }\n#}}\n",include_create_tree="'use strict';\n/* Only use this style of comments, not \"//\" */\n\n/**\n * Inserts code to create model tree as neccessary for `set` and `splice` accessors and to add messages to send list if the tree changes.\n */\n{{## def.createTree:method:\n    var wasDef = true;\n    var old = m;\n\n    {{ var emptyProp = it.parsedPath[0] && it.parsedPath[0].empty; }}\n    {{? emptyProp }}\n        {{ /* create top level model if it was not previously defined */ }}\n        if (! m) {\n            m = {{# def.modelAccessPrefix }} = {{= emptyProp }};\n            wasDef = false;\n\n            if (this._options.reactive !== false) {\n                {{# def.addMsg }} '', type: 'added',\n                      newValue: m });\n            }\n        }\n    {{??}}\n        {{? method == 'splice' }}\n            if (! m) {\n        {{?}}\n                m = {{# def.modelAccessPrefix }} = cloneTree(value);\n                wasDef = typeof old != 'undefined';\n        {{? method == 'splice' }}\n            }\n        {{?}}       \n    {{?}}\n\n\n    {{ /* create model tree if it doesn't exist */ }}\n    {{  var modelDataProperty = '';\n        var nextNode = it.parsedPath[0];\n        var count = it.parsedPath.length - 1;\n\n        for (var i = 0; i < count; i++) {\n            var currNode = nextNode;\n            var currProp = currNode.property;\n            nextNode = it.parsedPath[i + 1];\n            var emptyProp = nextNode && nextNode.empty;\n    }}\n\n        {{# def.createTreeStep }}\n\n    {{  } /* for loop */ }}\n#}}\n\n\n/**\n * Inserts code to create one step in the model tree\n */\n{{## def.createTreeStep:\n    {{# def.changeAccessPath }}\n\n    if (! {{# def.wasDefined }}) { \n        {{ /* property does not exist */ }}\n        m = m{{# def.currProp }} = {{= emptyProp }};\n\n        if (this._options.reactive !== false) {\n            {{# def.addMsg }} accessPath, type: 'added', \n                  newValue: m });\n        }\n\n    } else if (typeof m{{# def.currProp }} != 'object') {\n        {{ /* property is not object */ }}\n        var old = m{{# def.currProp }};\n        m = m{{# def.currProp }} = {{= emptyProp }};\n\n        if (this._options.reactive !== false) {\n            {{# def.addMsg }} accessPath, type: 'changed', \n                  oldValue: old, newValue: m });\n        }\n\n    } else {\n        {{ /* property exists, just traverse down the model tree */ }}\n        m = m{{# def.currProp }};\n    }\n#}}\n",include_traverse_tree="'use strict';\n/* Only use this style of comments, not \"//\" */\n\n/**\n * Inserts code to traverse model tree for `delete` and `splice` accessors.\n */\n{{## def.traverseTree:\n    {{ \n        var count = it.parsedPath.length-1;\n\n        for (var i = 0; i < count; i++) { \n            var currNode = it.parsedPath[i];\n            var currProp = currNode.property;\n    }}\n            {{# def.traverseTreeStep }}\n\n    {{ } /* for loop */\n\n        var i = count;\n        while (i--) { /* closing braces for else's above */\n    }}\n            }\n    {{ } /* while loop */ }}\n#}}\n\n\n/**\n * Inserts code to traverse one step in the model tree\n */\n{{## def.traverseTreeStep:\n    if (! (m && m.hasOwnProperty && {{# def.wasDefined}} ) )\n        treeDoesNotExist = true;\n    else {\n        m = m{{# def.currProp }};\n        {{# def.changeAccessPath }}\n    {{ /* brace from else is not closed on purpose - all braces are closed in while loop */ }}\n#}}\n",dotDef={include_defines:include_defines,include_create_tree:include_create_tree,include_traverse_tree:include_traverse_tree,getPathNodeKey:pathUtils.getPathNodeKey,modelAccessPrefix:"this._model._data",modelPostMessageCode:"this._model._internalMessenger.postMessage",modelPostBatchCode:"this._model.postMessageSync",internalMessenger:"this._model._internalMessenger"},modelDotDef=_(dotDef).clone().extend({modelAccessPrefix:"this._data",modelPostMessageCode:"this._internalMessenger.postMessage",modelPostBatchCode:"this.postMessageSync",internalMessenger:"this._internalMessenger"})._(),dotSettings=_.clone(doT.templateSettings);dotSettings.strip=!1;var synthesizers=_.mapKeys(templates,function(a){return doT.template(a,dotSettings,dotDef)}),modelSynthesizers=_.mapToObject(["set","del","splice"],function(a){return doT.template(templates[a],dotSettings,modelDotDef)}),synthesizePathMethods=_.memoize(_synthesizePathMethods,void 0,1e3),normalizeSpliceIndex=modelUtils.normalizeSpliceIndex;module.exports=synthesizePathMethods;var modelMethods=_.mapKeys(modelSynthesizers,function(a){return _synthesize(a,"",[])});synthesizePathMethods.modelMethods=modelMethods},{"../../util/logger":118,"../change_data":107,"../model_utils":112,"../path_utils":114,dot:121,fs:96,"mol-proto":122}],116:[function(a,b){"use strict";function c(a){this.pattern=a}function d(a){if(0==a.length)throw new Error("Must provide at least one choice to Match.OneOf");this.choices=a}function e(a){this.condition=a}function f(a){this.pattern=a}function g(a){this.pattern=a}function h(a,b){this.Superclass=a,this.matchSuperclass=b}function i(a,b){if(b!==n.Any){for(var l=0;l<o.length;++l)if(b===o[l][0]){if(typeof a===o[l][1])return;throw new n.Error("Expected "+o[l][1]+", got "+typeof a)}if(null===b){if(null===a)return;throw new n.Error("Expected null, got "+JSON.stringify(a))}if(b===n.Integer){if("number"==typeof a&&(0|a)===a)return;throw new n.Error("Expected Integer, got "+(a instanceof Object?JSON.stringify(a):a))}if(b===n.IdentifierString){if("string"==typeof a&&n.IdentifierString.test(a)&&-1==p.indexOf(u))return;throw new n.Error("Expected identifier string, got "+(a instanceof Object?JSON.stringify(a):a))}if(b===Object&&(b=n.ObjectIncluding({})),b instanceof Array){if(1!==b.length)throw Error("Bad pattern: arrays must have one type element"+JSON.stringify(b));if(!Array.isArray(a))throw new n.Error("Expected array, got "+JSON.stringify(a));return void a.forEach(function(a,c){try{i(a,b[0])}catch(d){throw d instanceof n.Error&&(d.path=j(c,d.path)),d}})}if(b instanceof e){if(b.condition(a))return;throw new n.Error("Failed Match.Where validation")}if(b instanceof c&&(b=n.OneOf(void 0,b.pattern)),b instanceof d){for(var l=0;l<b.choices.length;++l)try{return void i(a,b.choices[l])}catch(q){if(!(q instanceof n.Error))throw q}throw new n.Error("Failed Match.OneOf or Match.Optional validation")}if(b instanceof Function){if(a instanceof b)return;throw new n.Error("Expected "+b.constructor.name)}var r=!1;if(b instanceof f&&(r=!0,b=b.pattern),b instanceof g){var s=b.pattern,t=!0;for(var u in a)t=!1,m(a[u],s);if(t)throw new n.Error("Expected "+b.constructor.name)}else if(b instanceof h){var v=b.Superclass;if(b.matchSuperclass&&a==v)return;if(!(a.prototype instanceof v))throw new n.Error("Expected "+b.constructor.name+" of "+v.name)}else{if("object"!=typeof b)throw Error("Bad pattern: unknown pattern type");if("object"!=typeof a)throw new n.Error("Expected object, got "+typeof a);if(null===a)throw new n.Error("Expected object, got null");var w={},x={};k.eachKey(b,function(a,d){b[d]instanceof c?x[d]=b[d].pattern:w[d]=b[d]},this,!0),k.eachKey(a,function(b,c){var b=a[c];try{if(w.hasOwnProperty(c))i(b,w[c]),delete w[c];else if(x.hasOwnProperty(c))i(b,x[c]);else if(!r)throw new n.Error("Unknown key")}catch(d){throw d instanceof n.Error&&(d.path=j(c,d.path)),d}},this,!0),k.eachKey(w,function(a,b){throw new n.Error("Missing key '"+b+"'")},this,!0)}}}function j(a,b){return"number"==typeof a||a.match(/^[0-9]+$/)?a="["+a+"]":a.match(n.IdentifierString)&&-1==p.indexOf(a)||(a=JSON.stringify([a])),b&&"["!==b[0]?a+"."+b:a+b}var k=a("mol-proto"),l=a("../config"),m=function(a,b){if(l.check!==!1)try{i(a,b)}catch(c){throw c instanceof n.Error&&c.path&&(c.message+=" in field "+c.path),c}};b.exports=m;var n=m.Match={Optional:function(a){return new c(a)},OneOf:function(){return new d(arguments)},Any:["__any__"],Where:function(a){return new e(a)},ObjectIncluding:function(a){return new f(a)},Integer:["__integer__"],IdentifierString:/^[a-z_$][0-9a-z_$]*$/i,ObjectHash:function(a){return new g(a)},Subclass:function(a,b){return new h(a,b)},Error:TypeError,test:function(a,b){try{return i(a,b),!0}catch(c){if(c instanceof n.Error)return!1;throw c}}},o=[[String,"string"],[Number,"number"],[Boolean,"boolean"],[Function,"function"],[void 0,"undefined"]],p=["do","if","in","for","let","new","try","var","case","else","enum","eval","false","null","this","true","void","with","break","catch","class","const","super","throw","while","yield","delete","export","import","public","return","static","switch","typeof","default","extends","finally","package","private","continue","debugger","function","arguments","interface","protected","implements","instanceof"]},{"../config":99,"mol-proto":122}],117:[function(a,b){"use strict";var c={logger:a("./logger"),check:a("./check"),doT:a("dot")};b.exports=c},{"./check":116,"./logger":118,dot:121}],118:[function(a,b){"use strict";var c=a("./logger_class"),d=new c({level:3});b.exports=d},{"./logger_class":119}],119:[function(a,b){"use strict";function c(a){return a.length<g?a+new Array(g-a.length+1).join(" "):a}function d(a,b){return"["+b+"m"+a+" -[39m"}var e=a("mol-proto"),f=["error","warn","info","debug"],g=Math.max.apply(Math,f.map(function(a){return a.length})),h=[31,33,36,90],i={level:3,throwLevel:-1,enabled:!0,logPrefix:""},j=function(a){e.extend(this,i),e.extend(this,a||{})};j.prototype.log=function(a){var b=f.indexOf(a);if(!this.enabled||b>this.level)return this;var g=e.slice(arguments,1);if(b<=this.throwLevel)throw new Error([this.logPrefix,a+":"].concat(g).join(" "));return console.log.apply(console,[this.logPrefixColor?"   "+d(this.logPrefix,this.logPrefixColor):this.logPrefix,(this.colors?" "+d(c(a),h[b]):a)+":"].concat(g)),this},f.forEach(function(a){j.prototype[a]=function(){this.log.apply(this,[a].concat(e.toArray(arguments)))}}),b.exports=j},{"mol-proto":122}],120:[function(a,b){!function(){"use strict";function a(b,c,d){return("string"==typeof c?c:c.toString()).replace(b.define||g,function(a,c,e,f){return 0===c.indexOf("def.")&&(c=c.substring(4)),c in d||(":"===e?(b.defineParams&&f.replace(b.defineParams,function(a,b,e){d[c]={arg:b,text:e}}),c in d||(d[c]=f)):new Function("def","def['"+c+"']="+f)(d)),""}).replace(b.use||g,function(c,e){b.useParams&&(e=e.replace(b.useParams,function(a,b,c,e){if(d[c]&&d[c].arg&&e){var f=(c+":"+e).replace(/'|\\/g,"_");return d.__exp=d.__exp||{},d.__exp[f]=d[c].text.replace(new RegExp("(^|[^\\w$])"+d[c].arg+"([^\\w$])","g"),"$1"+e+"$2"),b+"def.__exp['"+f+"']"}}));var f=new Function("def","return "+e)(d);return f?a(b,f,d):f})}function c(a){return a.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var d,e={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0};e.encodeHTMLSource=function(a){var b={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},c=a?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(a){return a?a.toString().replace(c,function(a){return b[a]||a}):""}},d=function(){return this||(0,eval)("this")}(),"undefined"!=typeof b&&b.exports?b.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):d.doT=e;var f={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},g=/$^/;e.template=function(b,h,i){h=h||e.templateSettings;var j,k,l=h.append?f.append:f.split,m=0,n=h.use||h.define?a(h,b,i||{}):b;n=("var out='"+(h.strip?n.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):n).replace(/'|\\/g,"\\$&").replace(h.interpolate||g,function(a,b){return l.start+c(b)+l.end}).replace(h.encode||g,function(a,b){return j=!0,l.startencode+c(b)+l.end}).replace(h.conditional||g,function(a,b,d){return b?d?"';}else if("+c(d)+"){out+='":"';}else{out+='":d?"';if("+c(d)+"){out+='":"';}out+='"}).replace(h.iterate||g,function(a,b,d,e){return b?(m+=1,k=e||"i"+m,b=c(b),"';var arr"+m+"="+b+";if(arr"+m+"){var "+d+","+k+"=-1,l"+m+"=arr"+m+".length-1;while("+k+"<l"+m+"){"+d+"=arr"+m+"["+k+"+=1];out+='"):"';} } out+='"}).replace(h.evaluate||g,function(a,b){return"';"+c(b)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),j&&(h.selfcontained||!d||d._encodeHTML||(d._encodeHTML=e.encodeHTMLSource(h.doNotSkipEncoded)),n="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+e.encodeHTMLSource.toString()+"("+(h.doNotSkipEncoded||"")+"));"+n);try{return new Function(h.varname,n)}catch(o){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+n),o}},e.compile=function(a,b){return e.template(a,null,b)}}()},{}],121:[function(a,b){function c(a){this.__path=a.path||"./","/"!==this.__path[this.__path.length-1]&&(this.__path+="/"),this.__destination=a.destination||this.__path,"/"!==this.__destination[this.__destination.length-1]&&(this.__destination+="/"),this.__global=a.global||"window.render",this.__rendermodule=a.rendermodule||{},this.__settings=a.templateSettings?e(a.templateSettings,e(h.templateSettings)):void 0,this.__includes={}}function d(a){for(var b="",c=0;c<a.length;c++)b+="itself."+a[c]+"="+a[c]+";";return b}function e(a,b){b=b||{};for(var c in a)b[c]=a[c];return b}function f(a){var b=g.readFileSync(a);return b?b.toString():void console.log("problems with "+a)}var g=a("fs"),h=b.exports=a("./doT");h.process=function(a){return new c(a).compileAll()},c.prototype.compileToFile=function(a,b,c){c=c||{};var f,i=a.substring(a.lastIndexOf("/")+1,a.lastIndexOf(".")),j=e(this.__includes,e(c)),k=this.__settings||h.templateSettings,l=e(k),m=h.template(b,k,j),n=[],o="";for(var p in j)j[p]!==c[p]&&j[p]!==this.__includes[p]&&(f=void 0,"string"==typeof j[p]?f=h.template(j[p],k,j):"function"==typeof j[p]?f=j[p]:j[p].arg&&(l.varname=j[p].arg,f=h.template(j[p].text,l,j)),f&&(o+=f.toString().replace("anonymous",p),n.push(p)));o+=m.toString().replace("anonymous",i),g.writeFileSync(a,"(function(){"+o+"var itself="+i+", _encodeHTML=("+h.encodeHTMLSource.toString()+"("+(k.doNotSkipEncoded||"")+"));"+d(n)+"if(typeof module!=='undefined' && module.exports) module.exports=itself;else if(typeof define==='function')define(function(){return itself;});else {"+this.__global+"="+this.__global+"||{};"+this.__global+"['"+i+"']=itself;}}());")},c.prototype.compilePath=function(a){var b=f(a);return b?h.template(b,this.__settings||h.templateSettings,e(this.__includes)):void 0},c.prototype.compileAll=function(){console.log("Compiling all doT templates...");var a,b,c,d=this.__path,e=g.readdirSync(d);for(a=0,b=e.length;b>a;a++)c=e[a],/\.def(\.dot|\.jst)?$/.test(c)&&(console.log("Loaded def "+c),this.__includes[c.substring(0,c.indexOf("."))]=f(d+c));for(a=0,b=e.length;b>a;a++)c=e[a],/\.dot(\.def|\.jst)?$/.test(c)&&(console.log("Compiling "+c+" to function"),this.__rendermodule[c.substring(0,c.indexOf("."))]=this.compilePath(d+c)),/\.jst(\.dot|\.def)?$/.test(c)&&(console.log("Compiling "+c+" to file"),this.compileToFile(this.__destination+c.substring(0,c.indexOf("."))+".js",f(d+c)));return this.__rendermodule}},{"./doT":120,fs:96}],122:[function(a,b){"use strict";function c(a){var b=Object.create(c.prototype);return b.self=a,b}function d(){return this.self}var e=a("./utils"),f=a("./proto_prototype"),g=a("./proto_object"),h=a("./proto_array"),i=a("./proto_function"),j=a("./proto_string"),k=a("./proto_number"),l=a("./proto_util"),m={};g.extend.call(m,g),m.extend.call(m,f),m.extend.call(m,h),m.extend.call(m,j),m.extend.call(m,k),m.extend.call(m,i),m.extend.call(m,l),m.defineProperty(c,"__",m),m.extendProto.call(c,{_:d}),m.extend.call(c,g._constants);var n=m.mapKeys.call(m,e.makeProtoFunction,!0);m.extend.call(c,n);var o=m.mapKeys.call(m,e.makeProtoInstanceMethod,!0);m.extendProto.call(c,o),"object"==typeof window&&(window._&&(c.underscore=window._),window._=c),"object"==typeof b&&b.exports&&(b.exports=c)},{"./proto_array":123,"./proto_function":124,"./proto_number":125,"./proto_object":126,"./proto_prototype":127,"./proto_string":128,"./proto_util":129,"./utils":130}],123:[function(a,b){"use strict";function c(a){if(!a.length)return this;Array.isArray(a)||(a=f.call(a));var b=[this.length,0].concat(a);return m.splice.apply(this,b),this}function d(a){if(!a.length)return this;Array.isArray(a)||(a=f.call(a));var b=[0,0].concat(a);return m.splice.apply(this,b),this}function e(a){var b=this.indexOf(a);return b>=0&&this.splice(b,1),this}function f(){return m.slice.call(this)}function g(a){var b={},c=Array.isArray(a);return m.forEach.call(this,function(d,e){b[d]=c?a[e]:a}),b}function h(a,b){var c={};return Array.prototype.forEach.call(this,function(d,e){c[d]=a.call(b,d,e,this)},this),c}function i(a){function b(b){return m.findIndex.call(d,function(c){return a(b,c)})}function c(a){return d.indexOf(a)}var d=[];return a||(b=c),this.forEach(function(a){var c=b(a);-1==c&&d.push(a)}),d}function j(a,b){function c(){m.forEach.call(this,function(f){Array.isArray(f)?c.call(f):a.call(b,f,d++,e)})}var d=0,e=this;c.call(this)}var k=a("./proto_object"),l=a("./utils"),m=b.exports={appendArray:c,prependArray:d,toArray:f,object:g,mapToObject:h,unique:i,deepForEach:j,spliceItem:e},n=["join","pop","push","concat","reverse","shift","unshift","slice","splice","sort","filter","forEach","some","every","map","indexOf","lastIndexOf","reduce","reduceRight"],o=h.call(n,function(a){return Array.prototype[a]});k.extend.call(m,o),m.find=Array.prototype.find||l.makeFindMethod(m.forEach,"value"),m.findIndex=Array.prototype.findIndex||l.makeFindMethod(m.forEach,"index")},{"./proto_object":126,"./utils":130}],124:[function(require,module,exports){"use strict";function makeFunction(arg1,arg2,funcBody){for(var name=this,count=arguments.length-1,funcBody=arguments[count],func,code="",i=0;count>i;i++)code+=", "+arguments[i];return code=["func = function ",name,"(",code.slice(2),") {\n",funcBody,"\n}"].join(""),eval(code),func}function partial(){var a=this,b=slice.call(arguments);return function(){return a.apply(this,b.concat(slice.call(arguments)))}}function partialRight(){var a=this,b=slice.call(arguments);return function(){return a.apply(this,slice.call(arguments).concat(b))}}function memoize(a,b){var c=this,d={},e=[];return b=b||1e3,function(){var f=a?a.apply(this,arguments):arguments[0];if(d.hasOwnProperty(f))return d[f];var g=d[f]=c.apply(this,arguments);return e.push(f),e.length>b&&delete d[e.shift()],g}}function delay(a){var b=slice.call(arguments,1);return _delay(this,a,b)}function defer(){return _delay(this,1,arguments)}function _delay(a,b,c,d){return setTimeout(a.apply.bind(a,d||null,c),b)}function deferTicks(a){if(2>a)return defer.apply(this,arguments);var b=repeat.call(deferFunc,a-1);return b=b.concat(this,slice.call(arguments,1)),deferFunc.apply(null,b)}function delayMethod(a,b){var c=slice.call(arguments,2);return _delayMethod(this,a,b,c)}function deferMethod(a){var b=slice.call(arguments,1);return _delayMethod(this,a,1,b)}function _delayMethod(a,b,c,d){return setTimeout(function(){var c="string"==typeof b?a[b]:b;c.apply(a,d)},c)}function delayed(a){var b=this,c=slice.call(arguments,1);return function(){var d=c.concat(slice.call(arguments));return _delay(b,a,d,this)}}function deferred(){var a=this,b=slice.call(arguments);return function(){var c=b.concat(slice.call(arguments));return _delay(a,1,c,this)}}function debounce(a,b){var c,d,e,f,g,h=this;return function(){function i(){var j=Date.now()-f;a>j?c=setTimeout(i,a-j):(c=null,b||(g=h.apply(e,d)))}e=this,d=arguments,f=Date.now();var j=b&&!c;return c||(c=setTimeout(i,a)),j&&(g=h.apply(e,d)),g}}function throttle(a,b){function c(){i=b.leading===!1?0:Date.now(),h=null,f=g.apply(d,e)}var d,e,f,g=this,h=null,i=0;return b||(b={}),function(){var j=Date.now();i||b.leading!==!1||(i=j);var k=a-(j-i);return d=this,e=arguments,0>=k?(clearTimeout(h),h=null,i=j,f=g.apply(d,e)):h||b.trailing===!1||(h=setTimeout(c,k)),f}}function once(){var a,b=this,c=!1;return function(){return c?a:(c=!0,a=b.apply(this,arguments),b=null,a)}}function waitFor(a,b,c,d){function e(){if(g())a();else{if(!(Date.now()-f>=b))return;c&&c()}clearInterval(h)}var f=Date.now(),g=this;d=d||50;var h=setInterval(e,d)}function not(){var a=this;return function(){return!a.apply(this,arguments)}}var makeProtoFunction=require("./utils").makeProtoFunction,repeat=require("./proto_util").repeat,functionMethods=module.exports={makeFunction:makeFunction,partial:partial,partialRight:partialRight,memoize:memoize,delay:delay,defer:defer,delayed:delayed,deferred:deferred,deferTicks:deferTicks,delayMethod:delayMethod,deferMethod:deferMethod,debounce:debounce,throttle:throttle,once:once,waitFor:waitFor,not:not},slice=Array.prototype.slice,deferFunc=makeProtoFunction(defer)
},{"./proto_util":129,"./utils":130}],125:[function(a,b){"use strict";function c(){return!isNaN(parseFloat(this))&&isFinite(this)}b.exports={isNumeric:c}},{}],126:[function(a,b){"use strict";function c(a,b){var c={};return p.call(a,function(b,d){c[d]=Object.getOwnPropertyDescriptor(a,d)},this,b),Object.defineProperties(this,c),this}function d(){if(Array.isArray(this))return this.slice();if(this instanceof Date)return new Date(this);if(this instanceof RegExp)return new RegExp(this);var a=Object.create(this.constructor.prototype);return c.call(a,this),a}function e(a,b,c){return Object.defineProperty(this,a,f(b,c)),this}function f(a,b){var d={value:a};return b&&c.call(d,{enumerable:!!(b&B.ENUMERABLE),configurable:!!(b&B.CONFIGURABLE),writable:!!(b&B.WRITABLE)}),d}function g(a,b){var c=q.call(a,function(a){return f(a,b)},!0);return Object.defineProperties(this,c),this}function h(a,b){return i(this,a,b,[])}function i(a,b,c,d){if(!(d.indexOf(b)>=0)){d.push(b);var e=Array.isArray(b)?Array.prototype.forEach:p;return e.call(b,function(e,f){var g=Object.getOwnPropertyDescriptor(b,f);"object"!=typeof e||null==e||e instanceof RegExp||e instanceof Date?Object.defineProperty(a,f,g):(a.hasOwnProperty(f)&&"object"==typeof a[f]&&null!=a[f]||(a[f]=Array.isArray(e)?[]:{}),i(a[f],e,c,d))},this,c),a}}function j(a){if(this instanceof Date)return new Date(this);if(this instanceof RegExp)return new RegExp(this);var b=Array.isArray(this)?[]:{};return h.call(b,this,a),b}function k(){return Object.keys(this)}function l(a){var b=a?Object.keys(this):m.call(this);return b.map(function(a){return this[a]},this)}function m(){return Object.getOwnPropertyNames(this)}function n(a,b){for(var c=b?Object.keys(this):m.call(this),d=0;d<c.length;d++)if(a===this[c[d]])return c[d];return void 0}function o(a,b){var c=b?Object.keys(this):m.call(this),d=c.filter(function(b){return a===this[b]},this);return d}function p(a,b,c){var d=c?Object.keys(this):m.call(this);return d.forEach(function(c){a.call(b,this[c],c,this)},this),this}function q(a,b,c){function d(b,c,d){e[c]=Object.getOwnPropertyDescriptor(d,c),e[c].value=a.call(this,b,c,d)}var e={};return p.call(this,d,b,c),Object.create(this.constructor.prototype,e)}function r(a,b,c,d){var e=d?Object.keys(this):m.call(this),f=b;return e.forEach(function(b){f=a.call(c,f,this[b],b,this)},this),f}function s(a,b,c){function d(b,c,d){a.call(this,b,c,d)&&(e[c]=Object.getOwnPropertyDescriptor(d,c))}var e={};return p.call(this,d,b,c),Object.create(this.constructor.prototype,e)}function t(a,b,c){function d(b,c,d){if(a.call(this,b,c,d))throw C}try{p.call(this,d,b,c)}catch(e){if(e===C)return!0;throw e}return!1}function u(a,b,c){function d(b,c,d){if(!a.call(this,b,c,d))throw D}try{p.call(this,d,b,c)}catch(e){if(e===D)return!1;throw e}return!0}function v(){var a=F.apply(E,arguments),b=Object.create(this.constructor.prototype);return a.forEach(function(a){this.hasOwnProperty(a)&&(b[a]=this[a])},this),b}function w(){var a=F.apply(E,arguments),b=d.call(this);return a.forEach(function(a){delete b[a]},this),b}function x(a){if(this===a)return 0!==this||1/this==1/a;if(null==this||null==a)return!1;var b=this.constructor.name;if(b!=a.constructor.name)return!1;switch(b){case"String":return this==String(a);case"Number":return this!=+this?a!=+a:0==this?1/this==1/a:this==+a;case"Date":case"Boolean":return+this==+a;case"RegExp":return this.source==a.source&&this.global==a.global&&this.multiline==a.multiline&&this.ignoreCase==a.ignoreCase}return"object"!=typeof this||"object"!=typeof a?!1:Array.isArray(this)?this.length==a.length&&this.every(function(b,c){return x.call(b,a[c])}):m.call(this).length==m.call(a).length&&u.call(this,function(b,c){return x.call(b,a[c])})}function y(a){return!x.call(this,a)}var z=a("./utils"),A=b.exports={extend:c,clone:d,defineProperty:e,defineProperties:g,deepExtend:h,deepClone:j,keys:k,allKeys:m,values:l,keyOf:n,allKeysOf:o,eachKey:p,mapKeys:q,reduceKeys:r,filterKeys:s,someKey:t,everyKey:u,pickKeys:v,omitKeys:w,isEqual:x,isNot:y},B={ENUMERABLE:1,ENUM:1,CONFIGURABLE:2,CONF:2,WRITABLE:4,WRIT:4};e.call(A,"_constants",B),A.findValue=z.makeFindMethod(p,"value"),A.findKey=z.makeFindMethod(p,"key");var C={},D={},E=Array.prototype,F=E.concat},{"./utils":130}],127:[function(require,module,exports){"use strict";function extendProto(a){var b={};return __.eachKey.call(a,function(a,c){b[c]={enumerable:!1,configurable:!1,writable:!1,value:a}}),Object.defineProperties(this.prototype,b),this}function createSubclass(name,applyConstructor){var thisClass=this,subclass;name=name||"";var constructorCode=applyConstructor===!1?"":"thisClass.apply(this, arguments);";return eval("subclass = function "+name+"(){ "+constructorCode+" }"),makeSubclass.call(subclass,thisClass),__.deepExtend.call(subclass,thisClass,!0),subclass}function makeSubclass(a){return this.prototype=Object.create(a.prototype),extendProto.call(this,{constructor:this}),this}function newApply(a){Array.isArray(a)||(a=Array.prototype.slice.call(a));var a=[null].concat(a);return new(Function.prototype.bind.apply(this,a))}var prototypeMethods=module.exports={extendProto:extendProto,createSubclass:createSubclass,makeSubclass:makeSubclass,newApply:newApply},__=require("./proto_object");__.extend.call(__,require("./proto_function"))},{"./proto_function":124,"./proto_object":126}],128:[function(require,module,exports){"use strict";function firstUpperCase(){return this?this[0].toUpperCase()+this.slice(1):this}function firstLowerCase(){return this?this[0].toLowerCase()+this.slice(1):this}function toRegExp(){var a=this.match(regexpStringPattern);return a?new RegExp(a[1],a[2]):void 0}function toFunction(){var func,code="func = "+this+";";try{return eval(code),func}catch(e){return}}function toDate(){if(this){try{var a=new Date(this)}catch(b){}return a&&a.getTime&&!isNaN(a.getTime())?a:void 0}}function toQueryString(a){var b="",c=this||{},a=a||encodeURIComponent;return __.eachKey.call(c,function(c,d){b+=d+"="+a(c)+"&"}),b.slice(0,-1)}function fromQueryString(a){var b=this.split("&"),c={},a=a||decodeURIComponent;return b.forEach(function(b){var d=b.split("=");if(!(d.length<2)){var e=d[0],f=a(d[1]||"");e&&(c[e]=f)}}),c}function jsonParse(){try{return JSON.parse(this)}catch(a){}}function hashCode(){for(var a=5381,b=this,c=b.length,d=0;c>d;d++){var e=b.charCodeAt(d);a=(a<<5)+a+e}return a}function unPrefix(a){return 0==this.indexOf(a)?this.replace(a,""):void 0}var __=require("./proto_object"),stringMethods=module.exports={firstUpperCase:firstUpperCase,firstLowerCase:firstLowerCase,toRegExp:toRegExp,toFunction:toFunction,toDate:toDate,toQueryString:toQueryString,fromQueryString:fromQueryString,jsonParse:jsonParse,hashCode:hashCode,unPrefix:unPrefix},regexpStringPattern=/^\/(.*)\/([gimy]*)$/},{"./proto_object":126}],129:[function(a,b){"use strict";function c(a,b){for(var c=Array(Math.max(0,this)),d=0;this>d;d++)c[d]=a.call(b,d);return c}function d(a){for(var b=Array(Math.max(0,a)),c=0;a>c;c++)b[c]=this;return b}function e(a){return a.call(this,this),this}function f(a){var b=Array.prototype.slice.call(arguments,1);return"function"==typeof this?this.apply(a,b):this}function g(){return this}function h(){var a=this;return function(b){return b[a]}}function i(){var a=this;return function(b,c){return b[a]<c[a]?-1:b[a]>c[a]?1:0}}function j(){}b.exports={times:c,repeat:d,tap:e,result:f,identity:g,property:h,compareProperty:i,noop:j}},{}],130:[function(a,b){"use strict";function c(a){return function(){return this.self=a.apply(this.self,arguments),this}}function d(a){return function(){return a.call.apply(a,arguments)}}function e(a,b){var c="value"==b?0:1;return function(b,d,e){function g(a,d,e){var g;try{g=b.call(this,a,d,e)}catch(i){throw h=i,f}if(g)throw arguments[c]}var h;try{a.call(this,g,d,e)}catch(i){if(i===f)throw h;return i}return c&&a==Array.prototype.forEach?-1:void 0}}var f=(b.exports={makeProtoInstanceMethod:c,makeProtoFunction:d,makeFindMethod:e},new Error)},{}]},{},[66]);
//# sourceMappingURL=milo.min.js.map